var Prototype={Version:"1.7_rc2",Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(a)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!(a&&a.prototype)}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!==
"undefined")return true;var a=document.createElement("div"),b=document.createElement("form"),c=false;if(a.__proto__&&a.__proto__!==b.__proto__)c=true;return c}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;
var Abstract={},Try={these:function(){for(var a,b=0,c=arguments.length;b<c;b++){var e=arguments[b];try{a=e();break}catch(d){}}return a}},Class=function(){function a(){}var b=function(){for(var c in{toString:1})if(c==="toString")return false;return true}();return{create:function(){function c(){this.initialize.apply(this,arguments)}var e=null,d=$A(arguments);if(Object.isFunction(d[0]))e=d.shift();Object.extend(c,Class.Methods);c.superclass=e;c.subclasses=[];if(e){a.prototype=e.prototype;c.prototype=
new a;e.subclasses.push(c)}e=0;for(var g=d.length;e<g;e++)c.addMethods(d[e]);if(!c.prototype.initialize)c.prototype.initialize=Prototype.emptyFunction;return c.prototype.constructor=c},Methods:{addMethods:function(c){var e=this.superclass&&this.superclass.prototype,d=Object.keys(c);if(b){c.toString!=Object.prototype.toString&&d.push("toString");c.valueOf!=Object.prototype.valueOf&&d.push("valueOf")}for(var g=0,f=d.length;g<f;g++){var j=d[g],h=c[j];if(e&&Object.isFunction(h)&&h.argumentNames()[0]==
"$super"){var m=h;h=function(r){return function(){return e[r].apply(this,arguments)}}(j).wrap(m);h.valueOf=m.valueOf.bind(m);h.toString=m.toString.bind(m)}this.prototype[j]=h}return this}}}}();
(function(){function a(n){switch(n){case null:return m;case void 0:return r}switch(typeof n){case "boolean":return w;case "number":return y;case "string":return v}return z}function b(n,q){for(var p in q)n[p]=q[p];return n}function c(n){return e("",{"":n},[])}function e(n,q,p){q=q[n];var s=typeof q;if(a(q)===z&&typeof q.toJSON==="function")q=q.toJSON(n);n=h.call(q);switch(n){case A:case B:case l:q=q.valueOf()}switch(q){case null:return"null";case true:return"true";case false:return"false"}s=typeof q;
switch(s){case "string":return q.inspect(true);case "number":return isFinite(q)?String(q):"null";case "object":s=0;for(var x=p.length;s<x;s++)if(p[s]===q)throw new TypeError;p.push(q);var u=[];if(n===i){s=0;for(x=q.length;s<x;s++){var C=e(s,q,p);u.push(typeof C==="undefined"?"null":C)}u="["+u.join(",")+"]"}else{var D=Object.keys(q);s=0;for(x=D.length;s<x;s++){n=D[s];C=e(n,q,p);typeof C!=="undefined"&&u.push(n.inspect(true)+":"+C)}u="{"+u.join(",")+"}"}p.pop();return u}}function d(n){return JSON.stringify(n)}
function g(n){if(a(n)!==z)throw new TypeError;var q=[],p;for(p in n)n.hasOwnProperty(p)&&q.push(p);return q}function f(n){return h.call(n)===i}function j(n){return typeof n==="undefined"}var h=Object.prototype.toString,m="Null",r="Undefined",w="Boolean",y="Number",v="String",z="Object",B="[object Boolean]",A="[object Number]",l="[object String]",i="[object Array]",o=window.JSON&&typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&typeof JSON.stringify(Prototype.K)==="undefined";if(typeof Array.isArray==
"function"&&Array.isArray([])&&!Array.isArray({}))f=Array.isArray;b(Object,{extend:b,inspect:function(n){try{if(j(n))return"undefined";if(n===null)return"null";return n.inspect?n.inspect():String(n)}catch(q){if(q instanceof RangeError)return"...";throw q;}},toJSON:o?d:c,toQueryString:function(n){return $H(n).toQueryString()},toHTML:function(n){return n&&n.toHTML?n.toHTML():String.interpret(n)},keys:Object.keys||g,values:function(n){var q=[],p;for(p in n)q.push(n[p]);return q},clone:function(n){return b({},
n)},isElement:function(n){return!!(n&&n.nodeType==1)},isArray:f,isHash:function(n){return n instanceof Hash},isFunction:function(n){return typeof n==="function"},isString:function(n){return h.call(n)===l},isNumber:function(n){return h.call(n)===A},isUndefined:j})})();
Object.extend(Function.prototype,function(){function a(e,d){for(var g=e.length,f=d.length;f--;)e[g+f]=d[f];return e}function b(e,d){e=c.call(e,0);return a(e,d)}var c=Array.prototype.slice;return{argumentNames:function(){var e=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return e.length==1&&!e[0]?[]:e},bind:function(e){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var d=this,g=c.call(arguments,
1);return function(){var f=b(g,arguments);return d.apply(e,f)}},bindAsEventListener:function(e){var d=this,g=c.call(arguments,1);return function(f){f=a([f||window.event],g);return d.apply(e,f)}},curry:function(){if(!arguments.length)return this;var e=this,d=c.call(arguments,0);return function(){var g=b(d,arguments);return e.apply(this,g)}},delay:function(e){var d=this,g=c.call(arguments,1);e*=1E3;return window.setTimeout(function(){return d.apply(d,g)},e)},defer:function(){return this.delay.apply(this,
a([0.01],arguments))},wrap:function(e){var d=this;return function(){var g=a([d.bind(this)],arguments);return e.apply(this,g)}},methodize:function(){if(this._methodized)return this._methodized;var e=this;return this._methodized=function(){var d=a([this],arguments);return e.apply(null,d)}}}}());
(function(a){function b(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function c(){return this.toISOString()}if(!a.toISOString)a.toISOString=b;if(!a.toJSON)a.toJSON=c})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;
RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};
var PeriodicalExecuter=Class.create({initialize:function(a,b){this.callback=a;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1E3)},execute:function(){this.callback(this)},stop:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=
false;throw a;}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"}});
Object.extend(String.prototype,function(){function a(f){if(Object.isFunction(f))return f;var j=new Template(f);return function(h){return j.evaluate(h)}}function b(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function c(f){var j=this.strip().match(/([^?#]*)(#.*)?$/);if(!j)return{};return j[1].split(f||"&").inject({},function(h,m){if((m=m.split("="))[0]){var r=decodeURIComponent(m.shift()),w=m.length>1?m.join("="):m[0];if(w!=undefined)w=decodeURIComponent(w);if(r in h){Object.isArray(h[r])||
(h[r]=[h[r]]);h[r].push(w)}else h[r]=w}return h})}function e(f){var j=this.unfilterJSON(),h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(h.test(j))j=j.replace(h,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)});try{if(!f||j.isJSON())return eval("("+j+")")}catch(m){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());}function d(){var f=this.unfilterJSON();return JSON.parse(f)}var g=window.JSON&&
typeof JSON.parse==="function"&&JSON.parse('{"test": true}').test;return{gsub:function(f,j){var h="",m=this,r;j=a(j);if(Object.isString(f))f=RegExp.escape(f);if(!(f.length||f.source)){j=j("");return j+m.split("").join(j)+j}for(;m.length>0;)if(r=m.match(f)){h+=m.slice(0,r.index);h+=String.interpret(j(r));m=m.slice(r.index+r[0].length)}else{h+=m;m=""}return h},sub:function(f,j,h){j=a(j);h=Object.isUndefined(h)?1:h;return this.gsub(f,function(m){if(--h<0)return m[0];return j(m)})},scan:function(f,j){this.gsub(f,
j);return String(this)},truncate:function(f,j){f=f||30;j=Object.isUndefined(j)?"...":j;return this.length>f?this.slice(0,f-j.length)+j:String(this)},strip:String.prototype.trim||b,stripTags:function(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")},stripScripts:function(){return this.replace(RegExp(Prototype.ScriptFragment,"img"),"")},extractScripts:function(){var f=RegExp(Prototype.ScriptFragment,"im");return(this.match(RegExp(Prototype.ScriptFragment,"img"))||[]).map(function(j){return(j.match(f)||
["",""])[1]})},evalScripts:function(){return this.extractScripts().map(function(f){return eval(f)})},escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},toQueryParams:c,parseQuery:c,toArray:function(){return this.split("")},succ:function(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)},times:function(f){return f<
1?"":Array(f+1).join(this)},camelize:function(){return this.replace(/-+(.)?/g,function(f,j){return j?j.toUpperCase():""})},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},underscore:function(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()},dasherize:function(){return this.replace(/_/g,"-")},inspect:function(f){var j=this.replace(/[\x00-\x1f\\]/g,function(h){if(h in
String.specialChar)return String.specialChar[h];return"\\u00"+h.charCodeAt().toPaddedString(2,16)});if(f)return'"'+j.replace(/"/g,'\\"')+'"';return"'"+j.replace(/'/g,"\\'")+"'"},unfilterJSON:function(f){return this.replace(f||Prototype.JSONFilter,"$1")},isJSON:function(){var f=this;if(f.blank())return false;f=f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");f=f.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");f=f.replace(/(?:^|:|,)(?:\s*\[)+/g,"");return/^[\],:{}\s]*$/.test(f)},
evalJSON:g?d:e,include:function(f){return this.indexOf(f)>-1},startsWith:function(f){return this.lastIndexOf(f,0)===0},endsWith:function(f){var j=this.length-f.length;return j>=0&&this.indexOf(f,j)===j},empty:function(){return this==""},blank:function(){return/^\s*$/.test(this)},interpolate:function(f,j){return(new Template(this,j)).evaluate(f)}}}());
var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements))a=a.toTemplateReplacements();return this.template.gsub(this.pattern,function(b){if(a==null)return b[1]+"";var c=b[1]||"";if(c=="\\")return b[2];var e=a,d=b[3],g=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;b=g.exec(d);if(b==null)return c;for(;b!=null;){var f=b[1].startsWith("[")?b[2].replace(/\\\\]/g,"]"):b[1];e=e[f];if(null==
e||""==b[3])break;d=d.substring("["==b[3]?b[1].length:b[0].length);b=g.exec(d)}return c+String.interpret(e)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;
var $break={},Enumerable=function(){function a(j,h){j=j||Prototype.K;var m=true;this.each(function(r,w){m=m&&!!j.call(h,r,w);if(!m)throw $break;});return m}function b(j,h){j=j||Prototype.K;var m=false;this.each(function(r,w){if(m=!!j.call(h,r,w))throw $break;});return m}function c(j,h){j=j||Prototype.K;var m=[];this.each(function(r,w){m.push(j.call(h,r,w))});return m}function e(j,h){var m;this.each(function(r,w){if(j.call(h,r,w)){m=r;throw $break;}});return m}function d(j,h){var m=[];this.each(function(r,
w){j.call(h,r,w)&&m.push(r)});return m}function g(j){if(Object.isFunction(this.indexOf))if(this.indexOf(j)!=-1)return true;var h=false;this.each(function(m){if(m==j){h=true;throw $break;}});return h}function f(){return this.map()}return{each:function(j,h){var m=0;try{this._each(function(w){j.call(h,w,m++)})}catch(r){if(r!=$break)throw r;}return this},eachSlice:function(j,h,m){var r=-j,w=[],y=this.toArray();if(j<1)return y;for(;(r+=j)<y.length;)w.push(y.slice(r,r+j));return w.collect(h,m)},all:a,every:a,
any:b,some:b,collect:c,map:c,detect:e,findAll:d,select:d,filter:d,grep:function(j,h,m){h=h||Prototype.K;var r=[];if(Object.isString(j))j=RegExp(RegExp.escape(j));this.each(function(w,y){j.match(w)&&r.push(h.call(m,w,y))});return r},include:g,member:g,inGroupsOf:function(j,h){h=Object.isUndefined(h)?null:h;return this.eachSlice(j,function(m){for(;m.length<j;)m.push(h);return m})},inject:function(j,h,m){this.each(function(r,w){j=h.call(m,j,r,w)});return j},invoke:function(j){var h=$A(arguments).slice(1);
return this.map(function(m){return m[j].apply(m,h)})},max:function(j,h){j=j||Prototype.K;var m;this.each(function(r,w){r=j.call(h,r,w);if(m==null||r>=m)m=r});return m},min:function(j,h){j=j||Prototype.K;var m;this.each(function(r,w){r=j.call(h,r,w);if(m==null||r<m)m=r});return m},partition:function(j,h){j=j||Prototype.K;var m=[],r=[];this.each(function(w,y){(j.call(h,w,y)?m:r).push(w)});return[m,r]},pluck:function(j){var h=[];this.each(function(m){h.push(m[j])});return h},reject:function(j,h){var m=
[];this.each(function(r,w){j.call(h,r,w)||m.push(r)});return m},sortBy:function(j,h){return this.map(function(m,r){return{value:m,criteria:j.call(h,m,r)}}).sort(function(m,r){var w=m.criteria,y=r.criteria;return w<y?-1:w>y?1:0}).pluck("value")},toArray:f,entries:f,zip:function(){var j=Prototype.K,h=$A(arguments);if(Object.isFunction(h.last()))j=h.pop();var m=[this].concat(h).map($A);return this.map(function(r,w){return j(m.pluck(w))})},size:function(){return this.toArray().length},inspect:function(){return"#<Enumerable:"+
this.toArray().inspect()+">"},find:e}}();function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=Array(b);b--;)c[b]=a[b];return c}function $w(a){if(!Object.isString(a))return[];return(a=a.strip())?a.split(/\s+/):[]}Array.from=$A;
(function(){function a(h){for(var m=0,r=this.length;m<r;m++)h(this[m])}function b(){return f.call(this,0)}function c(h,m){m||(m=0);var r=this.length;if(m<0)m=r+m;for(;m<r;m++)if(this[m]===h)return m;return-1}function e(h,m){m=isNaN(m)?this.length:(m<0?this.length+m:m)+1;var r=this.slice(0,m).reverse().indexOf(h);return r<0?r:m-r-1}function d(){for(var h=f.call(this,0),m,r=0,w=arguments.length;r<w;r++){m=arguments[r];if(Object.isArray(m)&&!("callee"in m))for(var y=0,v=m.length;y<v;y++)h.push(m[y]);
else h.push(m)}return h}var g=Array.prototype,f=g.slice,j=g.forEach;j||(j=a);Object.extend(g,Enumerable);if(!g._reverse)g._reverse=g.reverse;Object.extend(g,{_each:j,clear:function(){this.length=0;return this},first:function(){return this[0]},last:function(){return this[this.length-1]},compact:function(){return this.select(function(h){return h!=null})},flatten:function(){return this.inject([],function(h,m){if(Object.isArray(m))return h.concat(m.flatten());h.push(m);return h})},without:function(){var h=
f.call(arguments,0);return this.select(function(m){return!h.include(m)})},reverse:function(h){return(h===false?this.toArray():this)._reverse()},uniq:function(h){return this.inject([],function(m,r,w){if(0==w||(h?m.last()!=r:!m.include(r)))m.push(r);return m})},intersect:function(h){return this.uniq().findAll(function(m){return h.detect(function(r){return m===r})})},clone:b,toArray:b,size:function(){return this.length},inspect:function(){return"["+this.map(Object.inspect).join(", ")+"]"}});if(function(){return[].concat(arguments)[0][0]!==
1}(1,2))g.concat=d;if(!g.indexOf)g.indexOf=c;if(!g.lastIndexOf)g.lastIndexOf=e})();function $H(a){return new Hash(a)}
var Hash=Class.create(Enumerable,function(){function a(){return Object.clone(this._object)}function b(c,e){if(Object.isUndefined(e))return c;return c+"="+encodeURIComponent(String.interpret(e))}return{initialize:function(c){this._object=Object.isHash(c)?c.toObject():Object.clone(c)},_each:function(c){for(var e in this._object){var d=this._object[e],g=[e,d];g.key=e;g.value=d;c(g)}},set:function(c,e){return this._object[c]=e},get:function(c){if(this._object[c]!==Object.prototype[c])return this._object[c]},
unset:function(c){var e=this._object[c];delete this._object[c];return e},toObject:a,toTemplateReplacements:a,keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},index:function(c){var e=this.detect(function(d){return d.value===c});return e&&e.key},merge:function(c){return this.clone().update(c)},update:function(c){return(new Hash(c)).inject(this,function(e,d){e.set(d.key,d.value);return e})},toQueryString:function(){return this.inject([],function(c,e){var d=encodeURIComponent(e.key),
g=e.value;if(g&&typeof g=="object"){if(Object.isArray(g))return c.concat(g.map(b.curry(d)))}else c.push(b(d,g));return c}).join("&")},inspect:function(){return"#<Hash:{"+this.map(function(c){return c.map(Object.inspect).join(": ")}).join(", ")+"}>"},toJSON:a,clone:function(){return new Hash(this)}}}());Hash.from=$H;
Object.extend(Number.prototype,function(){return{toColorPart:function(){return this.toPaddedString(2,16)},succ:function(){return this+1},times:function(a,b){$R(0,this,true).each(a,b);return this},toPaddedString:function(a,b){var c=this.toString(b||10);return"0".times(a-c.length)+c},abs:function(){return Math.abs(this)},round:function(){return Math.round(this)},ceil:function(){return Math.ceil(this)},floor:function(){return Math.floor(this)}}}());function $R(a,b,c){return new ObjectRange(a,b,c)}
var ObjectRange=Class.create(Enumerable,function(){return{initialize:function(a,b,c){this.start=a;this.end=b;this.exclusive=c},_each:function(a){for(var b=this.start;this.include(b);){a(b);b=b.succ()}},include:function(a){if(a<this.start)return false;if(this.exclusive)return a<this.end;return a<=this.end}}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||
false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,e){this.each(function(d){if(Object.isFunction(d[a]))try{d[a].apply(d,[b,c,e])}catch(g){}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});
Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});
Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,c){$super(c);this.transport=Ajax.getTransport();this.request(b)},request:function(a){this.url=a;this.method=this.options.method;a=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!["get","post"].include(this.method)){a+=(a?"&":"")+"_method="+this.method;this.method="post"}if(a)if(this.method=="get")this.url+=(this.url.include("?")?"&":"?")+a;else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))a+=
"&_=";this.parameters=a.toQueryParams();try{var b=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(b);Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||a:null;this.transport.send(this.body);!this.options.asynchronous&&
this.transport.overrideMimeType&&this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&!(a==4&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){a["Content-type"]=this.options.contentType+(this.options.encoding?
"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)a.Connection="close"}if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(Object.isFunction(b.push))for(var c=0,e=b.length;c<e;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(g){a[g.key]=g.value})}for(var d in a)this.transport.setRequestHeader(d,a[d])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300},getStatus:function(){try{return this.transport.status||
0}catch(a){return 0}},respondToReadyState:function(a){a=Ajax.Request.Events[a];var b=new Ajax.Response(this);if(a=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(c){this.dispatchException(c)}var e=b.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&e&&e.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+
a]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+a,this,b,b.headerJSON)}catch(d){this.dispatchException(d)}if(a=="Complete")this.transport.onreadystatechange=Prototype.emptyFunction},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)||
null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(a){this.dispatchException(a)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Response=Class.create({initialize:function(a){this.request=a;a=this.transport=a.transport;var b=this.readyState=a.readyState;if(b>2&&!Prototype.Browser.IE||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(a.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){a=a.responseXML;this.responseXML=Object.isUndefined(a)?null:a;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,
getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||
!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});
Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,c,e){this.container={success:b.success||b,failure:b.failure||(b.success?null:b)};e=Object.clone(e);var d=e.onComplete;e.onComplete=function(g,f){this.updateContent(g.responseText);Object.isFunction(d)&&d(g,f)}.bind(this);$super(c,e)},updateContent:function(a){var b=this.container[this.success()?"success":"failure"],c=this.options;c.evalScripts||(a=a.stripScripts());if(b=$(b))if(c.insertion)if(Object.isString(c.insertion)){var e=
{};e[c.insertion]=a;b.insert(e)}else c.insertion(b,a);else b.update(a)}});
Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,c,e){$super(e);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=b;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},
updateComplete:function(a){if(this.options.decay){this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});
function $(a){if(arguments.length>1){for(var b=0,c=[],e=arguments.length;b<e;b++)c.push($(arguments[b]));return c}if(Object.isString(a))a=document.getElementById(a);return Element.extend(a)}if(Prototype.BrowserFeatures.XPath)document._getElementsByXPath=function(a,b){for(var c=[],e=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),d=0,g=e.snapshotLength;d<g;d++)c.push(Element.extend(e.snapshotItem(d)));return c};Node||(Node={});
Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});
(function(a){var b=function(){try{var e=document.createElement('<input name="x">');return e.tagName.toLowerCase()==="input"&&e.name==="x"}catch(d){return false}}(),c=a.Element;a.Element=function(e,d){d=d||{};e=e.toLowerCase();var g=Element.cache;if(b&&d.name){e="<"+e+' name="'+d.name+'">';delete d.name;return Element.writeAttribute(document.createElement(e),d)}g[e]||(g[e]=Element.extend(document.createElement(e)));return Element.writeAttribute(g[e].cloneNode(false),d)};Object.extend(a.Element,c||
{});if(c)a.Element.prototype=c.prototype})(this);Element.idCounter=1;Element.cache={};function purgeElement(a){var b=a._prototypeUID;if(b){Element.stopObserving(a);a._prototypeUID=void 0;delete Element.Storage[b]}}
Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(){var a=function(){var e=document.createElement("select"),d=true;e.innerHTML='<option value="test">test</option>';if(e.options&&e.options[0])d=e.options[0].nodeName.toUpperCase()!==
"OPTION";return d}(),b=function(){try{var e=document.createElement("table");if(e&&e.tBodies){e.innerHTML="<tbody><tr><td>test</td></tr></tbody>";return typeof e.tBodies[0]=="undefined"}}catch(d){return true}}(),c=function(){var e=document.createElement("script"),d=false;try{e.appendChild(document.createTextNode(""));d=!e.firstChild||e.firstChild&&e.firstChild.nodeType!==3}catch(g){d=true}return d}();return function(e,d){e=$(e);for(var g=e.getElementsByTagName("*"),f=g.length;f--;)purgeElement(g[f]);
if(d&&d.toElement)d=d.toElement();if(Object.isElement(d))return e.update().insert(d);d=Object.toHTML(d);g=e.tagName.toUpperCase();if(g==="SCRIPT"&&c){e.text=d;return e}if(a||b)if(g in Element._insertionTranslations.tags){for(;e.firstChild;)e.removeChild(e.firstChild);Element._getContentFromAnonymousElement(g,d.stripScripts()).each(function(j){e.appendChild(j)})}else e.innerHTML=d.stripScripts();else e.innerHTML=d.stripScripts();d.evalScripts.bind(d).defer();return e}}(),replace:function(a,b){a=$(a);
if(b&&b.toElement)b=b.toElement();else if(!Object.isElement(b)){b=Object.toHTML(b);var c=a.ownerDocument.createRange();c.selectNode(a);b.evalScripts.bind(b).defer();b=c.createContextualFragment(b.stripScripts())}a.parentNode.replaceChild(b,a);return a},insert:function(a,b){a=$(a);if(Object.isString(b)||Object.isNumber(b)||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,e,d,g;for(g in b){c=b[g];g=g.toLowerCase();e=Element._insertionTranslations[g];if(c&&c.toElement)c=c.toElement();
if(Object.isElement(c))e(a,c);else{c=Object.toHTML(c);d=(g=="before"||g=="after"?a.parentNode:a).tagName.toUpperCase();d=Element._getContentFromAnonymousElement(d,c.stripScripts());if(g=="top"||g=="after")d.reverse();d.each(e.curry(a));c.evalScripts.bind(c).defer()}}return a},wrap:function(a,b,c){a=$(a);if(Object.isElement(b))$(b).writeAttribute(c||{});else b=Object.isString(b)?new Element(b,c):new Element("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b},inspect:function(a){a=
$(a);var b="<"+a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var e=c.first();c=c.last();if(e=(a[e]||"").toString())b+=" "+c+"="+e.inspect(true)});return b+">"},recursivelyCollect:function(a,b,c){a=$(a);c=c||-1;for(var e=[];a=a[b];){a.nodeType==1&&e.push(Element.extend(a));if(e.length==c)break}return e},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){for(a=$(a).firstChild;a&&
a.nodeType!=1;)a=a.nextSibling;return $(a)},immediateDescendants:function(a){var b=[];for(a=$(a).firstChild;a;){a.nodeType===1&&b.push(Element.extend(a));a=a.nextSibling}return b},previousSiblings:function(a){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(a,b){a=$(a);if(Object.isString(b))return Prototype.Selector.match(a,
b);return b.match(a)},up:function(a,b,c){a=$(a);if(arguments.length==1)return $(a.parentNode);var e=Element.ancestors(a);return Object.isNumber(b)?e[b]:Prototype.Selector.find(e,b,c)},down:function(a,b,c){a=$(a);if(arguments.length==1)return Element.firstDescendant(a);return Object.isNumber(b)?Element.descendants(a)[b]:Element.select(a,b)[c||0]},previous:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);return b?Prototype.Selector.find(a.previousSiblings(),b,c):a.recursivelyCollect("previousSibling",
c+1)[c]},next:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);if(b)return Prototype.Selector.find(a.nextSiblings(),b,c);else{Object.isNumber(c);return a.recursivelyCollect("nextSibling",c+1)[c]}},select:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a)},adjacent:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a.parentNode).without(a)},identify:function(a){a=
$(a);var b=Element.readAttribute(a,"id");if(b)return b;do b="anonymous_element_"+Element.idCounter++;while($(b));Element.writeAttribute(a,"id",b);return b},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){var c=Element._attributeTranslations.read;if(c.values[b])return c.values[b](a,b);if(c.names[b])b=c.names[b];if(b.include(":"))return!a.attributes||!a.attributes[b]?null:a.attributes[b].value}return a.getAttribute(b)},writeAttribute:function(a,b,c){a=$(a);var e={},d=Element._attributeTranslations.write;
if(typeof b=="object")e=b;else e[b]=Object.isUndefined(c)?true:c;for(var g in e){b=d.names[g]||g;c=e[g];if(d.values[g])b=d.values[g](a,c);if(c===false||c===null)a.removeAttribute(b);else c===true?a.setAttribute(b,b):a.setAttribute(b,c)}return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(a=$(a)){var c=a.className;return c.length>0&&(c==
b||RegExp("(^|\\s)"+b+"(\\s|$)").test(c))}},addClassName:function(a,b){if(a=$(a)){Element.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b);return a}},removeClassName:function(a,b){if(a=$(a)){a.className=a.className.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a}},toggleClassName:function(a,b){if(a=$(a))return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(a){a=$(a);for(var b=a.firstChild;b;){var c=b.nextSibling;b.nodeType==
3&&!/\S/.test(b.nodeValue)&&a.removeChild(b);b=c}return a},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(a,b){a=$(a);b=$(b);if(a.compareDocumentPosition)return(a.compareDocumentPosition(b)&8)===8;if(b.contains)return b.contains(a)&&b!==a;for(;a=a.parentNode;)if(a==b)return true;return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a);b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];
if(!c||c=="auto")c=(c=document.defaultView.getComputedStyle(a,null))?c[b]:null;if(b=="opacity")return c?parseFloat(c):1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b){a=$(a);var c=a.style;if(Object.isString(b)){a.style.cssText+=";"+b;return b.include("opacity")?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a}for(var e in b)if(e=="opacity")a.setOpacity(b[e]);else c[e=="float"||e=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":
e]=b[e];return a},setOpacity:function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;return a},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=
$(a);if(a._overflow)return a;a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden")a.style.overflow="hidden";return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},cumulativeOffset:function(a){var b=0,c=0;if(a.parentNode){do{b+=a.offsetTop||0;c+=a.offsetLeft||0;a=a.offsetParent}while(a)}return Element._returnOffset(c,b)},positionedOffset:function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=
a.offsetLeft||0;if(a=a.offsetParent){if(a.tagName.toUpperCase()=="BODY")break;if(Element.getStyle(a,"position")!=="static")break}}while(a);return Element._returnOffset(c,b)},absolutize:function(a){a=$(a);if(Element.getStyle(a,"position")=="absolute")return a;var b=Element.positionedOffset(a),c=b[1];b=b[0];var e=a.clientWidth,d=a.clientHeight;a._originalLeft=b-parseFloat(a.style.left||0);a._originalTop=c-parseFloat(a.style.top||0);a._originalWidth=a.style.width;a._originalHeight=a.style.height;a.style.position=
"absolute";a.style.top=c+"px";a.style.left=b+"px";a.style.width=e+"px";a.style.height=d+"px";return a},relativize:function(a){a=$(a);if(Element.getStyle(a,"position")=="relative")return a;a.style.position="relative";var b=parseFloat(a.style.top||0)-(a._originalTop||0),c=parseFloat(a.style.left||0)-(a._originalLeft||0);a.style.top=b+"px";a.style.left=c+"px";a.style.height=a._originalHeight;a.style.width=a._originalWidth;return a},cumulativeScrollOffset:function(a){var b=0,c=0;do{b+=a.scrollTop||0;
c+=a.scrollLeft||0;a=a.parentNode}while(a);return Element._returnOffset(c,b)},getOffsetParent:function(a){if(a.offsetParent)return $(a.offsetParent);if(a==document.body)return $(a);for(;(a=a.parentNode)&&a!=document.body;)if(Element.getStyle(a,"position")!="static")return $(a);return $(document.body)},viewportOffset:function(a){var b=0,c=0,e=a;do{b+=e.offsetTop||0;c+=e.offsetLeft||0;if(e.offsetParent==document.body&&Element.getStyle(e,"position")=="absolute")break}while(e=e.offsetParent);e=a;do if(!Prototype.Browser.Opera||
e.tagName&&e.tagName.toUpperCase()=="BODY"){b-=e.scrollTop||0;c-=e.scrollLeft||0}while(e=e.parentNode);return Element._returnOffset(c,b)},clonePosition:function(a,b,c){c=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},c||{});b=$(b);var e=Element.viewportOffset(b),d=[0,0],g=null;a=$(a);if(Element.getStyle(a,"position")=="absolute"){g=Element.getOffsetParent(a);d=Element.viewportOffset(g)}if(g==document.body){d[0]-=document.body.offsetLeft;d[1]-=document.body.offsetTop}if(c.setLeft)a.style.left=
e[0]-d[0]+c.offsetLeft+"px";if(c.setTop)a.style.top=e[1]-d[1]+c.offsetTop+"px";if(c.setWidth)a.style.width=b.offsetWidth+"px";if(c.setHeight)a.style.height=b.offsetHeight+"px";return a}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};
if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(a,b,c){switch(c){case "left":case "top":case "right":case "bottom":if(a(b,"position")==="static")return null;case "height":case "width":if(!Element.visible(b))return null;var e=parseInt(a(b,c),10);if(e!==b["offset"+c.capitalize()])return e+"px";return(c==="height"?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"]).inject(e,
function(d,g){var f=a(b,g);return f===null?d:d-parseInt(f,10)})+"px";default:return a(b,c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(a,b,c){if(c==="title")return b.title;return a(b,c)})}else if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(a,b){b=$(b);if(!b.parentNode)return $(document.body);var c=b.getStyle("position");if(c!=="static")return a(b);b.setStyle({position:"relative"});var e=a(b);b.setStyle({position:c});
return e});$w("positionedOffset viewportOffset").each(function(a){Element.Methods[a]=Element.Methods[a].wrap(function(b,c){c=$(c);if(!c.parentNode)return Element._returnOffset(0,0);var e=c.getStyle("position");if(e!=="static")return b(c);var d=c.getOffsetParent();d&&d.getStyle("position")==="fixed"&&d.setStyle({zoom:1});c.setStyle({position:"relative"});d=b(c);c.setStyle({position:e});return d})});Element.Methods.getStyle=function(a,b){a=$(a);b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();
var c=a.style[b];if(!c&&a.currentStyle)c=a.currentStyle[b];if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!="none")return a["offset"+b.capitalize()]+"px";return null}return c};Element.Methods.setOpacity=function(a,b){a=$(a);var c=a.currentStyle;if(c&&!c.hasLayout||!c&&a.style.zoom=="normal")a.style.zoom=1;c=a.getStyle("filter");var e=a.style;if(b==1||b===""){(c=
c.replace(/alpha\([^\)]*\)/gi,""))?e.filter=c:e.removeAttribute("filter");return a}else if(b<1.0E-5)b=0;e.filter=c.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+b*100+")";return a};Element._attributeTranslations=function(){var a="className",b="for",c=document.createElement("div");c.setAttribute(a,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x")a="class"}c=null;c=document.createElement("label");c.setAttribute(b,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");if(c.htmlFor===
"x")b="htmlFor"}c=null;return{read:{names:{"class":a,className:a,"for":b,htmlFor:b},values:{_getAttr:function(e,d){return e.getAttribute(d)},_getAttr2:function(e,d){return e.getAttribute(d,2)},_getAttrNode:function(e,d){var g=e.getAttributeNode(d);return g?g.value:""},_getEv:function(){var e=document.createElement("div"),d;e.onclick=Prototype.emptyFunction;e=e.getAttribute("onclick");if(String(e).indexOf("{")>-1)d=function(g,f){f=g.getAttribute(f);if(!f)return null;f=f.toString();f=f.split("{")[1];
f=f.split("}")[0];return f.strip()};else if(e==="")d=function(g,f){f=g.getAttribute(f);if(!f)return null;return f.strip()};e=null;return d}(),_flag:function(e,d){return $(e).hasAttribute(d)?d:null},style:function(e){return e.style.cssText.toLowerCase()},title:function(e){return e.title}}}}}();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=!!b},style:function(a,
b){a.style.cssText=b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,
onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);Prototype.BrowserFeatures.ElementExtensions&&function(){Element.Methods.down=function(a,b,c){a=$(a);if(arguments.length==1)return a.firstDescendant();var e;
if(Object.isNumber(b)){e=a.getElementsByTagName("*");for(var d=[],g=0,f;f=e[g];g++)f.tagName!=="!"&&d.push(f);e=d[b]}else e=Element.select(a,b)[c||0];return e}}()}else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent))Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1?0.999999:b===""?"":b<1.0E-5?0:b;return a};else if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;if(b==1)if(a.tagName.toUpperCase()==
"IMG"&&a.width){a.width++;a.width--}else try{var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(e){}return a};Element.Methods.cumulativeOffset=function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=a.offsetLeft||0;if(a.offsetParent==document.body)if(Element.getStyle(a,"position")=="absolute")break;a=a.offsetParent}while(a);return Element._returnOffset(c,b)}}
if("outerHTML"in document.documentElement)Element.Methods.replace=function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();if(Object.isElement(b)){a.parentNode.replaceChild(b,a);return a}b=Object.toHTML(b);var c=a.parentNode,e=c.tagName.toUpperCase();if(Element._insertionTranslations.tags[e]){var d=a.next();e=Element._getContentFromAnonymousElement(e,b.stripScripts());c.removeChild(a);d?e.each(function(g){c.insertBefore(g,d)}):e.each(function(g){c.appendChild(g)})}else a.outerHTML=b.stripScripts();
b.evalScripts.bind(b).defer();return a};Element._returnOffset=function(a,b){var c=[a,b];c.left=a;c.top=b;return c};Element._getContentFromAnonymousElement=function(a,b){var c=new Element("div"),e=Element._insertionTranslations.tags[a];if(e){c.innerHTML=e[0]+b+e[1];for(e=e[2];e--;)c=c.firstChild}else c.innerHTML=b;return $A(c.childNodes)};
Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};
(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,b){b=Element._attributeTranslations.has[b]||b;var c=$(a).getAttributeNode(b);return!!(c&&c.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);
(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}})(document.createElement("div"));
Element.extend=function(){function a(d,g){for(var f in g){var j=g[f];if(Object.isFunction(j)&&!(f in d))d[f]=j.methodize()}}var b=function(d){if(typeof window.Element!="undefined"){var g=window.Element.prototype;if(g){var f="_"+(Math.random()+"").slice(2);d=document.createElement(d);g[f]="x";d=d[f]!=="x";delete g[f];return d}}return false}("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(b)return function(d){if(d&&typeof d._extendedByPrototype=="undefined"){var g=d.tagName;if(g&&
/^(?:object|applet|embed)$/i.test(g)){a(d,Element.Methods);a(d,Element.Methods.Simulated);a(d,Element.Methods.ByTag[g.toUpperCase()])}}return d};return Prototype.K}var c={},e=Element.Methods.ByTag;b=Object.extend(function(d){if(!d||typeof d._extendedByPrototype!="undefined"||d.nodeType!=1||d==window)return d;var g=Object.clone(c),f=d.tagName.toUpperCase();e[f]&&Object.extend(g,e[f]);a(d,g);d._extendedByPrototype=Prototype.emptyFunction;return d},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(c,
Element.Methods);Object.extend(c,Element.Methods.Simulated)}}});b.refresh();return b}();Element.hasAttribute=document.documentElement.hasAttribute?function(a,b){return a.hasAttribute(b)}:Element.Methods.Simulated.hasAttribute;
Element.addMethods=function(a){function b(h){h=h.toUpperCase();Element.Methods.ByTag[h]||(Element.Methods.ByTag[h]={});Object.extend(Element.Methods.ByTag[h],a)}function c(h,m,r){r=r||false;for(var w in h){var y=h[w];if(Object.isFunction(y))if(!r||!(w in m))m[w]=y.methodize()}}function e(h){var m,r={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",
Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(r[h])m="HTML"+r[h]+"Element";if(window[m])return window[m];m="HTML"+h+"Element";if(window[m])return window[m];m="HTML"+h.capitalize()+"Element";if(window[m])return window[m];h=document.createElement(h);return h.__proto__||h.constructor.prototype}
var d=Prototype.BrowserFeatures,g=Element.Methods.ByTag;if(!a){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var f=a;a=arguments[1]}if(f)Object.isArray(f)?f.each(b):b(f);else Object.extend(Element.Methods,a||{});f=window.HTMLElement?HTMLElement.prototype:
Element.prototype;if(d.ElementExtensions){c(Element.Methods,f);c(Element.Methods.Simulated,f,true)}if(d.SpecificElementExtensions)for(var j in Element.Methods.ByTag){d=e(j);Object.isUndefined(d)||c(g[j],d.prototype)}Object.extend(Element,Element.Methods);delete Element.ByTag;Element.extend.refresh&&Element.extend.refresh();Element.cache={}};
document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};
(function(a){function b(){if(e.WebKit&&!d.evaluate)return document;if(e.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}function c(j){g||(g=b());f[j]="client"+j;a["get"+j]=function(){return g[f[j]]};return a["get"+j]()}var e=Prototype.Browser,d=document,g,f={};a.getWidth=c.curry("Width");a.getHeight=c.curry("Height")})(document.viewport);Element.Storage={UID:1};
Element.addMethods({getStorage:function(a){if(a=$(a)){if(a===window)a=0;else{if(typeof a._prototypeUID==="undefined")a._prototypeUID=Element.Storage.UID++;a=a._prototypeUID}Element.Storage[a]||(Element.Storage[a]=$H());return Element.Storage[a]}},store:function(a,b,c){if(a=$(a)){arguments.length===2?Element.getStorage(a).update(b):Element.getStorage(a).set(b,c);return a}},retrieve:function(a,b,c){if(a=$(a)){a=Element.getStorage(a);var e=a.get(b);if(Object.isUndefined(e)){a.set(b,c);e=c}return e}},
clone:function(a,b){if(a=$(a)){var c=a.cloneNode(b);c._prototypeUID=void 0;if(b)for(var e=Element.select(c,"*"),d=e.length;d--;)e[d]._prototypeUID=void 0;return Element.extend(c)}},purge:function(a){if(a=$(a)){purgeElement(a);a=a.getElementsByTagName("*");for(var b=a.length;b--;)purgeElement(a[b]);return null}}});
(function(){function a(f,j){if(Object.isElement(f)){element=f;f=element.getStyle(j)}if(f===null)return null;if(/^(?:-)?\d+(\.\d+)?(px)?$/i.test(f))return window.parseFloat(f);if(/\d/.test(f)&&element.runtimeStyle){var h=element.style.left,m=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=f||0;f=element.style.pixelLeft;element.style.left=h;element.runtimeStyle.left=m;return f}if(f.include("%")){m=(m=f.match(/^(\d+)%?$/i))?Number(m[1])/100:null;if(j.include("left")||
j.include("right")||j.include("width"))h=$(element.parentNode).measure("width");else if(j.include("top")||j.include("bottom")||j.include("height"))h=$(element.parentNode).measure("height");return h*m}return 0}function b(f){if(d(f))return $(document.body);if(Element.getStyle(f,"display")!=="inline"&&f.offsetParent)return $(f.offsetParent);if(f===document.body)return $(f);for(;(f=f.parentNode)&&f!==document.body;)if(Element.getStyle(f,"position")!=="static")return f.nodeName==="HTML"?$(document.body):
$(f);return $(document.body)}function c(f){var j=f.getLayout(),h=0,m=0;do{h+=f.offsetTop||0;m+=f.offsetLeft||0;if(f=f.offsetParent){if(f.nodeName.toUpperCase()==="BODY")break;if(Element.getStyle(f,"position")!=="static")break}}while(f);m-=j.get("margin-top");h-=j.get("margin-left");return new Element.Offset(m,h)}function e(f){var j=0,h=0,m=document.body,r=f;do{j+=r.offsetTop||0;h+=r.offsetLeft||0;if(r.offsetParent==m&&Element.getStyle(r,"position")=="absolute")break}while(r=r.offsetParent);r=f;do if(r!=
m){j-=r.scrollTop||0;h-=r.scrollLeft||0}while(r=r.parentNode);return new Element.Offset(h,j)}function d(f){return f!==document.body&&!Element.descendantOf(f,document.body)}var g=Prototype.K;if("currentStyle"in document.documentElement)g=function(f){if(!f.currentStyle.hasLayout)f.style.zoom=1;return f};Element.Layout=Class.create(Hash,{initialize:function($super,j,h){$super();this.element=$(j);Element.Layout.PROPERTIES.each(function(m){this._set(m,null)},this);if(h){this._preComputing=true;this._begin();
Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(f,j){return Hash.prototype.set.call(this,f,j)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,j){var h=$super(j);return h===null?this._compute(j):h},_begin:function(){if(!this._prepared){var f=this.element,j;a:{for(j=f;j&&j.parentNode;){if(j.getStyle("display")==="none"){j=false;break a}j=$(j.parentNode)}j=true}if(!j){f.store("prototype_original_styles",
{position:f.style.position||"",width:f.style.width||"",visibility:f.style.visibility||"",display:f.style.display||""});j=f.getStyle("position");var h=f.getStyle("width");f.setStyle({position:"absolute",visibility:"hidden",display:"block"});var m=f.getStyle("width");j=h&&m===h?a(h):h&&(j==="absolute"||j==="fixed")?a(h):$(f.parentNode).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");
f.setStyle({width:j+"px"})}this._prepared=true}},_end:function(){var f=this.element,j=f.retrieve("prototype_original_styles");f.store("prototype_original_styles",null);f.setStyle(j);this._prepared=false},_compute:function(f){var j=Element.Layout.COMPUTATIONS;if(!(f in j))throw"Property not found.";return this._set(f,j[f].call(this,this.element))},toObject:function(){var f=$A(arguments),j={};(f.length===0?Element.Layout.PROPERTIES:f.join(" ").split(" ")).each(function(h){if(Element.Layout.PROPERTIES.include(h)){var m=
this.get(h);if(m!=null)j[h]=m}},this);return j},toHash:function(){var f=this.toObject.apply(this,arguments);return new Hash(f)},toCSS:function(){var f=$A(arguments),j={};(f.length===0?Element.Layout.PROPERTIES:f.join(" ").split(" ")).each(function(h){if(Element.Layout.PROPERTIES.include(h))if(!Element.Layout.COMPOSITE_PROPERTIES.include(h)){var m=this.get(h);if(m!=null){h=h;if(h.include("border"))h+="-width";h=h.camelize();j[h]=m+"px"}}},this);return j},inspect:function(){return"#<Element.Layout>"}});
Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(){this._preComputing||
this._begin();var f=this.get("border-box-height");if(f<=0)return 0;var j=this.get("border-top"),h=this.get("border-bottom"),m=this.get("padding-top"),r=this.get("padding-bottom");this._preComputing||this._end();return f-j-h-m-r},width:function(){this._preComputing||this._begin();var f=this.get("border-box-width");if(f<=0)return 0;var j=this.get("border-left"),h=this.get("border-right"),m=this.get("padding-left"),r=this.get("padding-right");this._preComputing||this._end();return f-j-h-m-r},"padding-box-height":function(){var f=
this.get("height"),j=this.get("padding-top"),h=this.get("padding-bottom");return f+j+h},"padding-box-width":function(){var f=this.get("width"),j=this.get("padding-left"),h=this.get("padding-right");return f+j+h},"border-box-height":function(f){return f.offsetHeight},"border-box-width":function(f){return f.offsetWidth},"margin-box-height":function(){var f=this.get("border-box-height"),j=this.get("margin-top"),h=this.get("margin-bottom");if(f<=0)return 0;return f+j+h},"margin-box-width":function(){var f=
this.get("border-box-width"),j=this.get("margin-left"),h=this.get("margin-right");if(f<=0)return 0;return f+j+h},top:function(f){return f.positionedOffset().top},bottom:function(f){var j=f.positionedOffset();f=f.getOffsetParent().measure("height");var h=this.get("border-box-height");return f-h-j.top},left:function(f){return f.positionedOffset().left},right:function(f){var j=f.positionedOffset();f=f.getOffsetParent().measure("width");var h=this.get("border-box-width");return f-h-j.left},"padding-top":function(f){return a(f,
"paddingTop")},"padding-bottom":function(f){return a(f,"paddingBottom")},"padding-left":function(f){return a(f,"paddingLeft")},"padding-right":function(f){return a(f,"paddingRight")},"border-top":function(f){return Object.isNumber(f.clientTop)?f.clientTop:a(f,"borderTopWidth")},"border-bottom":function(f){return Object.isNumber(f.clientBottom)?f.clientBottom:a(f,"borderBottomWidth")},"border-left":function(f){return Object.isNumber(f.clientLeft)?f.clientLeft:a(f,"borderLeftWidth")},"border-right":function(f){return Object.isNumber(f.clientRight)?
f.clientRight:a(f,"borderRightWidth")},"margin-top":function(f){return a(f,"marginTop")},"margin-bottom":function(f){return a(f,"marginBottom")},"margin-left":function(f){return a(f,"marginLeft")},"margin-right":function(f){return a(f,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(f){var j=g(f.getOffsetParent());f=f.getBoundingClientRect();return(j.getBoundingClientRect().right-f.right).round()},bottom:function(f){var j=
g(f.getOffsetParent());f=f.getBoundingClientRect();return(j.getBoundingClientRect().bottom-f.bottom).round()}});Element.Offset=Class.create({initialize:function(f,j){this.left=f.round();this.top=j.round();this[0]=this.left;this[1]=this.top},relativeTo:function(f){return new Element.Offset(this.left-f.left,this.top-f.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,
this.top]}});Element.addMethods({getLayout:function(f,j){return new Element.Layout(f,j)},measure:function(f,j){return $(f).getLayout().get(j)},getDimensions:function(f){f=$(f).getLayout();return{width:f.get("width"),height:f.get("height")}},getOffsetParent:b,cumulativeOffset:function(f){var j=0,h=0;do{j+=f.offsetTop||0;h+=f.offsetLeft||0;f=f.offsetParent}while(f);return new Element.Offset(h,j)},positionedOffset:c,cumulativeScrollOffset:function(f){var j=0,h=0;do{j+=f.scrollTop||0;h+=f.scrollLeft||
0;f=f.parentNode}while(f);return new Element.Offset(h,j)},viewportOffset:e,absolutize:function(f){f=$(f);if(Element.getStyle(f,"position")==="absolute")return f;var j=b(f),h=f.viewportOffset();j=j.viewportOffset();h=h.relativeTo(j);j=f.getLayout();f.store("prototype_absolutize_original_styles",{left:f.getStyle("left"),top:f.getStyle("top"),width:f.getStyle("width"),height:f.getStyle("height")});f.setStyle({position:"absolute",top:h.top+"px",left:h.left+"px",width:j.get("width")+"px",height:j.get("height")+
"px"});return f},relativize:function(f){f=$(f);if(Element.getStyle(f,"position")==="relative")return f;var j=f.retrieve("prototype_absolutize_original_styles");j&&f.setStyle(j);return f}});"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(f){f=$(f);if(d(f))return new Element.Offset(0,0);f=f.getBoundingClientRect();var j=document.documentElement;return new Element.Offset(f.left-j.clientLeft,f.top-j.clientTop)},positionedOffset:function(f){f=$(f);var j=
f.getOffsetParent();if(d(f))return new Element.Offset(0,0);if(f.offsetParent&&f.offsetParent.nodeName.toUpperCase()==="HTML")return c(f);var h=f.viewportOffset();j=j.nodeName.toUpperCase()==="BODY"?e(j):j.viewportOffset();h=h.relativeTo(j);j=f.getLayout();f=h.top-j.get("margin-top");h=h.left-j.get("margin-left");return new Element.Offset(h,f)}})})();window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};
Prototype.Selector=function(){function a(c){for(var e=0,d=c.length;e<d;e++)Element.extend(c[e]);return c}var b=Prototype.K;return{select:function(){throw Error('Method "Prototype.Selector.select" must be defined.');},match:function(){throw Error('Method "Prototype.Selector.match" must be defined.');},find:function(c,e,d){d=d||0;var g=Prototype.Selector.match,f=c.length,j=0,h;for(h=0;h<f;h++)if(g(c[h],e)&&d==j++)return Element.extend(c[h])},extendElements:Element.extend===b?b:a,extendElement:Element.extend}}();
Prototype._original_property=window.Sizzle;
(function(){function a(l,i,o,n,q,p){q=l=="previousSibling"&&!p;for(var s=0,x=n.length;s<x;s++){var u=n[s];if(u){if(q&&u.nodeType===1){u.sizcache=o;u.sizset=s}u=u[l];for(var C=false;u;){if(u.sizcache===o){C=n[u.sizset];break}if(u.nodeType===1&&!p){u.sizcache=o;u.sizset=s}if(u.nodeName===i){C=u;break}u=u[l]}n[s]=C}}}function b(l,i,o,n,q,p){q=l=="previousSibling"&&!p;for(var s=0,x=n.length;s<x;s++){var u=n[s];if(u){if(q&&u.nodeType===1){u.sizcache=o;u.sizset=s}u=u[l];for(var C=false;u;){if(u.sizcache===
o){C=n[u.sizset];break}if(u.nodeType===1){if(!p){u.sizcache=o;u.sizset=s}if(typeof i!=="string"){if(u===i){C=true;break}}else if(j.filter(i,[u]).length>0){C=u;break}}u=u[l]}n[s]=C}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,d=Object.prototype.toString,g=false,f=true;[0,0].sort(function(){f=false;return 0});var j=function(l,i,o,n){o=o||[];var q=i=i||document;if(i.nodeType!==1&&i.nodeType!==9)return[];
if(!l||typeof l!=="string")return o;for(var p=[],s,x,u,C,D=true,G=B(i),F=l;(c.exec(""),s=c.exec(F))!==null;){F=s[3];p.push(s[1]);if(s[2]){C=s[3];break}}if(p.length>1&&m.exec(l))if(p.length===2&&h.relative[p[0]])x=A(p[0]+p[1],i);else for(x=h.relative[p[0]]?[i]:j(p.shift(),i);p.length;){l=p.shift();if(h.relative[l])l+=p.shift();x=A(l,x)}else{if(!n&&p.length>1&&i.nodeType===9&&!G&&h.match.ID.test(p[0])&&!h.match.ID.test(p[p.length-1])){s=j.find(p.shift(),i,G);i=s.expr?j.filter(s.expr,s.set)[0]:s.set[0]}if(i){s=
n?{expr:p.pop(),set:w(n)}:j.find(p.pop(),p.length===1&&(p[0]==="~"||p[0]==="+")&&i.parentNode?i.parentNode:i,G);x=s.expr?j.filter(s.expr,s.set):s.set;if(p.length>0)u=w(x);else D=false;for(;p.length;){var E=p.pop();s=E;if(h.relative[E])s=p.pop();else E="";if(s==null)s=i;h.relative[E](u,s,G)}}else u=[]}u||(u=x);if(!u)throw"Syntax error, unrecognized expression: "+(E||l);if(d.call(u)==="[object Array]")if(D)if(i&&i.nodeType===1)for(l=0;u[l]!=null;l++){if(u[l]&&(u[l]===true||u[l].nodeType===1&&z(i,u[l])))o.push(x[l])}else for(l=
0;u[l]!=null;l++)u[l]&&u[l].nodeType===1&&o.push(x[l]);else o.push.apply(o,u);else w(u,o);if(C){j(C,q,o,n);j.uniqueSort(o)}return o};j.uniqueSort=function(l){if(v){g=f;l.sort(v);if(g)for(var i=1;i<l.length;i++)l[i]===l[i-1]&&l.splice(i--,1)}return l};j.matches=function(l,i){return j(l,null,null,i)};j.find=function(l,i,o){var n,q;if(!l)return[];for(var p=0,s=h.order.length;p<s;p++){var x=h.order[p];if(q=h.leftMatch[x].exec(l)){var u=q[1];q.splice(1,1);if(u.substr(u.length-1)!=="\\"){q[1]=(q[1]||"").replace(/\\/g,
"");n=h.find[x](q,i,o);if(n!=null){l=l.replace(h.match[x],"");break}}}}n||(n=i.getElementsByTagName("*"));return{set:n,expr:l}};j.filter=function(l,i,o,n){for(var q=l,p=[],s=i,x,u,C=i&&i[0]&&B(i[0]);l&&i.length;){for(var D in h.filter)if((x=h.match[D].exec(l))!=null){var G=h.filter[D],F,E;u=false;if(s==p)p=[];if(h.preFilter[D])if(x=h.preFilter[D](x,s,o,p,n,C)){if(x===true)continue}else u=F=true;if(x)for(var H=0;(E=s[H])!=null;H++)if(E){F=G(E,x,H,s);var I=n^!!F;if(o&&F!=null)if(I)u=true;else s[H]=
false;else if(I){p.push(E);u=true}}if(F!==undefined){o||(s=p);l=l.replace(h.match[D],"");if(!u)return[];break}}if(l==q)if(u==null)throw"Syntax error, unrecognized expression: "+l;else break;q=l}return s};var h=j.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,
CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(l){return l.getAttribute("href")}},relative:{"+":function(l,i,o){var n=typeof i==="string",q=n&&!/\W/.test(i);n=n&&!q;if(q&&!o)i=i.toUpperCase();o=0;q=l.length;for(var p;o<q;o++)if(p=l[o]){for(;(p=p.previousSibling)&&
p.nodeType!==1;);l[o]=n||p&&p.nodeName===i?p||false:p===i}n&&j.filter(i,l,true)},">":function(l,i,o){var n=typeof i==="string";if(n&&!/\W/.test(i)){i=o?i:i.toUpperCase();o=0;for(var q=l.length;o<q;o++){var p=l[o];if(p){n=p.parentNode;l[o]=n.nodeName===i?n:false}}}else{o=0;for(q=l.length;o<q;o++)if(p=l[o])l[o]=n?p.parentNode:p.parentNode===i;n&&j.filter(i,l,true)}},"":function(l,i,o){var n=e++,q=b;if(!/\W/.test(i)){var p=i=o?i:i.toUpperCase();q=a}q("parentNode",i,n,l,p,o)},"~":function(l,i,o){var n=
e++,q=b;if(typeof i==="string"&&!/\W/.test(i)){var p=i=o?i:i.toUpperCase();q=a}q("previousSibling",i,n,l,p,o)}},find:{ID:function(l,i,o){if(typeof i.getElementById!=="undefined"&&!o)return(l=i.getElementById(l[1]))?[l]:[]},NAME:function(l,i){if(typeof i.getElementsByName!=="undefined"){for(var o=[],n=i.getElementsByName(l[1]),q=0,p=n.length;q<p;q++)n[q].getAttribute("name")===l[1]&&o.push(n[q]);return o.length===0?null:o}},TAG:function(l,i){return i.getElementsByTagName(l[1])}},preFilter:{CLASS:function(l,
i,o,n,q,p){l=" "+l[1].replace(/\\/g,"")+" ";if(p)return l;p=0;for(var s;(s=i[p])!=null;p++)if(s)if(q^(s.className&&(" "+s.className+" ").indexOf(l)>=0))o||n.push(s);else if(o)i[p]=false;return false},ID:function(l){return l[1].replace(/\\/g,"")},TAG:function(l,i){for(var o=0;i[o]===false;o++);return i[o]&&B(i[o])?l[1]:l[1].toUpperCase()},CHILD:function(l){if(l[1]=="nth"){var i=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(l[2]=="even"&&"2n"||l[2]=="odd"&&"2n+1"||!/\D/.test(l[2])&&"0n+"+l[2]||l[2]);l[2]=i[1]+(i[2]||
1)-0;l[3]=i[3]-0}l[0]=e++;return l},ATTR:function(l,i,o,n,q,p){i=l[1].replace(/\\/g,"");if(!p&&h.attrMap[i])l[1]=h.attrMap[i];if(l[2]==="~=")l[4]=" "+l[4]+" ";return l},PSEUDO:function(l,i,o,n,q){if(l[1]==="not")if((c.exec(l[3])||"").length>1||/^\w/.test(l[3]))l[3]=j(l[3],null,null,i);else{l=j.filter(l[3],i,o,true^q);o||n.push.apply(n,l);return false}else if(h.match.POS.test(l[0])||h.match.CHILD.test(l[0]))return true;return l},POS:function(l){l.unshift(true);return l}},filters:{enabled:function(l){return l.disabled===
false&&l.type!=="hidden"},disabled:function(l){return l.disabled===true},checked:function(l){return l.checked===true},selected:function(l){return l.selected===true},parent:function(l){return!!l.firstChild},empty:function(l){return!l.firstChild},has:function(l,i,o){return!!j(o[3],l).length},header:function(l){return/h\d/i.test(l.nodeName)},text:function(l){return"text"===l.type},radio:function(l){return"radio"===l.type},checkbox:function(l){return"checkbox"===l.type},file:function(l){return"file"===
l.type},password:function(l){return"password"===l.type},submit:function(l){return"submit"===l.type},image:function(l){return"image"===l.type},reset:function(l){return"reset"===l.type},button:function(l){return"button"===l.type||l.nodeName.toUpperCase()==="BUTTON"},input:function(l){return/input|select|textarea|button/i.test(l.nodeName)}},setFilters:{first:function(l,i){return i===0},last:function(l,i,o,n){return i===n.length-1},even:function(l,i){return i%2===0},odd:function(l,i){return i%2===1},
lt:function(l,i,o){return i<o[3]-0},gt:function(l,i,o){return i>o[3]-0},nth:function(l,i,o){return o[3]-0==i},eq:function(l,i,o){return o[3]-0==i}},filter:{PSEUDO:function(l,i,o,n){var q=i[1],p=h.filters[q];if(p)return p(l,o,i,n);else if(q==="contains")return(l.textContent||l.innerText||"").indexOf(i[3])>=0;else if(q==="not"){i=i[3];o=0;for(n=i.length;o<n;o++)if(i[o]===l)return false;return true}},CHILD:function(l,i){var o=i[1],n=l;switch(o){case "only":case "first":for(;n=n.previousSibling;)if(n.nodeType===
1)return false;if(o=="first")return true;n=l;case "last":for(;n=n.nextSibling;)if(n.nodeType===1)return false;return true;case "nth":o=i[2];var q=i[3];if(o==1&&q==0)return true;var p=i[0],s=l.parentNode;if(s&&(s.sizcache!==p||!l.nodeIndex)){var x=0;for(n=s.firstChild;n;n=n.nextSibling)if(n.nodeType===1)n.nodeIndex=++x;s.sizcache=p}n=l.nodeIndex-q;return o==0?n==0:n%o==0&&n/o>=0}},ID:function(l,i){return l.nodeType===1&&l.getAttribute("id")===i},TAG:function(l,i){return i==="*"&&l.nodeType===1||l.nodeName===
i},CLASS:function(l,i){return(" "+(l.className||l.getAttribute("class"))+" ").indexOf(i)>-1},ATTR:function(l,i){var o=i[1];o=h.attrHandle[o]?h.attrHandle[o](l):l[o]!=null?l[o]:l.getAttribute(o);var n=o+"",q=i[2],p=i[4];return o==null?q==="!=":q==="="?n===p:q==="*="?n.indexOf(p)>=0:q==="~="?(" "+n+" ").indexOf(p)>=0:!p?n&&o!==false:q==="!="?n!=p:q==="^="?n.indexOf(p)===0:q==="$="?n.substr(n.length-p.length)===p:q==="|="?n===p||n.substr(0,p.length+1)===p+"-":false},POS:function(l,i,o,n){var q=h.setFilters[i[2]];
if(q)return q(l,o,i,n)}}},m=h.match.POS,r;for(r in h.match){h.match[r]=RegExp(h.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source);h.leftMatch[r]=RegExp(/(^(?:.|\r|\n)*?)/.source+h.match[r].source)}var w=function(l,i){l=Array.prototype.slice.call(l,0);if(i){i.push.apply(i,l);return i}return l};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(y){w=function(l,i){var o=i||[];if(d.call(l)==="[object Array]")Array.prototype.push.apply(o,l);else if(typeof l.length==="number")for(var n=
0,q=l.length;n<q;n++)o.push(l[n]);else for(n=0;l[n];n++)o.push(l[n]);return o}}var v;if(document.documentElement.compareDocumentPosition)v=function(l,i){if(!l.compareDocumentPosition||!i.compareDocumentPosition){if(l==i)g=true;return 0}var o=l.compareDocumentPosition(i)&4?-1:l===i?0:1;if(o===0)g=true;return o};else if("sourceIndex"in document.documentElement)v=function(l,i){if(!l.sourceIndex||!i.sourceIndex){if(l==i)g=true;return 0}var o=l.sourceIndex-i.sourceIndex;if(o===0)g=true;return o};else if(document.createRange)v=
function(l,i){if(!l.ownerDocument||!i.ownerDocument){if(l==i)g=true;return 0}var o=l.ownerDocument.createRange(),n=i.ownerDocument.createRange();o.setStart(l,0);o.setEnd(l,0);n.setStart(i,0);n.setEnd(i,0);o=o.compareBoundaryPoints(Range.START_TO_END,n);if(o===0)g=true;return o};(function(){var l=document.createElement("div"),i="script"+(new Date).getTime();l.innerHTML="<a name='"+i+"'/>";var o=document.documentElement;o.insertBefore(l,o.firstChild);if(document.getElementById(i)){h.find.ID=function(n,
q,p){if(typeof q.getElementById!=="undefined"&&!p)return(q=q.getElementById(n[1]))?q.id===n[1]||typeof q.getAttributeNode!=="undefined"&&q.getAttributeNode("id").nodeValue===n[1]?[q]:undefined:[]};h.filter.ID=function(n,q){var p=typeof n.getAttributeNode!=="undefined"&&n.getAttributeNode("id");return n.nodeType===1&&p&&p.nodeValue===q}}o.removeChild(l);o=l=null})();(function(){var l=document.createElement("div");l.appendChild(document.createComment(""));if(l.getElementsByTagName("*").length>0)h.find.TAG=
function(i,o){var n=o.getElementsByTagName(i[1]);if(i[1]==="*"){for(var q=[],p=0;n[p];p++)n[p].nodeType===1&&q.push(n[p]);n=q}return n};l.innerHTML="<a href='#'></a>";if(l.firstChild&&typeof l.firstChild.getAttribute!=="undefined"&&l.firstChild.getAttribute("href")!=="#")h.attrHandle.href=function(i){return i.getAttribute("href",2)};l=null})();document.querySelectorAll&&function(){var l=j,i=document.createElement("div");i.innerHTML="<p class='TEST'></p>";if(!(i.querySelectorAll&&i.querySelectorAll(".TEST").length===
0)){j=function(n,q,p,s){q=q||document;if(!s&&q.nodeType===9&&!B(q))try{return w(q.querySelectorAll(n),p)}catch(x){}return l(n,q,p,s)};for(var o in l)j[o]=l[o];i=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var l=document.createElement("div");l.innerHTML="<div class='test e'></div><div class='test'></div>";if(l.getElementsByClassName("e").length!==0){l.lastChild.className="e";if(l.getElementsByClassName("e").length!==1){h.order.splice(1,0,"CLASS");
h.find.CLASS=function(i,o,n){if(typeof o.getElementsByClassName!=="undefined"&&!n)return o.getElementsByClassName(i[1])};l=null}}}();var z=document.compareDocumentPosition?function(l,i){return l.compareDocumentPosition(i)&16}:function(l,i){return l!==i&&(l.contains?l.contains(i):true)},B=function(l){return l.nodeType===9&&l.documentElement.nodeName!=="HTML"||!!l.ownerDocument&&l.ownerDocument.documentElement.nodeName!=="HTML"},A=function(l,i){for(var o=[],n="",q,p=i.nodeType?[i]:i;q=h.match.PSEUDO.exec(l);){n+=
q[0];l=l.replace(h.match.PSEUDO,"")}l=h.relative[l]?l+"*":l;q=0;for(var s=p.length;q<s;q++)j(l,p[q],o);return j.filter(n,o)};window.Sizzle=j})();(function(a){var b=Prototype.Selector.extendElements;Prototype.Selector.engine=a;Prototype.Selector.select=function(c,e){return b(a(c,e||document))};Prototype.Selector.match=function(c,e){return a.matches(e,[c]).length==1}})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;
var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,e,d=false,g=b.submit,f,j;if(b.hash){j={};f=function(h,m,r){if(m in h){Object.isArray(h[m])||(h[m]=[h[m]]);h[m].push(r)}else h[m]=r;return h}}else{j="";f=function(h,m,r){return h+(h?"&":"")+encodeURIComponent(m)+"="+encodeURIComponent(r)}}return a.inject(j,function(h,m){if(!m.disabled&&m.name){c=m.name;e=$(m).getValue();if(e!=
null&&m.type!="file"&&(m.type!="submit"||!d&&g!==false&&(!g||c==g)&&(d=true)))h=f(h,c,e)}return h})}};
Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){a=$(a).getElementsByTagName("*");for(var b,c=[],e=Form.Element.Serializers,d=0;b=a[d];d++)c.push(b);return c.inject([],function(g,f){e[f.tagName.toLowerCase()]&&g.push(Element.extend(f));return g})},getInputs:function(a,b,c){a=$(a);a=a.getElementsByTagName("input");if(!b&&!c)return $A(a).map(Element.extend);for(var e=0,d=[],g=a.length;e<g;e++){var f=a[e];b&&f.type!=b||c&&f.name!=c||
d.push(Element.extend(f))}return d},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){a=$(a).getElements().findAll(function(c){return"hidden"!=c.type&&!c.disabled});var b=a.findAll(function(c){return c.hasAttribute("tabIndex")&&c.tabIndex>=0}).sortBy(function(c){return c.tabIndex}).first();return b?b:a.find(function(c){return/^(?:input|select|textarea)$/i.test(c.tagName)})},
focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(a,b){a=$(a);b=Object.clone(b||{});var c=b.parameters,e=a.readAttribute("action")||"";if(e.blank())e=window.location.href;b.parameters=a.serialize(true);if(c){if(Object.isString(c))c=c.toQueryParams();Object.extend(b.parameters,c)}if(a.hasAttribute("method")&&!b.method)b.method=a.method;return new Ajax.Request(e,b)}};
Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};
Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();
if(a.select&&(a.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(a.type)))a.select()}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;
Form.Element.Serializers={input:function(a,b){switch(a.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(a,b);default:return Form.Element.Serializers.textarea(a,b)}},inputSelector:function(a,b){if(Object.isUndefined(b))return a.checked?a.value:null;else a.checked=!!b},textarea:function(a,b){if(Object.isUndefined(b))return a.value;else a.value=b},select:function(a,b){if(Object.isUndefined(b))return this[a.type=="select-one"?"selectOne":"selectMany"](a);
else for(var c,e,d=!Object.isArray(b),g=0,f=a.length;g<f;g++){c=a.options[g];e=this.optionValue(c);if(d){if(e==b){c.selected=true;break}}else c.selected=b.include(e)}},selectOne:function(a){var b=a.selectedIndex;return b>=0?this.optionValue(a.options[b]):null},selectMany:function(a){var b,c=a.length;if(!c)return null;var e=0;for(b=[];e<c;e++){var d=a.options[e];d.selected&&b.push(this.optionValue(d))}return b},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};
Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,c,e){$super(e,c);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});
Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});
Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(a,
"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this))}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});
(function(){function a(i){var o=document.documentElement,n=document.body||{scrollLeft:0};return i.pageX||i.clientX+(o.scrollLeft||n.scrollLeft)-(o.clientLeft||0)}function b(i){var o=document.documentElement,n=document.body||{scrollTop:0};return i.pageY||i.clientY+(o.scrollTop||n.scrollTop)-(o.clientTop||0)}function c(i,o,n){var q=Element.retrieve(i,"prototype_event_registry");if(Object.isUndefined(q)){B.push(i);q=Element.retrieve(i,"prototype_event_registry",$H())}var p=q.get(o);if(Object.isUndefined(p)){p=
[];q.set(o,p)}if(p.pluck("handler").include(n))return false;var s;if(o.include(":"))s=function(x){if(Object.isUndefined(x.eventName))return false;if(x.eventName!==o)return false;h.extend(x,i);n.call(i,x)};else if(!r&&(o==="mouseenter"||o==="mouseleave")){if(o==="mouseenter"||o==="mouseleave")s=function(x){h.extend(x,i);for(var u=x.relatedTarget;u&&u!==i;)try{u=u.parentNode}catch(C){u=i}u!==i&&n.call(i,x)}}else s=function(x){h.extend(x,i);n.call(i,x)};s.handler=n;p.push(s);return s}function e(){for(var i=
0,o=B.length;i<o;i++){h.stopObserving(B[i]);B[i]=null}}function d(i,o,n){i=$(i);n=c(i,o,n);if(!n)return i;if(o.include(":"))if(i.addEventListener)i.addEventListener("dataavailable",n,false);else{i.attachEvent("ondataavailable",n);i.attachEvent("onfilterchange",n)}else{o=A(o);i.addEventListener?i.addEventListener(o,n,false):i.attachEvent("on"+o,n)}return i}function g(i,o,n){i=$(i);var q=Element.retrieve(i,"prototype_event_registry");if(!q)return i;if(!o){q.each(function(u){g(i,u.key)});return i}var p=
q.get(o);if(!p)return i;if(!n){p.each(function(u){g(i,o,u.handler)});return i}var s=p.find(function(u){return u.handler===n});if(!s)return i;if(o.include(":"))if(i.removeEventListener)i.removeEventListener("dataavailable",s,false);else{i.detachEvent("ondataavailable",s);i.detachEvent("onfilterchange",s)}else{var x=A(o);i.removeEventListener?i.removeEventListener(x,s,false):i.detachEvent("on"+x,s)}q.set(o,p.without(s));return i}function f(i,o,n,q){i=$(i);if(Object.isUndefined(q))q=true;if(i==document&&
document.createEvent&&!i.dispatchEvent)i=document.documentElement;var p;if(document.createEvent){p=document.createEvent("HTMLEvents");p.initEvent("dataavailable",true,true)}else{p=document.createEventObject();p.eventType=q?"ondataavailable":"onfilterchange"}p.eventName=o;p.memo=n||{};document.createEvent?i.dispatchEvent(p):i.fireEvent(p.eventType,p);return h.extend(p)}function j(i,o,n,q){i=$(i);if(Object.isFunction(n)&&Object.isUndefined(q)){q=n;n=null}return(new h.Handler(i,o,n,q)).start()}var h=
{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},m=document.documentElement,r="onmouseenter"in m&&"onmouseleave"in m,w;if(Prototype.Browser.IE){var y={0:1,1:4,2:2};w=function(i,o){return i.button===y[o]}}else w=Prototype.Browser.WebKit?function(i,o){switch(o){case 0:return i.which==1&&!i.metaKey;case 1:return i.which==1&&i.metaKey;default:return false}}:function(i,
o){return i.which?i.which===o+1:i.button===o};h.Methods={isLeftClick:function(i){return w(i,0)},isMiddleClick:function(i){return w(i,1)},isRightClick:function(i){return w(i,2)},element:function(i){i=h.extend(i);var o=i.target,n=i.type;if((i=i.currentTarget)&&i.tagName)if(n==="load"||n==="error"||n==="click"&&i.tagName.toLowerCase()==="input"&&i.type==="radio")o=i;if(o.nodeType==Node.TEXT_NODE)o=o.parentNode;return Element.extend(o)},findElement:function(i,o){var n=h.element(i);if(!o)return n;for(;n;){if(Object.isElement(n)&&
Prototype.Selector.match(n,o))return Element.extend(n);n=n.parentNode}},pointer:function(i){return{x:a(i),y:b(i)}},pointerX:a,pointerY:b,stop:function(i){h.extend(i);i.preventDefault();i.stopPropagation();i.stopped=true}};var v=Object.keys(h.Methods).inject({},function(i,o){i[o]=h.Methods[o].methodize();return i});if(Prototype.Browser.IE){var z=function(i){switch(i.type){case "mouseover":i=i.fromElement;break;case "mouseout":i=i.toElement;break;default:return null}return Element.extend(i)};Object.extend(v,
{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});h.extend=function(i,o){if(!i)return false;if(i._extendedByPrototype)return i;i._extendedByPrototype=Prototype.emptyFunction;var n=h.pointer(i);Object.extend(i,{target:i.srcElement||o,relatedTarget:z(i),pageX:n.x,pageY:n.y});return Object.extend(i,v)}}else{h.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(h.prototype,
v);h.extend=Prototype.K}var B=[];Prototype.Browser.IE&&window.attachEvent("onunload",e);Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,false);var A=Prototype.K,l={mouseenter:"mouseover",mouseleave:"mouseout"};r||(A=function(i){return l[i]||i});h.Handler=Class.create({initialize:function(i,o,n,q){this.element=$(i);this.eventName=o;this.selector=n;this.callback=q;this.handler=this.handleEvent.bind(this)},start:function(){h.observe(this.element,this.eventName,this.handler);
return this},stop:function(){h.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(i){var o=i.findElement(this.selector);o&&this.callback.call(this.element,i,o)}});Object.extend(h,h.Methods);Object.extend(h,{fire:f,observe:d,stopObserving:g,on:j});Element.addMethods({fire:f,observe:d,stopObserving:g,on:j});Object.extend(document,{fire:f.methodize(),observe:d.methodize(),stopObserving:g.methodize(),on:j.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,
h);else window.Event=h})();
(function(){function a(){if(!document.loaded){e&&window.clearTimeout(e);document.loaded=true;document.fire("dom:loaded")}}function b(){if(document.readyState==="complete"){document.stopObserving("readystatechange",b);a()}}function c(){try{document.documentElement.doScroll("left")}catch(d){e=c.defer();return}a()}var e;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,false);else{document.observe("readystatechange",b);if(window==top)e=c.defer()}Event.observe(window,"load",
a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;
var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}},$continue=Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||
document.body.scrollTop||0},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=Element.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var e=Element.cumulativeScrollOffset(a);this.xcomp=b+e[0]-this.deltaX;this.ycomp=c+e[1]-this.deltaY;this.offset=Element.cumulativeOffset(a);return this.ycomp>=
this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},relativize:function(a){Position.prepare();
return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(a,b,c){c=c||{};return Element.clonePosition(b,a,c)}};
if(!document.getElementsByClassName)document.getElementsByClassName=function(a){function b(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}a.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,e){e=e.toString().strip();var d=/\s/.test(e)?$w(e).map(b).join(""):b(e);return d?document._getElementsByXPath(".//*"+d,c):[]}:function(c,e){e=e.toString().strip();var d=[],g=/\s/.test(e)?$w(e):null;if(!g&&!e)return d;var f=$(c).getElementsByTagName("*");e=" "+e+" ";for(var j=
0,h,m;h=f[j];j++)if(h.className&&(m=" "+h.className+" ")&&(m.include(e)||g&&g.all(function(r){return!r.toString().blank()&&m.include(" "+r+" ")})))d.push(Element.extend(h));return d};return function(c,e){return $(e||document.body).getElementsByClassName(c)}}(Element.Methods);Element.ClassNames=Class.create();
Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){this.include(a)&&this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);
(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(a,b){for(var c=Prototype.Selector.match,e=[],d=0,g=a.length;d<g;d++){var f=a[d];c(f,b)&&e.push(Element.extend(f))}return e},
findElement:function(a,b,c){c=c||0;for(var e=0,d,g=0,f=a.length;g<f;g++){d=a[g];if(Prototype.Selector.match(d,b)&&c===e++)return Element.extend(d)}},findChildElements:function(a,b){var c=b.toArray().join(", ");return Prototype.Selector.select(c,a||document)}})})();
(function(){function a(d){var g=document.createElement("div");d="on"+d;var f=d in g;if(!f){g.setAttribute(d,"return;");f=typeof g[d]=="function"}return f}function b(d){var g,f,j;if(d.fire("ajax:before").stopped)return false;if(d.tagName.toLowerCase()==="form"){g=d.readAttribute("method")||"post";f=d.readAttribute("action");j=d.serialize()}else{g=d.readAttribute("data-method")||"get";f=d.readAttribute("href");j={}}new Ajax.Request(f,{method:g,parameters:j,evalScripts:true,onComplete:function(h){d.fire("ajax:complete",
h)},onSuccess:function(h){d.fire("ajax:success",h)},onFailure:function(h){d.fire("ajax:failure",h)}});d.fire("ajax:after")}var c=a("submit"),e=a("change");if(!c||!e)Event.Handler.prototype.initialize=Event.Handler.prototype.initialize.wrap(function(d,g,f,j,h){d(g,f,j,h);if(!(d=!c&&this.eventName=="submit"&&!(Object.isElement(this.element)&&this.element.nodeName.toUpperCase()=="FORM"))){if(d=!e){if(d=this.eventName=="change"){d=this.element;if(Object.isElement(d)){d=d.nodeName.toUpperCase();d=d=="INPUT"||
d=="SELECT"||d=="TEXTAREA"}else d=false;d=!d}d=d}d=d}if(d)this.eventName="emulated:"+this.eventName});c||document.on("focusin","form",function(d,g){if(!g.retrieve("emulated:submit")){g.on("submit",function(f){g.fire("emulated:submit",f,true).returnValue===false&&f.preventDefault()});g.store("emulated:submit",true)}});e||document.on("focusin","input, select, texarea",function(d,g){if(!g.retrieve("emulated:change")){g.on("change",function(f){g.fire("emulated:change",f,true)});g.store("emulated:change",
true)}});document.on("click","*[data-confirm]",function(d,g){var f=g.readAttribute("data-confirm");confirm(f)||d.stop()});document.on("click","a[data-remote]",function(d,g){if(!d.stopped){b(g);d.stop()}});document.on("click","a[data-method]",function(d,g){if(!d.stopped){var f=g.readAttribute("data-method"),j=g.readAttribute("href"),h=$$("meta[name=csrf-param]")[0],m=$$("meta[name=csrf-token]")[0];j=new Element("form",{method:"POST",action:j,style:"display: none;"});g.parentNode.insert(j);if(f!=="post"){f=
new Element("input",{type:"hidden",name:"_method",value:f});j.insert(f)}if(h){h=h.readAttribute("content");m=m.readAttribute("content");f=new Element("input",{type:"hidden",name:h,value:m});j.insert(f)}j.submit();d.stop()}});document.on("submit",function(d){var g=d.findElement(),f=g.readAttribute("data-confirm");if(f&&!confirm(f)){d.stop();return false}g.select("input[type=submit][data-disable-with]").each(function(j){j.disabled=true;j.writeAttribute("data-original-value",j.value);j.value=j.readAttribute("data-disable-with")});
if(g=d.findElement("form[data-remote]")){b(g);d.stop()}});document.on("ajax:after","form",function(d,g){g.select("input[type=submit][disabled=true][data-disable-with]").each(function(f){f.value=f.readAttribute("data-original-value");f.removeAttribute("data-original-value");f.disabled=false})})})();var S2={Version:"2.0.0_a6",Extensions:{}};
Function.prototype.optionize=function(){var a=this,b=a.argumentNames(),c=this.length-1,e=function(){var d=$A(arguments),g=typeof d.last()==="object"?d.pop():{},f=[];if(c>0)f=(d.length>0?d:[null]).inGroupsOf(c).flatten().concat(g);return a.apply(this,f)};e.argumentNames=function(){return b};return e};Function.ABSTRACT=function(){throw"Abstract method. Implement in subclass.";};
Object.extend(Number.prototype,{constrain:function(a,b){var c=a<b?a:b,e=a<b?b:a,d=Number(this);if(d<c)d=c;if(d>e)d=e;return d},nearer:function(a,b){var c=Number(this);return Math.abs(c-a)<Math.abs(c-b)?a:b},tween:function(a,b){return this+(a-this)*b}});Object.propertize=function(a,b){return Object.isString(a)?b[a]:a};
S2.CSS={PROPERTY_MAP:{backgroundColor:"color",borderBottomColor:"color",borderBottomWidth:"length",borderLeftColor:"color",borderLeftWidth:"length",borderRightColor:"color",borderRightWidth:"length",borderSpacing:"length",borderTopColor:"color",borderTopWidth:"length",bottom:"length",color:"color",fontSize:"length",fontWeight:"integer",height:"length",left:"length",letterSpacing:"length",lineHeight:"length",marginBottom:"length",marginLeft:"length",marginRight:"length",marginTop:"length",maxHeight:"length",
maxWidth:"length",minHeight:"length",minWidth:"length",opacity:"number",outlineColor:"color",outlineOffset:"length",outlineWidth:"length",paddingBottom:"length",paddingLeft:"length",paddingRight:"length",paddingTop:"length",right:"length",textIndent:"length",top:"length",width:"length",wordSpacing:"length",zIndex:"integer",zoom:"number"},LENGTH:/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,NUMBER:/([\+-]*\d+\.?\d*)/,__parseStyleElement:document.createElement("div"),parseStyle:function(a){S2.CSS.__parseStyleElement.innerHTML=
'<div style="'+a+'"></div>';var b=S2.CSS.__parseStyleElement.childNodes[0].style,c={};S2.CSS.NUMERIC_PROPERTIES.each(function(e){if(b[e])c[e]=b[e]});S2.CSS.COLOR_PROPERTIES.each(function(e){if(b[e])c[e]=S2.CSS.colorFromString(b[e])});if(Prototype.Browser.IE&&a.include("opacity"))c.opacity=a.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1];return c},normalizeColor:function(a){if(!a||a=="rgba(0, 0, 0, 0)"||a=="transparent")a="#ffffff";a=S2.CSS.colorFromString(a);return[parseInt(a.slice(1,3),16),parseInt(a.slice(3,
5),16),parseInt(a.slice(5,7),16)]},colorFromString:function(a,b){var c="#",e,d;if(a.slice(0,4)=="rgb("){e=a.slice(4,a.length-1).split(",");for(d=3;d--;)c+=parseInt(e[2-d]).toColorPart()}else if(a.slice(0,1)=="#"){if(a.length==4)for(d=1;d<4;d++)c+=(a.charAt(d)+a.charAt(d)).toLowerCase();if(a.length==7)c=a.toLowerCase()}else c=a;return c.length==7?c:b||c},interpolateColor:function(a,b,c){a=S2.CSS.normalizeColor(a);b=S2.CSS.normalizeColor(b);return"#"+[0,1,2].map(function(e){return Math.max(Math.min(a[e].tween(b[e],
c).round(),255),0).toColorPart()}).join("")},interpolateNumber:function(a,b,c){return 1*(a||0).tween(b,c).toFixed(3)},interpolateLength:function(a,b,c){if(!a||parseFloat(a)===0)a="0"+b.gsub(S2.CSS.NUMBER,"");b.scan(S2.CSS.NUMBER,function(e){b=1*e[1]});return a.gsub(S2.CSS.NUMBER,function(e){return(1*parseFloat(e[1]).tween(b,c).toFixed(3)).toString()})},interpolateInteger:function(a,b,c){return parseInt(a).tween(b,c).round()},interpolate:function(a,b,c,e){return S2.CSS["interpolate"+S2.CSS.PROPERTY_MAP[a.camelize()].capitalize()](b,
c,e)},ElementMethods:{getStyles:function(a){var b=document.defaultView.getComputedStyle($(a),null);return S2.CSS.PROPERTIES.inject({},function(c,e){c[e]=b[e];return c})}}};S2.CSS.PROPERTIES=[];for(property in S2.CSS.PROPERTY_MAP)S2.CSS.PROPERTIES.push(property);S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return!a.endsWith("olor")});S2.CSS.COLOR_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return a.endsWith("olor")});
if(!(document.defaultView&&document.defaultView.getComputedStyle))S2.CSS.ElementMethods.getStyles=function(a){a=$(a);var b=a.currentStyle,c;c=S2.CSS.PROPERTIES.inject({},function(e,d){e[d]=b[d];return e});if(!c.opacity)c.opacity=a.getOpacity();return c};Element.addMethods(S2.CSS.ElementMethods);
S2.FX=function(){function a(f){d[(g+=f)>0?"start":"stop"]()}function b(){c.invoke("render",d.getTimestamp())}var c=[],e,d,g=0;return{initialize:function(f){if(!e){c.push(e=new S2.FX.Queue);S2.FX.DefaultOptions.queue=e;d=f||new S2.FX.Heartbeat;document.observe("effect:heartbeat",b).observe("effect:queued",a.curry(1)).observe("effect:dequeued",a.curry(-1))}},getQueues:function(){return c},addQueue:function(f){c.push(f)},getHeartbeat:function(){return d},setHeartbeat:function(f){d=f}}}();
Object.extend(S2.FX,{DefaultOptions:{transition:"sinusoidal",position:"parallel",fps:60,duration:0.2},elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},parseOptions:function(a){if(Object.isNumber(a))a={duration:a};else if(Object.isFunction(a))a={after:a};else if(Object.isString(a))a={duration:a=="slow"?1:a=="fast"?0.1:0.2};return a||{}}});
S2.FX.Base=Class.create({initialize:function(a){S2.FX.initialize();this.updateWithoutWrappers=this.update;a&&a.queue&&!S2.FX.getQueues().include(a.queue)&&S2.FX.addQueue(a.queue);this.setOptions(a);this.duration=this.options.duration*1E3;this.state="idle";["after","before"].each(function(b){this[b]=function(c){c(this);return this}},this)},setOptions:function(a){a=S2.FX.parseOptions(a);if(!this.options){this.options=Object.extend(Object.extend({},S2.FX.DefaultOptions),a);if(a.tween)this.options.transition=
a.tween}if(this.options.beforeUpdate||this.options.afterUpdate)this.update=this.updateWithoutWrappers.wrap(function(b,c){this.options.beforeUpdate&&this.options.beforeUpdate(this,c);b(c);this.options.afterUpdate&&this.options.afterUpdate(this,c)}.bind(this));if(this.options.transition===false)this.options.transition=S2.FX.Transitions.linear;this.options.transition=Object.propertize(this.options.transition,S2.FX.Transitions)},play:function(a){this.setOptions(a);this.frameCount=0;this.options.queue.add(this);
this.maxFrames=this.options.fps*this.duration/1E3;return this},render:function(a){if(a>=this.startsAt){if(this.state=="idle"){this.options.before&&this.options.before(this);this.setup&&this.setup();this.state="running";this.update(this.options.transition(0));this.frameCount++;return this}if(a>=this.endsAt&&this.state!="finished"){this.update(this.options.transition(1));this.teardown&&this.teardown();this.options.after&&this.options.after(this);this.state="finished"}else if(this.state=="running"){a=
1-(this.endsAt-a)/this.duration;if((this.maxFrames*a).floor()>this.frameCount){this.update(this.options.transition(a));this.frameCount++}}}return this},cancel:function(a){if(!this.state!="running"){this.teardown&&this.teardown();a&&this.options.after&&this.options.after(this);this.state="finished"}},finish:function(){if(!this.state!="running"){this.update(this.options.transition(1));this.cancel(true)}},inspect:function(){return"#<S2.FX:"+[this.state,this.startsAt,this.endsAt].inspect()+">"},update:Prototype.emptyFunction});
S2.FX.Element=Class.create(S2.FX.Base,{initialize:function($super,b,c){if(!(this.element=$(b)))throw S2.FX.elementDoesNotExistError;this.operators=[];return $super(c)},animate:function(){var a=$A(arguments),b=a.shift();b=b.charAt(0).toUpperCase()+b.substring(1);this.operators.push(new S2.FX.Operators[b](this,a[0],a[1]||{}))},play:function($super,b,c){if(b)this.element=$(b);return $super(c)},update:function(a){this.operators.invoke("render",a)}});
S2.FX.Heartbeat=Class.create({initialize:function(a){this.options=Object.extend({framerate:Prototype.Browser.MobileSafari?20:60},a);this.beat=this.beat.bind(this)},start:function(){if(!this.heartbeatInterval){this.heartbeatInterval=setInterval(this.beat,1E3/this.options.framerate);this.updateTimestamp()}},stop:function(){if(this.heartbeatInterval){clearInterval(this.heartbeatInterval);this.timestamp=this.heartbeatInterval=null}},beat:function(){this.updateTimestamp();document.fire("effect:heartbeat")},
getTimestamp:function(){return this.timestamp||this.generateTimestamp()},generateTimestamp:function(){return(new Date).getTime()},updateTimestamp:function(){this.timestamp=this.generateTimestamp()}});
S2.FX.Queue=function(){return function(){function a(c){b=b.without(c);delete c;document.fire("effect:dequeued",this);return this}var b=[];Object.extend(this,{getEffects:function(){return b},active:function(){return b.length>0},add:function(c){var e=c.options.position||"parallel",d=S2.FX.getHeartbeat().getTimestamp();if(e=="end")d=b.without(c).pluck("endsAt").max()||d;c.startsAt=d+(c.options.delay||0)*1E3;c.endsAt=c.startsAt+(c.options.duration||1)*1E3;b.push(c);document.fire("effect:queued",this);
return this},remove:a,render:function(c){b.invoke("render",c);b.select(function(e){return e.state=="finished"}).each(a);return this}})}}();S2.FX.Attribute=Class.create(S2.FX.Base,{initialize:function($super,b,c,e,d,g){b=Object.isString(b)?$(b):b;this.method=Object.isFunction(g)?g.bind(b):Object.isFunction(b[g])?b[g].bind(b):function(f){b[g]=f};this.to=e;this.from=c;return $super(d)},update:function(a){this.method(this.from.tween(this.to,a))}});
S2.FX.Style=Class.create(S2.FX.Element,{setup:function(){this.animate("style",this.element,{style:this.options.style})}});S2.FX.Operators={};
S2.FX.Operators.Base=Class.create({initialize:function(a,b,c){this.effect=a;this.object=b;this.options=Object.extend({transition:Prototype.K},c)},inspect:function(){return"#<S2.FX.Operators.Base:"+this.lastValue+">"},setup:function(){},valueAt:function(){},applyValue:function(){},render:function(a){a=this.valueAt(this.options.transition(a));this.applyValue(a);this.lastValue=a}});
S2.FX.Operators.Style=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,e){$super(b,c,e);this.element=$(this.object);this.style=Object.isString(this.options.style)?S2.CSS.parseStyle(this.options.style):this.options.style;this.tweens=[];for(var d in this.style){b=d.underscore().dasherize();c=this.element.getStyle(b);e=this.style[d];if(c!=e)this.tweens.push([b,S2.CSS.interpolate.curry(b,c,e),d in this.options.propertyTransitions?Object.propertize(this.options.propertyTransitions[d],
S2.FX.Transitions):Prototype.K])}},valueAt:function(a){return this.tweens.map(function(b){return b[0]+":"+b[1](b[2](a))}).join(";")},applyValue:function(a){if(this.currentStyle!=a){this.element.setStyle(a);this.currentStyle=a}}});
S2.FX.Morph=Class.create(S2.FX.Element,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style)this.animate("style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||{}})},teardown:function(){this.options.change&&this.teardownWrappers()},setupWrappers:function(){var a=this.element.getStyle("float"),b,c,e,d;this.transitionElement=(new Element("div")).setStyle({position:"relative",overflow:"hidden",
"float":a});this.element.setStyle({"float":"none"}).insert({before:this.transitionElement});this.sourceElementWrapper=this.element.cloneWithoutIDs().wrap("div");this.destinationElementWrapper=this.element.wrap("div");this.transitionElement.insert(this.sourceElementWrapper).insert(this.destinationElementWrapper);a=this.sourceElementWrapper.getHeight();b=this.sourceElementWrapper.getWidth();this.options.change();c=this.destinationElementWrapper.getHeight();e=this.destinationElementWrapper.getWidth();
this.outerWrapper=new Element("div");this.transitionElement.insert({before:this.outerWrapper});this.outerWrapper.setStyle({overflow:"hidden",height:a+"px",width:b+"px"}).appendChild(this.transitionElement);d=Math.max(c,a);maxWidth=Math.max(e,b);this.transitionElement.setStyle({height:a+"px",width:b+"px"});this.sourceElementWrapper.setStyle({position:"absolute",height:d+"px",width:maxWidth+"px",top:0,left:0});this.destinationElementWrapper.setStyle({position:"absolute",height:d+"px",width:maxWidth+
"px",top:0,left:0,opacity:0,zIndex:2E3});this.outerWrapper.insert({before:this.transitionElement}).remove();this.animate("style",this.transitionElement,{style:"height:"+c+"px; width:"+e+"px"});this.animate("style",this.destinationElementWrapper,{style:"opacity: 1.0"})},teardownWrappers:function(){var a=this.destinationElementWrapper.down();a&&this.transitionElement.insert({before:a});this.transitionElement.remove()}});
S2.FX.Parallel=Class.create(S2.FX.Base,{initialize:function($super,b,c){this.effects=b||[];return $super(c||{})},setup:function(){this.effects.invoke("setup")},update:function(a){this.effects.invoke("update",a)}});S2.FX.Operators.Scroll=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,e){$super(b,c,e);this.start=c.scrollTop;this.end=this.options.scrollTo},valueAt:function(a){return this.start+(this.end-this.start)*a},applyValue:function(a){this.object.scrollTop=a.round()}});
S2.FX.Scroll=Class.create(S2.FX.Element,{setup:function(){this.animate("scroll",this.element,{scrollTo:this.options.to})}});
S2.FX.SlideDown=Class.create(S2.FX.Element,{setup:function(){var a=this.destinationElement||this.element,b=a.getLayout();b={height:b.get("height")+"px",paddingTop:b.get("padding-top")+"px",paddingBottom:b.get("padding-bottom")+"px"};a.setStyle({height:"0",paddingTop:"0",paddingBottom:"0",overflow:"hidden"}).show();this.animate("style",a,{style:b,propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"})}});
S2.FX.SlideUp=Class.create(S2.FX.Morph,{setup:function(){var a=this.destinationElement||this.element;a.getLayout();a.setStyle({overflow:"hidden"});this.animate("style",a,{style:{height:"0px",paddingTop:"0px",paddingBottom:"0px"},propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"}).hide()}});
S2.FX.Transitions={linear:Prototype.K,sinusoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5},reverse:function(a){return 1-a},mirror:function(a,b){b=b||S2.FX.Transitions.sinusoidal;return a<0.5?b(a*2):b(1-(a-0.5)*2)},flicker:function(a){a+=(Math.random()-0.5)/5;return S2.FX.Transitions.sinusoidal(a<0?0:a>1?1:a)},wobble:function(a){return-Math.cos(a*Math.PI*9*a)/2+0.5},pulse:function(a,b){return-Math.cos(a*((b||5)-0.5)*2*Math.PI)/2+0.5},blink:function(a,b){return Math.round(a*(b||5))%2},spring:function(a){return 1-
Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},none:Prototype.K.curry(0),full:Prototype.K.curry(1)};
(function(){function a(b,c,e,d,g,f){function j(z,B){var A,l,i,o;i=z;for(l=0;l<8;l++){o=((h*i+m)*i+r)*i-z;if((o>=0?o:0-o)<B)return i;A=(3*h*i+2*m)*i+r;if((A>=0?A:0-A)<1.0E-6)break;i-=o/A}A=0;l=1;i=z;if(i<A)return A;if(i>l)return l;for(;A<l;){o=((h*i+m)*i+r)*i;if((o-z>=0?o-z:0-(o-z))<B)break;if(z>o)A=i;else l=i;i=(l-A)*0.5+A}return i}var h=0,m=0,r=0,w=0,y=0,v=0;r=3*c;m=3*(d-c)-r;h=1-r-m;v=3*e;y=3*(g-e)-v;w=1-v-y;return function(z,B){var A=j(z,B);return((w*A+y)*A+v)*A}(b,1/(200*f))}S2.FX.cubicBezierTransition=
function(b,c,e,d){return function(g){return a(g,b,c,e,d,1)}}})();S2.FX.Transitions.webkitCubic=S2.FX.cubicBezierTransition(0.25,0.1,0.25,1);S2.FX.Transitions.webkitEaseInOut=S2.FX.cubicBezierTransition(0.42,0,0.58,1);
Object.extend(S2.FX.Transitions,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,3);return 0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,5);return 0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==
0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a==0)return 0;if(a==1)return 1;if((a/=0.5)<1)return 0.5*Math.pow(2,10*(a-1));return 0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=0.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return 0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*
a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;if((a/=0.5)<1)return 0.5*a*a*(((b*=1.525)+1)*a-b);return 0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<
1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*
a+0.984375)},easeFromTo:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}});Prototype.BrowserFeatures.WebkitCSSTransitions=false;S2.Extensions.webkitCSSTransitions=false;
(function(){try{document.createEvent("WebKitTransitionEvent")}catch(a){return}Prototype.BrowserFeatures.WebkitCSSTransitions=true;S2.Extensions.webkitCSSTransitions=true;if(Prototype.BrowserFeatures.WebkitCSSTransitions){$w("webkitBorderTopLeftRadius webkitBorderTopRightRadius webkitBorderBottomLeftRadius webkitBorderBottomRightRadius webkitBackgroundSize").each(function(b){S2.CSS.PROPERTIES.push(b)});S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(b){return!b.endsWith("olor")});S2.FX.Operators.WebkitCssTransition=
Class.create(S2.FX.Operators.Base,{initialize:function($super,c,e,d){$super(c,e,d);this.element=$(this.object);if(Object.isString(this.options.style))if(this.options.style.include(":"))this.style=$H(S2.CSS.parseStyle(this.options.style));else{this.element.addClassName(d.style);this.style=$H(this.element.getStyles());this.element.removeClassName(d.style);var g=this.element.getStyles();this.style=this.style.reject(function(f){return f.value==g[f.key]})}else this.style=$H(this.options.style);this.properties=
[];this.targetStyle="";this.style.each(function(f){var j=f[0].underscore().dasherize();f=f[1];this.element.getStyle(j);if(j.startsWith("webkit"))j="-"+j;this.properties.push(j);this.targetStyle+=";"+j+":"+f},this)},render:function(){this.element.style.webkitTransitionProperty=this.properties.join(",");this.element.style.webkitTransitionDuration=(this.effect.duration/1E3).toFixed(3)+"s";for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===this.effect.options.transition)this.element.style.webkitTransitionTimingFunction=
S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];this.element.setStyle(this.targetStyle);this.render=Prototype.emptyFunction}});S2.FX.Operators.WebkitCssTransition.TIMING_MAP={linear:"linear",sinusoidal:"ease-in-out"};timingFunctionForTransition=function(b){var c=null;for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===b)c=S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];return c};isWebkitCSSTransitionCompatible=function(b){return S2.Extensions.webkitCSSTransitions&&
(b.options.engine||"")!="javascript"&&timingFunctionForTransition(b.options.transition)&&!b.options.propertyTransitions};S2.FX.Morph=Class.create(S2.FX.Morph,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style){this.engine=isWebkitCSSTransitionCompatible(this)?"webkit":"javascript";this.animate(this.engine=="webkit"?"webkitCssTransition":"style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||
{}})}},render:function($super,c){if(this.engine=="webkit"){if(this.options.before)this.element.beforeStartEffect=this.options.before;if(this.options.after){this.element.afterFinishEffect=this.options.after;delete this.options.after}this.element._effect=this}return $super(c)}});Element.addMethods({morph:function(b,c,e){if(Object.isNumber(e))e={duration:e};return b.effect("morph",Object.extend(e,{style:c}))}.optionize()});S2.FX.webkitTransitionStartEvent=document.observe("webkitTransitionStart",function(b){if((b=
b.element())&&b.beforeStartEffect){b.beforeStartEffect();b.beforeStartEffect=null}});S2.FX.webkitTransitionEndEvent=document.observe("webkitTransitionEnd",function(b){var c=b.element();if(c){(function(){c.style.webkitTransitionDuration=""}).defer();if(c.afterFinishEffect){c.afterFinishEffect();c.afterFinishEffect=null}}})}})();
(function(){function a(d,g){if(Object.isElement(d)){element=d;d=element.getStyle(g)}if(d===null)return null;if(/^\d+(px)?$/i.test(d))return window.parseInt(d,10);if(/\d/.test(d)&&element.runtimeStyle){var f=element.style.left,j=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=d||0;d=element.style.pixelLeft;element.style.left=f;element.runtimeStyle.left=j;return d}if(d.include("%")){j=(j=d.match(/^(\d+)%?$/i))?Number(j[1])/100:null;if(g.include("left")||
g.include("right")||g.include("width"))f=$(element.parentNode).measure("width");else if(g.include("top")||g.include("bottom")||g.include("height"))f=$(element.parentNode).measure("height");return f*j}return 0}function b(d){var g=d.getLayout(),f=0,j=0;do{f+=d.offsetTop||0;j+=d.offsetLeft||0;if(d=d.offsetParent){if($w("BODY HTML").include(d.nodeName.toUpperCase()))break;if(Element.getStyle(d,"position")!=="static")break}}while(d);j-=g.get("margin-top");f-=g.get("margin-left");return new Element.Offset(j,
f)}function c(d){var g=0,f=0,j=d;do{g+=j.offsetTop||0;f+=j.offsetLeft||0;if(j.offsetParent==document.body&&Element.getStyle(j,"position")=="absolute")break}while(j=j.offsetParent);j=d;d=j.tagName;var h=Prototype.Browser.Opera;do if(!h||d&&d.toUpperCase()==="BODY"){g-=j.scrollTop||0;f-=j.scrollLeft||0}while(j=j.parentNode);return new Element.Offset(f,g)}var e=Prototype.K;if("currentStyle"in document.documentElement)e=function(d){if(!d.currentStyle.hasLayout)d.style.zoom=1;return d};Element.Layout=
Class.create(Hash,{initialize:function($super,g,f){$super();this.element=$(g);if(f){this._preComputing=true;this._begin()}Element.Layout.PROPERTIES.each(function(j){f?this._compute(j):this._set(j,null)},this);if(f){this._end();this._preComputing=false}},_set:function(d,g){return Hash.prototype.set.call(this,d,g)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,g){var f=$super(g);return f===null?this._compute(g):f},_begin:function(){if(!this._prepared){var d=
this.element,g;a:{for(g=d;g&&g.parentNode;){if(g.getStyle("display")==="none"){g=false;break a}g=$(g.parentNode)}g=true}if(!g){d.store("prototype_original_styles",{position:d.style.position||"",width:d.style.width||"",visibility:d.style.visibility||"",display:d.style.display||""});g=d.getStyle("position");var f=d.getStyle("width");d.setStyle({position:"absolute",visibility:"hidden",display:"block"});var j=d.getStyle("width");g=f&&j===f?window.parseInt(f,10):f&&(g==="absolute"||g==="fixed")?window.parseInt(f,
10):$(d.parentNode).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");d.setStyle({width:g+"px"})}this._prepared=true}},_end:function(){var d=this.element,g=d.retrieve("prototype_original_styles");d.store("prototype_original_styles",null);d.setStyle(g);this._prepared=false},_compute:function(d){var g=Element.Layout.COMPUTATIONS;if(!(d in g))throw"Property not found.";g=g[d].call(this,
this.element);this._set(d,g);return g}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),
COMPUTATIONS:{height:function(){this._preComputing||this._begin();var d=this.get("border-box-height");if(d<=0)return 0;var g=this.get("border-top"),f=this.get("border-bottom"),j=this.get("padding-top"),h=this.get("padding-bottom");this._preComputing||this._end();return d-g-f-j-h},width:function(){this._preComputing||this._begin();var d=this.get("border-box-width");if(d<=0)return 0;var g=this.get("border-left"),f=this.get("border-right"),j=this.get("padding-left"),h=this.get("padding-right");this._preComputing||
this._end();return d-g-f-j-h},"padding-box-height":function(){var d=this.get("height"),g=this.get("padding-top"),f=this.get("padding-bottom");return d+g+f},"padding-box-width":function(){var d=this.get("width"),g=this.get("padding-left"),f=this.get("padding-right");return d+g+f},"border-box-height":function(d){return d.offsetHeight},"border-box-width":function(d){return d.offsetWidth},"margin-box-height":function(){var d=this.get("border-box-height"),g=this.get("margin-top"),f=this.get("margin-bottom");
if(d<=0)return 0;return d+g+f},"margin-box-width":function(){var d=this.get("border-box-width"),g=this.get("margin-left"),f=this.get("margin-right");if(d<=0)return 0;return d+g+f},top:function(d){return d.positionedOffset().top},bottom:function(d){var g=d.positionedOffset();d=d.getOffsetParent().measure("height");var f=this.get("border-box-height");return d-f-g.top},left:function(d){return d.positionedOffset().left},right:function(d){var g=d.positionedOffset();d=d.getOffsetParent().measure("width");
var f=this.get("border-box-width");return d-f-g.left},"padding-top":function(d){return a(d,"paddingTop")},"padding-bottom":function(d){return a(d,"paddingBottom")},"padding-left":function(d){return a(d,"paddingLeft")},"padding-right":function(d){return a(d,"paddingRight")},"border-top":function(d){return Object.isNumber(d.clientTop)?d.clientTop:a(d,"borderTopWidth")},"border-bottom":function(d){return Object.isNumber(d.clientBottom)?d.clientBottom:a(d,"borderBottomWidth")},"border-left":function(d){return Object.isNumber(d.clientLeft)?
d.clientLeft:a(d,"borderLeftWidth")},"border-right":function(d){return Object.isNumber(d.clientRight)?d.clientRight:a(d,"borderRightWidth")},"margin-top":function(d){return a(d,"marginTop")},"margin-bottom":function(d){return a(d,"marginBottom")},"margin-left":function(d){return a(d,"marginLeft")},"margin-right":function(d){return a(d,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(d){var g=e(d.getOffsetParent());d=d.getBoundingClientRect();
return(g.getBoundingClientRect().right-d.right).round()},bottom:function(d){var g=e(d.getOffsetParent());d=d.getBoundingClientRect();return(g.getBoundingClientRect().bottom-d.bottom).round()}});Element.Offset=Class.create({initialize:function(d,g){this.left=d.round();this.top=g.round();this[0]=this.left;this[1]=this.top},relativeTo:function(d){return new Element.Offset(this.left-d.left,this.top-d.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},
toArray:function(){return[this.left,this.top]}});Element.addMethods({getLayout:function(d){return new Element.Layout(d)},measure:function(d,g){return $(d).getLayout().get(g)},cumulativeOffset:function(d){var g=0,f=0;do{g+=d.offsetTop||0;f+=d.offsetLeft||0;d=d.offsetParent}while(d);return new Element.Offset(f,g)},positionedOffset:b,cumulativeScrollOffset:function(d){var g=0,f=0;do{g+=d.scrollTop||0;f+=d.scrollLeft||0;d=d.parentNode}while(d);return new Element.Offset(f,g)},viewportOffset:c});"getBoundingClientRect"in
document.documentElement&&Element.addMethods({viewportOffset:function(d){d=$(d);d=d.getBoundingClientRect();return new Element.Offset(d.left,d.top)},cumulativeOffset:function(d){d=$(d);var g=$(document.documentElement).viewportOffset();return d.viewportOffset().relativeTo(g)},positionedOffset:function(d){d=$(d);var g=d.getOffsetParent();if(g.nodeName.toUpperCase()==="HTML")return b(d);var f=d.viewportOffset();g=$w("BODY HTML").include(g.nodeName.toUpperCase())?c(g):g.viewportOffset();f=f.relativeTo(g);
g=d.getLayout();d=f.top-g.get("margin-top");f=f.left-g.get("margin-left");return new Element.Offset(f,d)}})})();S2.UI={};Object.deepExtend=function(a,b){for(var c in b)if(b[c]&&b[c].constructor&&b[c].constructor===Object){a[c]=a[c]||{};arguments.callee(a[c],b[c])}else a[c]=b[c];return a};S2.UI.Mixin={};
S2.UI.Mixin.Configurable={setOptions:function(a){if(!this.options){this.options={};var b=this.constructor;if(b.superclass){for(var c=[],e=b;e=e.superclass;)c.push(e);c=c.reverse();e=0;for(var d=c.length;e<d;e++)Object.deepExtend(this.options,c[e].DEFAULT_OPTIONS||{})}Object.deepExtend(this.options,b.DEFAULT_OPTIONS||{})}return Object.deepExtend(this.options,a||{})}};
S2.UI.Mixin.Trackable={register:function(){var a=this.constructor;if(!a.instances)a.instances=[];a.instances.include(this)||a.instances.push(this);Object.isFunction(a.onRegister)&&a.onRegister.call(a,this)},unregister:function(){var a=this.constructor;a.instances=a.instances.without(this);Object.isFunction(a.onRegister)&&a.onUnregister.call(a,this)}};
S2.UI.Mixin.Shim={__SHIM_TEMPLATE:new Template("<iframe frameborder='0' tabindex='-1' src='javascript:false;' style='display:block;position:absolute;z-index:-1;overflow:hidden; filter:Alpha(Opacity=\"0\");top:expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px');left:expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px');width:expression(this.parentNode.offsetWidth+'px');height:expression(this.parentNode.offsetHeight+'px');' id='#{0}'></iframe>"),createShim:function(a){if(this.__shim_isie6=
Prototype.Browser.IE&&/6.0/.test(navigator.userAgent))if(a=$(a||this.element)){this.__shimmed=a;var b=a.identify()+"_iframeshim",c=$(b);c&&c.remove();a.insert({top:this.__SHIM_TEMPLATE.evaluate([b])});this.__shim_id=b}},adjustShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id),b=this.__shimmed;a&&a.setStyle({width:b.offsetWidth+"px",height:b.offsetHeight+"px"})}},destroyShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id);
a&&a.remove();this.__shimmed=null}}};
Object.extend(S2.UI,{addClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,e,d=0,g;g=a[d];d++)for(c=0;e=b[c];c++)g.addClassName(e);return a},removeClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,e,d=0,g;g=a[d];d++)for(c=0;e=b[c];c++)g.removeClassName(e)},FOCUSABLE_ELEMENTS:$w("input select textarea button object"),isFocusable:function(a){var b=a.nodeName.toLowerCase(),c=a.readAttribute("tabIndex"),
e=false;e=S2.UI.FOCUSABLE_ELEMENTS.include(b)?!a.disabled:$w("a area").include(b)?a.href||c&&!isNaN(c):c&&!isNaN(c);return!!e&&S2.UI.isVisible(a)},findFocusables:function(a){return $(a).descendants().select(S2.UI.isFocusable)},isVisible:function(a){for(a=$(a);a&&a.parentNode;){var b=a.getStyle("display"),c=a.getStyle("visibility");if(b==="none"||c==="hidden")return false;a=$(a.parentNode)}return true},makeVisible:function(a,b){if(Object.isElement(a))a=[a];for(var c=b?"visible":"hidden",e=0,d;d=a[e];e++)d.setStyle({visibility:c});
return a},modifierUsed:function(a){return a.metaKey||a.ctrlKey||a.altKey}});
(function(){function a(c){var e=Event.element(c);if(e)for(var d=0,g;g=b[d];d++)if(e===g||e.descendantOf(g)){Event.stop(c);break}}var b=[];if(document.attachEvent)document.onselectstart=a.bindAsEventListener(window);else document.observe("mousedown",a);Object.extend(S2.UI,{enableTextSelection:function(c){c.setStyle({"-moz-user-select":"","-webkit-user-select":""});b=b.without(c);return c},disableTextSelection:function(c){c.setStyle({"-moz-user-select":"none","-webkit-user-select":"none"});b.include(c)||
b.push(c);return c}})})();
S2.UI.Behavior=Class.create(S2.UI.Mixin.Configurable,{initialize:function(a,b){this.element=a;this.setOptions(b);Object.extend(this,b);this._observers={};var c,e,d;for(d in this)if(d.startsWith("on")||d.include("/on")){c=d.split("/");a=c.length===2?this[c.first()]||this.element:this.element;c=c.last();e=this._observers[c]=this[d].bind(this);a.observe(c.substring(2),e)}},destroy:function(){var a=this.options.proxy||this.element,b,c;for(c in this._observers){b=this._observers[c];a.stopObserving(c.substring(2),
b)}}});
Object.extend(S2.UI,{addBehavior:function(a,b,c){var e=arguments.callee;if(Object.isArray(a))a.each(function(g){e(g,b,c)});else if(Object.isArray(b))b.each(function(g){e(a,g,c)});else{var d=new b(a,c||{});$(a).retrieve("ui.behaviors",[]).push(d)}},removeBehavior:function(a,b){var c=arguments.callee;if(Object.isArray(a))a.each(function(j){c(j,b)});else if(Object.isArray(b))b.each(function(j){c(a,j)});else{for(var e=$(a).retrieve("ui.behaviors",[]),d=[],g=0,f;f=e[g];g++)if(!(!f instanceof b)){f.destroy();d.push(f)}$(a).store("ui.behaviors",
e.without(d))}},getBehavior:function(a,b){a=$(a);for(var c=a.retrieve("ui.behaviors",[]),e=0,d=c.length,g;e<d;e++){g=c[e];if(g.constructor===b)return g}return null}});
S2.UI.Behavior.Drag=Class.create(S2.UI.Behavior,{initialize:function($super,b,c){this.__onmousemove=this._onmousemove.bind(this);$super(b,c);this.element.addClassName("ui-draggable")},destroy:function($super){this.element.removeClassName("ui-draggable");$super()},"handle/onmousedown":function(a){var b=this.element;this._startPointer=a.pointer();this._startPosition={left:window.parseInt(b.getStyle("left"),10),top:window.parseInt(b.getStyle("top"),10)};document.observe("mousemove",this.__onmousemove)},
"handle/onmouseup":function(){this._startPosition=this._startPointer=null;document.stopObserving("mousemove",this.__onmousemove)},_onmousemove:function(a){a=a.pointer();if(this._startPointer){a={x:a.x-this._startPointer.x,y:a.y-this._startPointer.y};this.element.setStyle({left:this._startPosition.left+a.x+"px",top:this._startPosition.top+a.y+"px"})}}});
S2.UI.Behavior.Focus=Class.create(S2.UI.Behavior,{onfocus:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-focus")},onblur:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-focus")}});
S2.UI.Behavior.Hover=Class.create(S2.UI.Behavior,{onmouseenter:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-hover")},onmouseleave:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-hover")}});S2.UI.Behavior.Resize=Class.create(S2.UI.Behavior,{initialize:function(){}});
S2.UI.Behavior.Down=Class.create(S2.UI.Behavior,{onmousedown:function(){this._down=true;this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-down")},onmouseup:function(){this._down=false;this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-down")},onmouseleave:function(a){return this.onmouseup(a)},onmouseenter:function(a){if(this._down)return this.onmousedown(a)}});
(function(a){a.Base=Class.create(a.Mixin.Configurable,{NAME:"S2.UI.Base",addObservers:Function.ABSTRACT,removeObservers:Function.ABSTRACT,destroy:function(){this.removeObservers()},toElement:function(){return this.element},inspect:function(){return"#<#{NAME}>".interpolate(this)}})})(S2.UI);Object.extend(Event,{KEY_SPACE:32});
(function(a){a.Accordion=Class.create(a.Base,{NAME:"S2.UI.Accordion",initialize:function(b,c){this.element=$(b);var e=this.setOptions(c);a.addClassNames(this.element,"ui-accordion ui-widget ui-helper-reset");if(this.element.nodeName.toUpperCase()==="UL"){var d=this.element.childElements().grep(new Selector("li"));a.addClassNames(d,"ui-accordion-li-fix")}this.headers=this.element.select(e.headerSelector);if(!(!this.headers||this.headers.length===0)){a.addClassNames(this.headers,"ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");
a.addBehavior(this.headers,[a.Behavior.Hover,a.Behavior.Focus]);this.content=this.headers.map(function(g){return g.next()});a.addClassNames(this.content,"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");this.headers.each(function(g){var f=new Element("span");a.addClassNames(f,"ui-icon "+e.icons.header);g.insert({top:f})});this._markActive(e.active||this.headers.first(),false);this.element.writeAttribute({role:"tablist","aria-multiselectable":e.multiple.toString()});this.headers.invoke("writeAttribute",
"role","tab");this.content.invoke("writeAttribute","role","tabpanel");this.headers.map(function(g){return g.down("a")}).invoke("observe","click",function(g){g.preventDefault()});this.observers={click:this.click.bind(this),keypress:this.keypress.bind(this)};this.addObservers()}},addObservers:function(){this.headers.invoke("observe","click",this.observers.click);Prototype.Browser.WebKit?this.headers.invoke("observe","keydown",this.observers.keypress):this.headers.invoke("observe","keypress",this.observers.keypress)},
click:function(b){(b=b.findElement(this.options.headerSelector))&&this.headers.include(b)&&this._toggleActive(b)},keypress:function(b){if(!(b.shiftKey||b.metaKey||b.altKey||b.ctrlKey)){var c=b.findElement(this.options.headerSelector);switch(b.keyCode===0?b.charCode:b.keyCode){case Event.KEY_SPACE:this._toggleActive(c);b.stop();break;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusHeader(c,1);b.stop();break;case Event.KEY_UP:case Event.KEY_LEFT:this._focusHeader(c,-1);b.stop();break;case Event.KEY_HOME:this._focusHeader(this.headers.first());
b.stop();break;case Event.KEY_END:this._focusHeader(this.headers.last());b.stop()}}},_focusHeader:function(b,c){if(Object.isNumber(c)){var e=this.headers.indexOf(b);e+=c;if(e>this.headers.length-1)e=this.headers.length-1;else if(e<0)e=0;b=this.headers[e]}(function(){b.down("a").focus()}).defer()},_toggleActive:function(b){if(b.hasClassName("ui-state-active")){if(this.options.multiple){this._removeActive(b);this._activatePanel(null,b.next(),true)}}else this._markActive(b)},_removeActive:function(b){var c=
this.options;a.removeClassNames(b,"ui-state-active ui-corner-top");a.addClassNames(b,"ui-state-default ui-corner-all");b.writeAttribute("aria-expanded","false");b=b.down(".ui-icon");b.removeClassName(c.icons.headerSelected);b.addClassName(c.icons.header)},_markActive:function(b,c){if(Object.isUndefined(c))c=true;var e=this.options,d=null;if(!e.multiple){d=this.element.down(".ui-accordion-content-active");this.headers.each(this._removeActive.bind(this))}if(b){a.removeClassNames(b,"ui-state-default ui-corner-all");
a.addClassNames(b,"ui-state-active ui-corner-top");b.writeAttribute("aria-expanded","true");this._activatePanel(b.next(),d,c);d=b.down(".ui-icon");d.removeClassName(e.icons.header);d.addClassName(e.icons.headerSelected);return b}},_activatePanel:function(b,c,e){if(e)this.options.transition(b,c);else{c&&c.removeClassName("ui-accordion-content-active");b&&b.addClassName("ui-accordion-content-active")}}});Object.extend(a.Accordion,{DEFAULT_OPTIONS:{multiple:false,headerSelector:"h3",icons:{header:"ui-icon-triangle-1-e",
headerSelected:"ui-icon-triangle-1-s"},transition:function(b,c){var e=[],d;if(c){d=new S2.FX.SlideUp(c,{duration:0.2,after:function(){c.removeClassName("ui-accordion-content-active")}});e.push(d)}if(b){d=new S2.FX.SlideDown(b,{duration:0.2,before:function(){b.addClassName("ui-accordion-content-active")}});e.push(d)}e.invoke("play")}}})})(S2.UI);
(function(a){a.Button=Class.create(a.Base,{NAME:"S2.UI.Button",initialize:function(b,c){this.element=$(b);this.element.store("ui.button",this);var e=this.setOptions(c);a.addClassNames(this.element,"ui-state-default ui-corner-all");a.addBehavior(this.element,[a.Behavior.Hover,a.Behavior.Focus,a.Behavior.Down]);e.primary&&this.element.addClassName("ui-priority-primary");this.element.writeAttribute("role","button");this.enabled=true;this.setEnabled(this.element.disabled===true||!this.element.hasClassName("ui-state-disabled"))},
setEnabled:function(b){if(this.enabled!==b){(this.enabled=b)?this.element.removeClassName("ui-state-disabled"):this.element.addClassName("ui-state-disabled");this.element.disabled=!b}},toElement:function(){return this.element},toHTML:function(){return this.element.toHTML()},toString:function(){return this.element.toHTML()},inspect:function(){return this.element.inspect()}});Object.extend(a.Button,{DEFAULT_OPTIONS:{primary:false}})})(S2.UI);
(function(a){a.Tabs=Class.create(a.Base,{NAME:"S2.UI.Tabs",initialize:function(b,c){this.element=$(b);a.addClassNames(this.element,"ui-widget ui-widget-content ui-tabs ui-corner-all");this.setOptions(c);var e=this.options;this.anchors=[];this.panels=[];this.list=this.element.down("ul");this.list.cleanWhitespace();this.nav=this.list;a.addClassNames(this.nav,"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.tabs=this.list.select("li");a.addClassNames(this.tabs,"ui-state-default ui-corner-top");
a.addBehavior(this.tabs,[a.Behavior.Hover,a.Behavior.Down]);this.element.writeAttribute({role:"tablist","aria-multiselectable":"false"});this.tabs.each(function(f){var j=f.down("a");if(j){var h=j.readAttribute("href");if(h.include("#")){h=h.split("#").last();h=$(h);f.writeAttribute("tabIndex","0");if(h){h.store("ui.tab",f);f.store("ui.panel",h);this.anchors.push(j);this.panels.push(h)}}}},this);this.anchors.invoke("writeAttribute","role","tab");this.panels.invoke("writeAttribute","role","tabpanel");
this.tabs.first().addClassName("ui-position-first");this.tabs.last().addClassName("ui-position-last");a.addClassNames(this.panels,"ui-tabs-panel ui-tabs-hide ui-widget-content ui-corner-bottom");this.observers={onKeyPress:this.onKeyPress.bind(this),onTabClick:this.onTabClick.bind(this)};this.addObservers();var d=window.location.hash.substring(1),g;d.empty()||(g=$(d));this.setSelectedTab(g&&this.panels.include(g)?g.retrieve("ui.tab"):e.selectedTab?$(e.selectedTab):this.tabs.first())},addObservers:function(){this.anchors.invoke("observe",
"click",this.observers.onTabClick);this.tabs.invoke("observe","keypress",this.observers.onKeyPress)},_setSelected:function(b){b=$(b);var c=b.retrieve("ui.tab"),e=this.list.down(".ui-tabs-selected"),d=e?e.retrieve("ui.panel"):null;a.removeClassNames(this.tabs,"ui-tabs-selected ui-state-active");a.addClassNames(this.tabs,"ui-state-default");c.removeClassName("ui-state-default").addClassName("ui-tabs-selected ui-state-active");this.element.fire("ui:tabs:change",{from:{tab:e,panel:d},to:{tab:c,panel:b}});
this.options.panel.transition(d,b)},setSelectedTab:function(b){this.setSelectedPanel(b.retrieve("ui.panel"))},setSelectedPanel:function(b){this._setSelected(b.readAttribute("id"))},onTabClick:function(b){b.stop();b.findElement("a");this.setSelectedTab(b.findElement("li"))},onKeyPress:function(b){if(!a.modifierUsed(b)){var c=b.findElement("li");switch(b.keyCode||b.charCode){case Event.KEY_SPACE:case Event.KEY_RETURN:this.setSelectedTab(c);b.stop();break;case Event.KEY_UP:case Event.KEY_LEFT:this._focusTab(c,
-1);break;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusTab(c,1)}}},_focusTab:function(b,c){if(Object.isNumber(c)){var e=this.tabs.indexOf(b);e+=c;if(e>this.tabs.length-1)e=this.tabs.length-1;else if(e<0)e=0;b=this.tabs[e]}(function(){b.focus()}).defer()}});Object.extend(a.Tabs,{DEFAULT_OPTIONS:{panel:{transition:function(b,c){b&&b.addClassName("ui-tabs-hide");c.removeClassName("ui-tabs-hide")}}}})})(S2.UI);
(function(a){a.Overlay=Class.create(a.Base,a.Mixin.Trackable,a.Mixin.Shim,{NAME:"S2.UI.Overlay",initialize:function(b){this.setOptions(b);this.element=new Element("div",{"class":"ui-widget-overlay"});this.register();this.createShim();this.adjustShim();this.constructor.onResize()},destroy:function(){this.element.remove();this.unregister()},toElement:function(){return this.element}});Object.extend(a.Overlay,{onRegister:function(){if(this.instances.length===1){this._resizeObserver=this._resizeObserver||
this.onResize.bind(this);Event.observe(window,"resize",this._resizeObserver);Event.observe(window,"scroll",this._resizeObserver)}},onUnregister:function(){if(this.instances.length===0){Event.stopObserving(window,"resize",this._resizeObserver);Event.stopObserving(window,"scroll",this._resizeObserver)}},onResize:function(){var b=document.viewport.getDimensions(),c=document.viewport.getScrollOffsets();this.instances.each(function(e){e.element.setStyle({width:b.width+"px",height:b.height+"px",left:c.left+
"px",top:c.top+"px"})});(function(){this.instances.invoke("adjustShim")}).bind(this).defer()}})})(S2.UI);
(function(a){a.Dialog=Class.create(a.Base,{NAME:"S2.UI.Dialog",initialize:function(b,c){if(Object.isElement(b))b=$(b);else{c=b;b=null}var e=this.setOptions(c);this.element=b||new Element("div");a.addClassNames(this.element,"ui-dialog ui-widget ui-widget-content ui-corner-all");this.element.hide().setStyle({position:"absolute",overflow:"hidden",zIndex:e.zIndex,outline:"0"});this.element.writeAttribute({tabIndex:"-1",role:"dialog"});this.content=e.content?Object.isElement(e.content)?e.content:(new Element("div")).update(e.content):
new Element("div");a.addClassNames(this.content,"ui-dialog-content ui-widget-content");this.element.insert(this.content);this.titleBar=this.options.titleBar||new Element("div");a.addClassNames(this.titleBar,"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix");this.element.insert({top:this.titleBar});this.closeButton=new Element("a",{href:"#"});a.addClassNames(this.closeButton,"ui-dialog-titlebar-close ui-corner-all");new a.Button(this.closeButton);this.closeButton.observe("mousedown",
Event.stop);this.closeButton.observe("click",function(d){d.stop();this.close(false)}.bind(this));this.titleBar.insert(this.closeButton);this.closeText=new Element("span");a.addClassNames(this.closeText,"ui-icon ui-icon-closethick");this.closeButton.insert(this.closeText);this.titleText=new Element("span",{"class":"ui-dialog-title"});this.titleText.update(this.options.title).identify();this.element.writeAttribute("aria-labelledby",this.titleText.readAttribute("id"));this.titleBar.insert({top:this.titleText});
a.disableTextSelection(this.element);this.options.draggable&&a.addBehavior(this.element,a.Behavior.Drag,{handle:this.titleBar});(e=this.options.buttons)&&e.length&&this._createButtons();this.observers={keypress:this.keypress.bind(this)}},toElement:function(){return this.element},_createButtons:function(){var b=this.options.buttons;this.buttonPane&&this.buttonPane.remove();this.buttonPane=new Element("div");a.addClassNames(this.buttonPane,"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");
b.each(function(c){var e=new Element("button",{type:"button"});a.addClassNames(e,"ui-state-default ui-corner-all");c.primary&&e.addClassName("ui-priority-primary");c.secondary&&e.addClassName("ui-priority-secondary");e.update(c.label);new a.Button(e);e.observe("click",c.action.bind(this,this));this.buttonPane.insert(e)},this);this.element.insert(this.buttonPane)},_position:function(){var b=document.viewport.getDimensions(),c=this.element;c={width:parseInt(c.getStyle("width"),10),height:parseInt(c.getStyle("height"),
10)};b={left:(b.width/2-c.width/2).round(),top:(b.height/2-c.height/2).round()};c=document.viewport.getScrollOffsets();b.left+=c.left;b.top+=c.top;this.element.setStyle({left:b.left+"px",top:b.top+"px"})},open:function(){if(!this._isOpen)if(!this.element.fire("ui:dialog:before:open",{dialog:this}).stopped){var b=this.options;this.overlay=b.modal?new a.Overlay:null;$(document.body).insert(this.overlay);$(document.body).insert(this.element);this.element.show();this._position();this.focusables=a.findFocusables(this.element);
b.submitForms||this.content.select("form").invoke("observe","submit",Event.stop);var c=this.focusables.without(this.closeButton),e=b.focus;b=false;if(e==="first"){c.first().focus();b=true}else if(e==="last"){c.last().focus();b=true}else if(Object.isElement(e)){e.focus();b=true}else if(this.buttonPane)if(e=this.buttonPane.down(".ui-priority-primary")){e.focus();b=true}!b&&c.length>0&&c.first().focus();Event.observe(window,"keydown",this.observers.keypress);this._isOpen=true;this.element.fire("ui:dialog:after:open",
{dialog:this});return this}},close:function(b){b=!!b;if(!this.element.fire("ui:dialog:before:close",{dialog:this}).stopped){this.overlay&&this.overlay.destroy();this.element.hide();this._isOpen=false;Event.stopObserving(window,"keydown",this.observers.keypress);b={dialog:this,success:b};var c=this.content.down("form");c&&Object.extend(b,{form:c.serialize({hash:true})});this.element.fire("ui:dialog:after:close",b);a.enableTextSelection(this.element,true);return this}},keypress:function(b){if(!a.modifierUsed(b)){var c=
this.focusables,e=this.options;if(b.keyCode===Event.KEY_ESC)e.closeOnEscape&&this.close(false);else if(b.keyCode===Event.KEY_RETURN)this.close(true);else if(b.keyCode===Event.KEY_TAB)if(this.options.modal)if(c){var d;e=b.findElement();e=c.indexOf(e);if(d=e===-1?c.first():b.shiftKey?e===0?c.last():c[e-1]:e===c.length-1?c.first():c[e+1]){b.stop();(function(){d.focus()}).defer()}}}}});Object.extend(a.Dialog,{DEFAULT_OPTIONS:{zIndex:1E3,title:"Dialog",content:null,modal:true,focus:"auto",submitForms:false,
closeOnEscape:true,draggable:true,resizable:false,buttons:[{label:"OK",primary:true,action:function(b){b.close(true)}}]}})})(S2.UI);
(function(a){a.Slider=Class.create(a.Base,{NAME:"S2.UI.Slider",initialize:function(b,c){this.element=$(b);var e=this.setOptions(c);a.addClassNames(this.element,"ui-slider ui-widget ui-widget-content ui-corner-all");this.orientation=e.orientation;this.element.addClassName("ui-slider-"+this.orientation);this._computeTrackLength();var d=e.value.initial;Object.isArray(d)||(d=[d]);this.values=d;this.handles=[];this.values.each(function(f,j){var h=new Element("a",{href:"#"});h.store("ui.slider.handle",
j);this.handles.push(h);this.element.insert(h)},this);a.addClassNames(this.handles,"ui-slider-handle ui-state-default ui-corner-all");this.handles.invoke("writeAttribute","tabIndex","0");this.activeHandle=this.handles.first();this.handles.invoke("observe","click",Event.stop);a.addBehavior(this.handles,[a.Behavior.Hover,a.Behavior.Focus]);this.observers={focus:this.focus.bind(this),blur:this.blur.bind(this),keydown:this.keydown.bind(this),keyup:this.keyup.bind(this),mousedown:this.mousedown.bind(this),
mouseup:this.mouseup.bind(this),mousemove:this.mousemove.bind(this),rangeMouseDown:this.rangeMouseDown.bind(this),rangeMouseMove:this.rangeMouseMove.bind(this),rangeMouseUp:this.rangeMouseUp.bind(this)};d=e.value;if(d.step!==null){this._possibleValues=[];for(var g=d.min;g<d.max;g+=d.step)this._possibleValues.push(g);this._possibleValues.push(d.max);this.keyboardStep=d.step}else if(e.possibleValues){this._possibleValues=e.possibleValues.clone();this.keyboardStep=null}else this.keyboardStep=(d.max-
d.min)/100;this.range=null;if(e.range&&this.values.length===2){this.restricted=true;this.range=new Element("div",{"class":"ui-slider-range"});this.element.insert(this.range);this.range.addClassName("ui-widget-header")}this._computeTrackLength();this._computeHandleLength();this.disabled=this.dragging=this.active=false;this.addObservers();this.values.each(this.setValue,this);this.initialized=true},addObservers:function(){this.element.observe("mousedown",this.observers.mousedown);this.range&&this.range.observe("mousedown",
this.observers.rangeMouseDown);this.handles.invoke("observe","keydown",this.observers.keydown);this.handles.invoke("observe","keyup",this.observers.keyup)},_computeTrackLength:function(){var b;if(this.orientation==="vertical"){b=this.element.offsetHeight;b=b!==0?b:window.parseInt(this.element.getStyle("height"),10)}else{b=this.element.offsetWidth;b=b!==0?b:window.parseInt(this.element.getStyle("width"),10)}return this._trackLength=b},_computeHandleLength:function(){var b=this.handles.first(),c;if(b){if(this.orientation===
"vertical"){c=b.offsetHeight;b=c!==0?c:window.parseInt(b.getStyle("height"),10)}else{c=b.offsetWidth;b=c!==0?c:window.parseInt(b.getStyle("width"),10)}return this._handleLength=b}},_nextValue:function(b,c){return this.options.possibleValues?this._possibleValues[this._possibleValues.indexOf(b)+c]:b+this.keyboardStep*c},keydown:function(b){if(!this.options.disabled){var c=b.findElement(),e=c.retrieve("ui.slider.handle"),d=this.options;if(Object.isNumber(e))if([Event.KEY_HOME,Event.KEY_END,Event.KEY_UP,
Event.KEY_DOWN,Event.KEY_LEFT,Event.KEY_RIGHT].include(b.keyCode)){c.addClassName("ui-state-active");var g;c=g=this.values[e];switch(b.keyCode){case Event.KEY_HOME:g=d.value.min;break;case Event.KEY_END:g=d.value.max;break;case Event.KEY_UP:case Event.KEY_RIGHT:if(c===d.value.max)return;g=this._nextValue(c,1);break;case Event.KEY_DOWN:case Event.KEY_LEFT:if(c===d.value.min)return;g=this._nextValue(c,-1)}this.dragging=true;this.setValue(g,e);if(!Prototype.Browser.WebKit){e=this._timer?0.1:1;this._timer=
arguments.callee.bind(this).delay(e,b)}}}},keyup:function(b){this.dragging=false;if(this._timer){window.clearTimeout(this._timer);this._timer=null}this._updateFinished();b.findElement().removeClassName("ui-state-active")},setValue:function(b,c){if(!this.activeHandle){this.activeHandle=this.handles[c||0];this._updateStyles()}c=c||this.activeHandle.retrieve("ui.slider.handle")||0;if(this.initialized&&this.restricted){if(c>0&&b<this.values[c-1])b=this.values[c-1];if(c<this.handles.length-1&&b>this.values[c+
1])b=this.values[c+1]}b=this._getNearestValue(b);this.values[c]=b;var e={};e[this.orientation==="vertical"?"top":"left"]=this._valueToPx(b)+"px";this.handles[c].setStyle(e);this._drawRange();!this.dragging&&!this.undoing&&!this.initialized&&this._updateFinished();if(this.initialized){this.element.fire("ui:slider:value:changing",{slider:this,values:this.values});this.options.onSlide(this.values,this)}return this},_getNearestValue:function(b){var c=this.options.value;if(b<c.min)b=c.min;if(b>c.max)b=
c.max;if(this._possibleValues){var e;for(c=0;c<this._possibleValues.length;c++){e=this._possibleValues[c];if(e===b)return b;if(e>b)break}b=b.nearer(this._possibleValues[c-1],e)}return b},_valueToPx:function(b){var c=this.options.value,e=(this._trackLength-this._handleLength/2)/(c.max-c.min);e*=b-c.min;if(this.orientation==="vertical")e=this._trackLength-e-this._handleLength;return Math.round(e)},mousedown:function(b){var c=this.options;if(!(!b.isLeftClick()||c.disabled)){b.stop();this._oldValues=
this.values.clone();this.active=true;var e=b.findElement();c=b.pointer();if(e===this.element){b=this.element.cumulativeOffset();this.setValue(this._pxToValue({x:Math.round(c.x-b.left+this._handleLength/4),y:Math.round(c.y-b.top+this._handleLength/4)}));handle=this.activeHandle=this.activeHandle||this.handles.first()}else{handle=b.findElement(".ui-slider-handle");if(!handle)return;this.activeHandle=handle}this._updateStyles();b=handle.cumulativeOffset();this._offsets={x:c.x-b.left,y:c.y-b.top};document.observe("mousemove",
this.observers.mousemove);document.observe("mouseup",this.observers.mouseup)}},mouseup:function(b){if(this.active&&this.dragging){this._updateFinished();b.stop()}this.active=this.dragging=false;this.activeHandle=null;this._updateStyles();document.stopObserving("mousemove",this.observers.mousemove);document.stopObserving("mouseup",this.observers.mouseup)},mousemove:function(b){if(this.active){b.stop();this.dragging=true;this._draw(b);Prototype.Browser.WebKit&&window.scrollBy(0,0)}},rangeMouseDown:function(b){b=
b.pointer();var c=this.element.cumulativeOffset();b={x:Math.round(b.x-c.left),y:Math.round(b.y-c.top)};this._rangeInitialValues=this.values.clone();this._rangePseudoValue=this._pxToValue(b);document.observe("mousemove",this.observers.rangeMouseMove);document.observe("mouseup",this.observers.rangeMouseUp)},rangeMouseMove:function(b){this.dragging=true;b.stop();var c=this.options;b=b.pointer();var e=this.element.cumulativeOffset(),d=this._pxToValue({x:Math.round(b.x-e.left),y:Math.round(b.y-e.top)})-
this._rangePseudoValue;b=this._rangeInitialValues.map(function(g){return g+d});if(b[0]<c.value.min){d=c.value.min-this._rangeInitialValues[0];b=this._rangeInitialValues.map(function(g){return g+d})}else if(b[1]>c.value.max){d=c.value.max-this._rangeInitialValues[1];b=this._rangeInitialValues.map(function(g){return g+d})}b.each(this.setValue,this)},rangeMouseUp:function(){this.dragging=false;document.stopObserving("mousemove",this.observers.rangeMouseMove);document.stopObserving("mouseup",this.observers.rangeMouseUp);
this._updateFinished()},_draw:function(b){b=b.pointer();var c=this.element.cumulativeOffset();b.x-=this._offsets.x+c.left;b.y-=this._offsets.y+c.top;this.setValue(this._pxToValue(b))},_pxToValue:function(b){var c=this.options;b=(this.orientation==="horizontal"?b.x:b.y)/(this._trackLength-this._handleLength)*(c.value.max-c.value.min)+c.value.min;if(this.orientation==="vertical")b=c.value.max-(b-c.value.min);return b},undo:function(){if(this._oldValues){this.values=this._oldValues.clone();this.undoing=
true;this._oldValues.each(this.setValue,this);this.undoing=false}},_updateFinished:function(){if(this.element.fire("ui:slider:value:changed",{slider:this,values:this.values}).stopped)this.undo();else{this.activeHandle=null;this._updateStyles();this.options.onChange(this.values,this)}},_updateStyles:function(){a.removeClassNames(this.handles,"ui-state-active");this.activeHandle&&this.activeHandle.addClassName("ui-state-active")},_drawRange:function(){if(this.range){var b=this.values.map(this._valueToPx,
this);this.orientation==="vertical"?this.range.setStyle({top:b[1]+"px",height:b[0]-b[1]+"px"}):this.range.setStyle({left:b[0]+"px",width:b[1]-b[0]+"px"})}},focus:function(b){if(!this.options.disabled){b=b.findElement();this.element.select(".ui-state-focus").invoke("removeClassName","ui-state-focus");b.addClassName("ui-state-focus")}},blur:function(b){b.findElement().removeClassName("ui-state-focus")}});Object.extend(a.Slider,{DEFAULT_OPTIONS:{range:false,disabled:false,value:{min:0,max:100,initial:0,
step:null},possibleValues:null,orientation:"horizontal",onSlide:Prototype.emptyFunction,onChange:Prototype.emptyFunction}})})(S2.UI);
(function(a){a.ProgressBar=Class.create(a.Base,{NAME:"S2.UI.ProgressBar",initialize:function(b,c){this.element=$(b);var e=this.setOptions(c);a.addClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");this.element.writeAttribute({role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0});this.valueElement=new Element("div",{"class":"ui-progressbar-value ui-widget-header ui-corner-left"});this.value=e.value.initial;this._refreshValue();this.element.insert(this.valueElement);
this.element.store(this.NAME,this)},destroy:function(){a.removeClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");a.removeAttributes(this.element,"role aria-valuemin aria-valuemax aria-valuenow");this.element.getData().unset(this.NAME)},getValue:function(){var b=this.value,c=this.options.value;if(b<c.min)b=c.min;if(b>c.max)b=c.max;return b},setValue:function(b){this._oldValue=this.getValue();this.value=b;this._refreshValue();return this},undo:function(){this.undoing=
true;this.setValue(this._oldValue);this.undoing=false;return this},_refreshValue:function(){var b=this.getValue();if(!this.undoing)if(this.element.fire("ui:progressbar:value:changed",{progressBar:this,value:b}).stopped){this.undo();return}b===this.options.value.max?this.valueElement.addClassName("ui-corner-right"):this.valueElement.removeClassName("ui-corner-right");var c="width: #{0}px".interpolate([window.parseInt(this.element.getStyle("width"),10)*b/100]);a.makeVisible(this.valueElement,b>this.options.value.min);
this.valueElement.morph(c,{duration:0.7,transition:"linear"});this.element.writeAttribute("aria-valuenow",b)}});Object.extend(a.ProgressBar,{DEFAULT_OPTIONS:{value:{min:0,max:100,initial:0}}})})(S2.UI);
(function(a){a.Menu=Class.create(a.Base,a.Mixin.Shim,{NAME:"S2.UI.Menu",initialize:function(b){this.element=$(b);if(!this.element)this.element=new Element("ul",{"class":"ui-helper-hidden"});this.activeId=this.element.identify()+"_active";b=this.setOptions();a.addClassNames(this.element,"ui-widget ui-widget-content ui-menu ui-corner-"+b.corner);this.choices=this.element.select("li");this._highlightedIndex=-1;this.element.writeAttribute({role:"menu","aria-activedescendant":this.activeId});this.choices.invoke("writeAttribute",
"role","menuitem");this.observers={mouseover:this._mouseover.bind(this),click:this._click.bind(this)};this.addObservers();this._shown=false;this.createShim()},addObservers:function(){this.element.observe("mouseover",this.observers.mouseover);this.element.observe("mousedown",this.observers.click)},removeObservers:function(){this.element.stopObserving("mouseover",this.observers.mouseover);this.element.stopObserving("mousedown",this.observers.click)},clear:function(){this.element.select("li").invoke("remove");
this.choices=[];return this},addChoice:function(b){var c;if(Object.isElement(b))if(b.tagName.toUpperCase()==="LI")c=b;else{c=new Element("li");c.insert(b)}else{c=new Element("li");c.update(b)}c.addClassName("ui-menu-item");c.writeAttribute("role","menuitem");this.element.insert(c);this.choices=this.element.select("li");return c},_mouseover:function(b){(b=b.findElement("li"))&&this.highlightChoice(b)},_click:function(b){(b=b.findElement("li"))&&this.selectChoice(b)},moveHighlight:function(b){this._highlightedIndex=
(this._highlightedIndex+b).constrain(-1,this.choices.length-1);this.highlightChoice();return this},highlightChoice:function(b){var c=this.choices;b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._highlightedIndex;a.removeClassNames(this.choices,"ui-state-active");if(b!==-1){this.choices[b].addClassName("ui-state-active");this._highlightedIndex=b;(c=this.element.down("#"+this.activeId))&&c.writeAttribute("id","");this.choices[b].writeAttribute("id",this.activeId)}},selectChoice:function(b){if(Object.isNumber(b))b=
this.choices[b];else b||(b=this.choices[this._highlightedIndex]);this.element.fire("ui:menu:selected",{instance:this,element:b}).stopped||this.close();return this},open:function(){this.element.fire("ui:menu:opened",{instance:this});this.element.removeClassName("ui-helper-hidden");this._highlightedIndex=-1;Prototype.Browser.IE&&this.adjustShim()},close:function(){this.element.fire("ui:menu:closed",{instance:this});this.element.addClassName("ui-helper-hidden");return this},isOpen:function(){return!this.element.hasClassName("ui-helper-hidden")}});
Object.extend(a.Menu,{DEFAULT_OPTIONS:{corner:"all"}})})(S2.UI);
(function(a){a.Autocompleter=Class.create(a.Base,{NAME:"S2.UI.Autocompleter",initialize:function(b,c){this.element=$(b);var e=this.setOptions(c);a.addClassNames(this.element,"ui-widget ui-autocompleter");this.input=this.element.down('input[type="text"]');if(!this.input){this.input=new Element("input",{type:"text"});this.element.insert(this.input)}this.input.insert({before:this.button});this.input.setAttribute("autocomplete","off");this.name=e.parameterName||this.input.readAttribute("name");if(e.choices)this.choices=
e.choices.clone();this.menu=new a.Menu;this.element.insert(this.menu.element);(function(){var d=this.input.getLayout();this.menu.element.setStyle({left:d.get("left")+"px",top:d.get("top")+d.get("margin-box-height")+"px"})}).bind(this).defer();this.observers={blur:this._blur.bind(this),keyup:this._keyup.bind(this),keydown:this._keydown.bind(this),selected:this._selected.bind(this)};this.addObservers()},addObservers:function(){this.input.observe("blur",this.observers.blur);this.input.observe("keyup",
this.observers.keyup);this.input.observe("keydown",this.observers.keydown);this.menu.element.observe("ui:menu:selected",this.observers.selected)},_schedule:function(){this._unschedule();this._timeout=this._change.bind(this).delay(this.options.frequency)},_unschedule:function(){this._timeout&&window.clearTimeout(this._timeout)},_keyup:function(){var b=this.input.getValue();if(b){if(b.blank()||b.length<this.options.minCharacters){this.menu.close();this._unschedule();return}b!==this._value&&this._schedule()}else{this.menu.close();
this._unschedule()}this._value=b},_keydown:function(b){if(!a.modifierUsed(b))if(this.menu.isOpen())switch(b.keyCode){case Event.KEY_UP:this.menu.moveHighlight(-1);b.stop();break;case Event.KEY_DOWN:this.menu.moveHighlight(1);b.stop();break;case Event.KEY_TAB:this.menu.selectChoice();break;case Event.KEY_RETURN:this.menu.selectChoice();this.input.blur();b.stop();break;case Event.KEY_ESC:this.input.setValue("");this.input.blur()}},_getInput:function(){return this.input.getValue()},_setInput:function(b){this.input.setValue(b)},
_change:function(){this.findChoices()},findChoices:function(){var b=this._getInput();this.setChoices((this.choices||[]).inject([],function(c,e){e.toLowerCase().include(b.toLowerCase())&&c.push(e);return c}))},setChoices:function(b){this.results=b;this._updateMenu(b)},_updateMenu:function(b){var c=this.options;this.menu.clear();for(var e=RegExp(RegExp.escape(this._value),"i"),d=0,g,f,j;g=b[d];d++){j=c.highlightSubstring?g.replace(e,"<b>$&</b>"):j;f=(new Element("li")).update(j);f.store("ui.autocompleter.value",
g);this.menu.addChoice(f)}b.length===0?this.menu.close():this.menu.open()},_moveMenuChoice:function(b){this.list.down("li");this._selectedIndex=(this._selectedIndex+b).constrain(-1,this.results.length-1);this._highlightMenuChoice()},_highlightMenuChoice:function(b){var c=this.list.select("li");b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._selectedIndex;a.removeClassNames(c,"ui-state-active");if(!(b===-1||b===null)){c[b].addClassName("ui-state-active");this._selectedIndex=b}},_selected:function(b){(b=
b.memo.element)&&this._setInput(b.retrieve("ui.autocompleter.value"));this.menu.close()},_blur:function(){this._unschedule();this.menu.close()}});Object.extend(a.Autocompleter,{DEFAULT_OPTIONS:{tokens:[],frequency:0.4,minCharacters:1,highlightSubstring:true,onShow:Prototype.K,onHide:Prototype.K}})})(S2.UI);
document.observe("dom:loaded",function(){function a(h){h._rotation=h._rotation||0;h._scale=h._scale||1;h._panX=h._panX||0;h._panY=h._panY||0;h._pans=[[0,0],[0,0],[0,0]];h._panidx=1}function b(h,m){h.fire("manipulate:update",Object.extend(m,{id:g}))}function c(){function h(p){for(var s=p.length;s--;)y[p[s].identifier]=p[s];p=[];for(k in y)p.push(k);p=p.sort();if((m=(v=p.length>0?p[0]:null)?y[v].target:null)&&m.nodeType==3)m=m.parentNode;z=p.length>1?p[1]:null;if(B==0&&v&&z){i=(y[v].pageX-y[z].pageX).abs();
o=(y[v].pageY-y[z].pageY).abs();m&&a(m);n=Math.sqrt(i*i+o*o);q=Math.atan2(y[z].pageY-y[v].pageY,y[z].pageX-y[v].pageX);B=1}else if(B==1&&!(v&&z)){if(m){p=m;s=w;p._rotation=r;p._scale=s;p._panX=void 0;p._panY=void 0}B=0}}var m,r,w,y={},v=null,z=null,B=0,A,l,i,o,n,q;d.observe("touchstart",function(p){var s=v;h(p.changedTouches);if(s==null&&v){s=m.viewportOffset();A=s.left+(y[v].pageX-s.left);l=s.top+(y[v].pageY-s.top)}p.stop()});d.observe("touchmove",function(p){h(p.changedTouches);if(v&&!z){b(m,{panX:(m._panX||
0)+y[v].pageX-A,panY:(m._panY||0)+y[v].pageY-l,scale:m._scale,rotation:m._rotation});p.stop()}else if(v&&z){var s=y[z].pageX-y[v].pageX,x=y[z].pageY-y[v].pageY,u=(m._panX||0)+y[z].pageX-s/2-A,C=(m._panY||0)+y[z].pageY-x/2-l;w=m._scale*Math.sqrt(s*s+x*x)/n;r=m._rotation+Math.atan2(x,s)-q;b(m,{rotation:r,scale:w,panX:u,panY:C});p.stop()}});["touchcancel","touchend"].each(function(p){d.observe(p,function(s){for(var x=s.changedTouches.length;x--;)delete y[s.changedTouches[x].identifier];h([]);if(m){s=
m;x=w;s._rotation=r;s._scale=x;s._panX=void 0;s._panY=void 0}})})}function e(){var h,m,r,w,y;d.observe("manipulatestart",function(v){v.stop();h=v.element();a(h)});d.observe("manipulatemove",function(v){h=v.element();m=h._rotation+v.rotation;r=h._scale*v.scale;w=h._panX+v.panX;y=h._panY+v.panY;b(h,{rotation:m,scale:r,panX:w,panY:y,clientX:v.clientX,clientY:v.clientY});v.stop()},false);d.observe("manipulateend",function(v){if(h=v.element()){var z=h,B=r,A=w,l=y;z._rotation=m;z._scale=B;z._panX=A;z._panY=
l}z=Math.sqrt(v.panSpeedX*v.panSpeedX+v.panSpeedY*v.panSpeedY);z>25&&h.fire("manipulate:flick",{speed:z,direction:Math.atan2(v.panSpeedY,v.panSpeedX)})});d.observe("mousemove",function(v){v.stop()});d.observe("mousedown",function(v){v.stop()});d.observe("mouseup",function(v){v.stop()})}if(S2.enableMultitouchSupport){var d=$(document.body),g=0;if(navigator.userAgent.match(/SLBrowser/))return e();if(navigator.userAgent.match(/QtLauncher/))return e();if(navigator.userAgent.match(/Starlight/))return e();
try{document.createEvent("ManipulateEvent");return e()}catch(f){}try{document.createEvent("TouchEvent");return c()}catch(j){}return function(){function h(p){var s=v.viewportOffset(),x=p.pageX-s.left-r;p=p.pageY-s.top-w;q=Math.sqrt(x*x+p*p);n=v._scale*q/B;o=v._rotation+Math.atan2(p,x)-A;return{rotation:o,scale:n,panX:v._panX,panY:v._panY}}function m(p){return{rotation:v._rotation,scale:v._scale,panX:v._panX+p.pageX-l,panY:v._panY+p.pageY-i}}var r,w,y=false,v,z,B,A,l,i,o,n,q;d.observe("mousedown",function(p){z=
p.shiftKey?"scale":"pan";if((v=p.element())&&v.fire){g++;y=true;a(v);var s=v.viewportOffset();r=v.offsetWidth/2;w=v.offsetHeight/2;var x=p.pageX-s.left-r,u=p.pageY-s.top-w;B=Math.sqrt(x*x+u*u);A=Math.atan2(u,x);l=s.left+(p.pageX-s.left);i=s.top+(p.pageY-s.top);p.stop()}});d.observe("mousemove",function(p){if(y)b(v,z=="scale"?h(p):m(p))});d.observe("mouseup",function(p){if(y){y=false;if(z=="scale"){p=h(p);b(v,p);v._rotation=p.rotation;v._scale=p.scale}else{b(v,m(p));v._panX=v._panX+p.pageX-l;v._panY=
v._panY+p.pageY-i}}});d.observe("dragstart",function(p){p.stop()})}()}});Element.__scrollTo=Element.scrollTo;Element.addMethods({scrollTo:function(a,b,c){if(arguments.length==1)return Element.__scrollTo(a);(new S2.FX.Scroll(a,Object.extend(c||{},{to:b}))).play();return a}});
Element.addMethods({effect:function(a,b,c){if(Object.isFunction(b))b=new b(a,c);else if(Object.isString(b))b=new (S2.FX[b.capitalize()])(a,c);b.play(a,c);return a},morph:function(a,b,c){c=S2.FX.parseOptions(c);if(!c.queue){c.queue=a.retrieve("S2.FX.Queue");if(!c.queue)a.store("S2.FX.Queue",c.queue=new S2.FX.Queue)}if(!c.position)c.position="end";return a.effect("morph",Object.extend(c,{style:b}))}.optionize(),appear:function(a,b){return a.effect("morph",Object.extend({before:function(){a.show().setStyle({opacity:0})},
style:"opacity:1"},b))},fade:function(a,b){return a.effect("morph",Object.extend({style:"opacity:0",after:a.hide.bind(a)},b))},cloneWithoutIDs:function(a){a=$(a);a=a.cloneNode(true);a.id="";$(a).select("*[id]").each(function(b){b.id=""});return a}});
(function(){Element.addMethods({transform:window.CSSMatrix?function(a,b){a.style.transform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:window.WebKitCSSMatrix?function(a,b){a.style.webkitTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.Gecko?function(a,b){a.style.MozTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.IE?function(a,b){if(!a._oDims)a._oDims=[a.offsetWidth,a.offsetHeight];var c=
Math.cos(b.rotation||0)*1,e=Math.sin(b.rotation||0)*1;a.style.filter="progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11="+c+",M12="+-e+",M21="+e+",M22="+c+")";a.style.marginLeft=(a._oDims[0]-a.offsetWidth)/2+"px";a.style.marginTop=(a._oDims[1]-a.offsetHeight)/2+"px";return a}:function(a){return a}})})();
S2.viewportOverlay=function(){var a=document.viewport.getDimensions(),b=document.viewport.getScrollOffsets();return(new Element("div")).setStyle({position:"absolute",left:b.left+"px",top:b.top+"px",width:a.width+"px",height:a.height+"px"})};S2.FX.Helpers={fitIntoRectangle:function(a,b,c,e){return a/b<c/e?[(c-a*(e/b))/2,0,a*(e/b),e]:[0,(e-b*(c/a))/2,c,b*(c/a)]}};
S2.FX.Operators.Zoom=Class.create(S2.FX.Operators.Style,{initialize:function($super,b,c,e){var d=document.viewport.getDimensions(),g=document.viewport.getScrollOffsets(),f=c.getDimensions();d=S2.FX.Helpers.fitIntoRectangle(f.width,f.height,d.width-(e.borderWidth||0)*2,d.height-(e.borderWidth||0)*2);Object.extend(e,{style:{left:d[0]+(e.borderWidth||0)+g.left+"px",top:d[1]+(e.borderWidth||0)+g.top+"px",width:d[2]+"px",height:d[3]+"px"}});$super(b,c,e)}});
S2.FX.Zoom=Class.create(S2.FX.Element,{setup:function(){this.clone=this.element.cloneWithoutIDs();this.element.insert({before:this.clone});this.clone.absolutize().setStyle({zIndex:9999});this.overlay=S2.viewportOverlay();this.options.overlayClassName?this.overlay.addClassName(this.options.overlayClassName):this.overlay.setStyle({backgroundColor:"#000",opacity:"0.9"});$$("body")[0].insert(this.overlay);this.animate("zoom",this.clone,{borderWidth:this.options.borderWidth,propertyTransitions:this.options.propertyTransitions||
{}})},teardown:function(){this.clone.observe("click",function(){this.overlay.remove();this.clone.morph("opacity:0",{duration:0.2,after:function(){this.clone.remove()}.bind(this)})}.bind(this))}});var MySublimeVideo=MySublimeVideo||{};
document.observe("dom:loaded",function(){S2.Extensions.webkitCSSTransitions=true;if($("edit_credentials"))MySublimeVideo.currentPasswordHandler=new CurrentPasswordHandler;$$("input[type=password]").each(function(b,c){new PasswordFieldManager(b,c)});if(!supportsHtml5InputAttribute("placeholder")){$$("input[placeholder]").each(function(b){new PlaceholderManager(b)});$$("textarea[placeholder]").each(function(b){new PlaceholderManager(b)})}$$("form").each(function(b){new FormManager(b)});$$("#flash .notice").each(function(b){MySublimeVideo.hideFlashNoticeDelayed(b)});
if($("new_site")){MySublimeVideo.addSiteHandler=new AddSiteHandler;MySublimeVideo.sitesPoller=new SitesPoller}var a=navigator.userAgent.match(/AppleWebKit\/([0-9]+)./);navigator.userAgent.indexOf("Macintosh")>-1&&a&&parseInt(a[1],10)<=531&&$$("select").each(function(b){b.setStyle({fontFamily:"Lucida Grande, Arial, sans-serif",fontSize:"15px"})})});
MySublimeVideo.flashNotice=function(a){var b=$("flash");b&&b.remove();a=(new Element("div",{className:"notice"})).update(a);b=(new Element("div",{id:"flash"})).insert(a);$("content").insert({top:b});MySublimeVideo.hideFlashNoticeDelayed(a)};MySublimeVideo.hideFlashNoticeDelayed=function(a){setTimeout(function(){a.morph("top:-35px",{duration:0.7})},15E3)};
MySublimeVideo.openPopup=function(a,b,c){if(!MySublimeVideo.popupHandler)MySublimeVideo.popupHandler=new PopupHandler;MySublimeVideo.popupHandler.open(a,b,c)};MySublimeVideo.closePopup=function(){if(!MySublimeVideo.popupHandler)MySublimeVideo.popupHandler=new PopupHandler;MySublimeVideo.popupHandler.close();return false};MySublimeVideo.makeSticky=function(a){$$("#header .active").each(function(b){b.removeClassName("active")});a.addClassName("active")};
MySublimeVideo.makeRemoteLinkSticky=function(a){a.up().select("a.active[data-remote]").each(function(b){b.removeClassName("active")});a.addClassName("active")};MySublimeVideo.showTableSpinner=function(){$("table_spinner").show()};MySublimeVideo.showSiteEmbedCode=function(a){MySublimeVideo.openPopup(a,"embed_code_site","/sites/"+a);return false};MySublimeVideo.showSiteSettings=function(a){MySublimeVideo.openPopup(a,"settings","/sites/"+a+"/edit");return false};
MySublimeVideo.showInvoice=function(a,b){MySublimeVideo.openPopup(a,"invoices_"+b,"/invoices/"+a+"?type="+b);return false};MySublimeVideo.confirmDeleteSite=function(a){if(confirm("Are you sure?")){setTimeout(function(){a.disable()},100);MySublimeVideo.showTableSpinner()}else return false};
var AddSiteHandler=Class.create({initialize:function(){this.setup()},setup:function(){this.element=$("new_site");this.beforeAjaxHandler=this.element.on("ajax:before",function(){this.numberOfRequestsUntilSpinnerHides=1;this.element.next(".spinner").show();this.beforeAjaxHandler.stop()}.bind(this))},reloadAfterAjax:function(){this.hideSpinner();this.setup();supportsHtml5InputAttribute("placeholder")||new PlaceholderManager(this.element.down("input[placeholder]"));new FormManager(this.element)},hideSpinner:function(){this.numberOfRequestsUntilSpinnerHides-=
1;this.numberOfRequestsUntilSpinnerHides==0&&$("new_site_wrap").down(".spinner").hide()}}),FormManager=Class.create({initialize:function(a){a.on(Prototype.Browser.IE?"emulated:submit":"submit",function(b){b.findElement("form[data-remote]")&&a.select("input[type=submit]","button").each(function(c){c.disable()});supportsHtml5InputAttribute("placeholder")||a.select("input.placeholder").each(function(c){c.value=""})});a.select("input[type=submit]").each(function(b){b.on("click",function(){a.select("input").each(function(c){if(c.validity)c.validity.valid?
c.removeClassName("errors"):c.addClassName("errors")})})})}}),PasswordFieldManager=Class.create({initialize:function(a,b){this.field=a;this.field.store("passwordFieldManager",this);if(this.field.hasClassName("show_password")){var c=new Element("div",{className:"checkbox_wrap"}),e=(new Element("label",{"for":"show_password_"+b})).update("Show password");this.showPasswordCheckbox=new Element("input",{type:"checkbox",id:"show_password_"+b});c.insert(this.showPasswordCheckbox).insert(e);(e=this.field.up().select(".inline_errors").first())?
e.insert({after:c}):this.field.insert({after:c});this.showPasswordCheckbox.on("click",this.toggleShowPassword.bind(this));this.showPasswordCheckbox.checked=false}},isShowingPassword:function(){return this.showPasswordCheckbox?this.showPasswordCheckbox.checked:false},toggleShowPassword:function(){var a=this.field.retrieve("placeholderManager");if(a){if(this.field.value!=this.field.readAttribute("placeholder")){this.replacePasswordField(this.field,this.isShowingPassword());a.passwordFieldDidUpdate(this.field)}}else this.replacePasswordField(this.field,
this.isShowingPassword())},replacePasswordField:function(a,b){var c=new Element("input",{id:a.id,name:a.name,value:a.value,size:a.size,placeholder:a.readAttribute("placeholder"),required:a.readAttribute("required"),className:a.className,type:b?"text":"password"});a.purge();a.replace(c);this.field=c;this.field.id=="user_password"&&$("current_password_wrap")&&MySublimeVideo.currentPasswordHandler.setupField(this.field);return c}}),PlaceholderManager=Class.create({initialize:function(a){this.field=a;
this.passwordFieldManager=this.field.retrieve("passwordFieldManager");if(this.field.value==this.field.readAttribute("placeholder")){this.field.value="";this.field.removeClassName("placeholder")}this.setupObservers();this.resetField()},setupObservers:function(){this.field.store("placeholderManager",this);this.field.on("focus",this.clearField.bind(this));this.field.on("blur",this.resetField.bind(this))},clearField:function(){if(this.field.value==this.field.readAttribute("placeholder")){this.field.value=
"";this.field.removeClassName("placeholder");if(this.passwordFieldManager){this.field=this.passwordFieldManager.replacePasswordField(this.field,this.passwordFieldManager.isShowingPassword());Prototype.Browser.IE?setTimeout(function(){this.field.focus()}.bind(this),0):this.field.focus();this.setupObservers()}}else if(this.field.value=="")if(this.field.validity&&!this.field.validity.valid)this.passwordFieldManager?this.resetField():this.field.removeClassName("placeholder")},resetField:function(){if(this.field.value==
""){this.field.addClassName("placeholder");this.field.value=this.field.readAttribute("placeholder");if(this.passwordFieldManager){this.field=this.passwordFieldManager.replacePasswordField(this.field,true);this.setupObservers()}}},passwordFieldDidUpdate:function(a){this.field=a;this.setupObservers()}}),PopupHandler=Class.create({initialize:function(){this.keyDownHandler=document.on("keydown",this.keyDown.bind(this))},startKeyboardObservers:function(){this.keyDownHandler.start()},stopKeyboardObservers:function(){this.keyDownHandler.stop()},
open:function(a,b,c){this.close();a=(new Element("div",{id:b+"_"+a,className:"popup loading"})).update("<div class='wrap'><div class='content "+b+"'></div></div>");b=(new Element("a",{href:"",className:"close",onclick:"return MySublimeVideo.closePopup()"})).update("<span>Close</span>");a.insert({bottom:b});$("global").insert({after:a});this.startKeyboardObservers();new Ajax.Request(c,{method:"get"})},close:function(){this.stopKeyboardObservers();$$(".popup").each(function(a){a.remove()})},keyDown:function(a){switch(a.keyCode){case Event.KEY_ESC:this.close()}}}),
SitesPoller=Class.create({initialize:function(){this.pollingDelay=3E3;this.maxAttempts=20;this.attemptedPolls=0;this.checkForSiteInProgress()},checkForSiteInProgress:function(){var a=$$("#sites .in_progress").first();if(a){this.currentSiteId=parseInt(a.up("tr").id.replace("site_",""),10);this.startPolling()}},startPolling:function(){this.poll&&this.stopPolling();this.poll=setInterval(this.remoteCheckForStateUpdate.bind(this),this.pollingDelay)},stopPolling:function(){clearInterval(this.poll);this.poll=
null},remoteCheckForStateUpdate:function(){if(this.attemptedPolls<this.maxAttempts){this.attemptedPolls++;new Ajax.Request("/sites/"+this.currentSiteId+"/state",{method:"get"})}else this.stopPolling()},updateSite:function(a){this.stopPolling();var b=$$("#site_"+a+" .code").first();if(b){var c=(new Element("a",{href:"/sites/"+a,className:"embed_code",onclick:"return MySublimeVideo.showSiteEmbedCode("+a+")"})).update("Embed code");b.update(c)}if(b=$$("#site_"+a+" .settings").first()){b.removeClassName("disabled");
b.writeAttribute("onclick","return MySublimeVideo.showSiteSettings("+a+")")}this.checkForSiteInProgress()}}),CurrentPasswordHandler=Class.create({initialize:function(){this.emailField=$("user_email");this.passwordField=$("user_password");this.currentPasswordWrap=$("current_password_wrap");[this.emailField,this.passwordField].each(function(a){this.setupField(a)}.bind(this))},setupField:function(a){a.on("focus",function(){this.showCurrentPassword()}.bind(this))},showCurrentPassword:function(){this.currentPasswordWrap.show()}});
function supportsHtml5InputOfType(a){var b=document.createElement("input");b.setAttribute("type",a);return b.type!=="text"}function supportsHtml5InputAttribute(a){var b=document.createElement("input");return a in b}function ddd(){console.log.apply(console,arguments)};
