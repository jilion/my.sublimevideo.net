var Prototype={Version:"1.7_rc2",Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(a)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!(a&&a.prototype)}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!==
"undefined")return true;var a=document.createElement("div"),b=document.createElement("form"),c=false;if(a.__proto__&&a.__proto__!==b.__proto__)c=true;return c}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;
var Abstract={},Try={these:function(){for(var a,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a}},Class=function(){function a(){}var b=function(){for(var c in{toString:1})if(c==="toString")return false;return true}();return{create:function(){function c(){this.initialize.apply(this,arguments)}var d=null,e=$A(arguments);if(Object.isFunction(e[0]))d=e.shift();Object.extend(c,Class.Methods);c.superclass=d;c.subclasses=[];if(d){a.prototype=d.prototype;c.prototype=
new a;d.subclasses.push(c)}d=0;for(var i=e.length;d<i;d++)c.addMethods(e[d]);if(!c.prototype.initialize)c.prototype.initialize=Prototype.emptyFunction;return c.prototype.constructor=c},Methods:{addMethods:function(c){var d=this.superclass&&this.superclass.prototype,e=Object.keys(c);if(b){c.toString!=Object.prototype.toString&&e.push("toString");c.valueOf!=Object.prototype.valueOf&&e.push("valueOf")}for(var i=0,f=e.length;i<f;i++){var j=e[i],h=c[j];if(d&&Object.isFunction(h)&&h.argumentNames()[0]==
"$super"){var m=h;h=function(r){return function(){return d[r].apply(this,arguments)}}(j).wrap(m);h.valueOf=m.valueOf.bind(m);h.toString=m.toString.bind(m)}this.prototype[j]=h}return this}}}}();
(function(){function a(n){switch(n){case null:return m;case void 0:return r}switch(typeof n){case "boolean":return v;case "number":return z;case "string":return w}return y}function b(n,q){for(var p in q)n[p]=q[p];return n}function c(n){return d("",{"":n},[])}function d(n,q,p){q=q[n];if(a(q)===y&&typeof q.toJSON==="function")q=q.toJSON(n);n=h.call(q);switch(n){case A:case B:case l:q=q.valueOf()}switch(q){case null:return"null";case true:return"true";case false:return"false"}switch(typeof q){case "string":return q.inspect(true);
case "number":return isFinite(q)?String(q):"null";case "object":for(var s=0,u=p.length;s<u;s++)if(p[s]===q)throw new TypeError;p.push(q);var x=[];if(n===g){s=0;for(u=q.length;s<u;s++){var C=d(s,q,p);x.push(typeof C==="undefined"?"null":C)}x="["+x.join(",")+"]"}else{var D=Object.keys(q);s=0;for(u=D.length;s<u;s++){n=D[s];C=d(n,q,p);typeof C!=="undefined"&&x.push(n.inspect(true)+":"+C)}x="{"+x.join(",")+"}"}p.pop();return x}}function e(n){return JSON.stringify(n)}function i(n){if(a(n)!==y)throw new TypeError;
var q=[];for(var p in n)n.hasOwnProperty(p)&&q.push(p);return q}function f(n){return h.call(n)===g}function j(n){return typeof n==="undefined"}var h=Object.prototype.toString,m="Null",r="Undefined",v="Boolean",z="Number",w="String",y="Object",B="[object Boolean]",A="[object Number]",l="[object String]",g="[object Array]",o=window.JSON&&typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&typeof JSON.stringify(Prototype.K)==="undefined";if(typeof Array.isArray=="function"&&Array.isArray([])&&
!Array.isArray({}))f=Array.isArray;b(Object,{extend:b,inspect:function(n){try{if(j(n))return"undefined";if(n===null)return"null";return n.inspect?n.inspect():String(n)}catch(q){if(q instanceof RangeError)return"...";throw q;}},toJSON:o?e:c,toQueryString:function(n){return $H(n).toQueryString()},toHTML:function(n){return n&&n.toHTML?n.toHTML():String.interpret(n)},keys:Object.keys||i,values:function(n){var q=[];for(var p in n)q.push(n[p]);return q},clone:function(n){return b({},n)},isElement:function(n){return!!(n&&
n.nodeType==1)},isArray:f,isHash:function(n){return n instanceof Hash},isFunction:function(n){return typeof n==="function"},isString:function(n){return h.call(n)===l},isNumber:function(n){return h.call(n)===A},isUndefined:j})})();
Object.extend(Function.prototype,function(){function a(d,e){for(var i=d.length,f=e.length;f--;)d[i+f]=e[f];return d}function b(d,e){d=c.call(d,0);return a(d,e)}var c=Array.prototype.slice;return{argumentNames:function(){var d=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return d.length==1&&!d[0]?[]:d},bind:function(d){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var e=this,i=c.call(arguments,
1);return function(){var f=b(i,arguments);return e.apply(d,f)}},bindAsEventListener:function(d){var e=this,i=c.call(arguments,1);return function(f){f=a([f||window.event],i);return e.apply(d,f)}},curry:function(){if(!arguments.length)return this;var d=this,e=c.call(arguments,0);return function(){var i=b(e,arguments);return d.apply(this,i)}},delay:function(d){var e=this,i=c.call(arguments,1);d*=1E3;return window.setTimeout(function(){return e.apply(e,i)},d)},defer:function(){return this.delay.apply(this,
a([0.01],arguments))},wrap:function(d){var e=this;return function(){var i=a([e.bind(this)],arguments);return d.apply(this,i)}},methodize:function(){if(this._methodized)return this._methodized;var d=this;return this._methodized=function(){var e=a([this],arguments);return d.apply(null,e)}}}}());
(function(a){function b(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function c(){return this.toISOString()}if(!a.toISOString)a.toISOString=b;if(!a.toJSON)a.toJSON=c})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;
RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};
var PeriodicalExecuter=Class.create({initialize:function(a,b){this.callback=a;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1E3)},execute:function(){this.callback(this)},stop:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=
false;throw a;}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"}});
Object.extend(String.prototype,function(){function a(f){if(Object.isFunction(f))return f;var j=new Template(f);return function(h){return j.evaluate(h)}}function b(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function c(f){var j=this.strip().match(/([^?#]*)(#.*)?$/);if(!j)return{};return j[1].split(f||"&").inject({},function(h,m){if((m=m.split("="))[0]){var r=decodeURIComponent(m.shift()),v=m.length>1?m.join("="):m[0];if(v!=undefined)v=decodeURIComponent(v);if(r in h){Object.isArray(h[r])||
(h[r]=[h[r]]);h[r].push(v)}else h[r]=v}return h})}function d(f){var j=this.unfilterJSON(),h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(h.test(j))j=j.replace(h,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)});try{if(!f||j.isJSON())return eval("("+j+")")}catch(m){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());}function e(){var f=this.unfilterJSON();return JSON.parse(f)}var i=window.JSON&&
typeof JSON.parse==="function"&&JSON.parse('{"test": true}').test;return{gsub:function(f,j){var h="",m=this,r;j=a(j);if(Object.isString(f))f=RegExp.escape(f);if(!(f.length||f.source)){j=j("");return j+m.split("").join(j)+j}for(;m.length>0;)if(r=m.match(f)){h+=m.slice(0,r.index);h+=String.interpret(j(r));m=m.slice(r.index+r[0].length)}else{h+=m;m=""}return h},sub:function(f,j,h){j=a(j);h=Object.isUndefined(h)?1:h;return this.gsub(f,function(m){if(--h<0)return m[0];return j(m)})},scan:function(f,j){this.gsub(f,
j);return String(this)},truncate:function(f,j){f=f||30;j=Object.isUndefined(j)?"...":j;return this.length>f?this.slice(0,f-j.length)+j:String(this)},strip:String.prototype.trim||b,stripTags:function(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")},extractScripts:function(){var f=new RegExp(Prototype.ScriptFragment,"img"),j=new RegExp(Prototype.ScriptFragment,"im");return(this.match(f)||
[]).map(function(h){return(h.match(j)||["",""])[1]})},evalScripts:function(){return this.extractScripts().map(function(f){return eval(f)})},escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},toQueryParams:c,parseQuery:c,toArray:function(){return this.split("")},succ:function(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-
1)+1)},times:function(f){return f<1?"":(new Array(f+1)).join(this)},camelize:function(){return this.replace(/-+(.)?/g,function(f,j){return j?j.toUpperCase():""})},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},underscore:function(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()},dasherize:function(){return this.replace(/_/g,"-")},inspect:function(f){var j=this.replace(/[\x00-\x1f\\]/g,
function(h){if(h in String.specialChar)return String.specialChar[h];return"\\u00"+h.charCodeAt().toPaddedString(2,16)});if(f)return'"'+j.replace(/"/g,'\\"')+'"';return"'"+j.replace(/'/g,"\\'")+"'"},unfilterJSON:function(f){return this.replace(f||Prototype.JSONFilter,"$1")},isJSON:function(){var f=this;if(f.blank())return false;f=f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");f=f.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");f=f.replace(/(?:^|:|,)(?:\s*\[)+/g,
"");return/^[\],:{}\s]*$/.test(f)},evalJSON:i?e:d,include:function(f){return this.indexOf(f)>-1},startsWith:function(f){return this.lastIndexOf(f,0)===0},endsWith:function(f){var j=this.length-f.length;return j>=0&&this.indexOf(f,j)===j},empty:function(){return this==""},blank:function(){return/^\s*$/.test(this)},interpolate:function(f,j){return(new Template(this,j)).evaluate(f)}}}());
var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements))a=a.toTemplateReplacements();return this.template.gsub(this.pattern,function(b){if(a==null)return b[1]+"";var c=b[1]||"";if(c=="\\")return b[2];var d=a,e=b[3],i=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;b=i.exec(e);if(b==null)return c;for(;b!=null;){var f=b[1].startsWith("[")?b[2].replace(/\\\\]/g,"]"):b[1];d=d[f];if(null==
d||""==b[3])break;e=e.substring("["==b[3]?b[1].length:b[0].length);b=i.exec(e)}return c+String.interpret(d)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;
var $break={},Enumerable=function(){function a(j,h){j=j||Prototype.K;var m=true;this.each(function(r,v){m=m&&!!j.call(h,r,v);if(!m)throw $break;});return m}function b(j,h){j=j||Prototype.K;var m=false;this.each(function(r,v){if(m=!!j.call(h,r,v))throw $break;});return m}function c(j,h){j=j||Prototype.K;var m=[];this.each(function(r,v){m.push(j.call(h,r,v))});return m}function d(j,h){var m;this.each(function(r,v){if(j.call(h,r,v)){m=r;throw $break;}});return m}function e(j,h){var m=[];this.each(function(r,
v){j.call(h,r,v)&&m.push(r)});return m}function i(j){if(Object.isFunction(this.indexOf))if(this.indexOf(j)!=-1)return true;var h=false;this.each(function(m){if(m==j){h=true;throw $break;}});return h}function f(){return this.map()}return{each:function(j,h){var m=0;try{this._each(function(v){j.call(h,v,m++)})}catch(r){if(r!=$break)throw r;}return this},eachSlice:function(j,h,m){var r=-j,v=[],z=this.toArray();if(j<1)return z;for(;(r+=j)<z.length;)v.push(z.slice(r,r+j));return v.collect(h,m)},all:a,every:a,
any:b,some:b,collect:c,map:c,detect:d,findAll:e,select:e,filter:e,grep:function(j,h,m){h=h||Prototype.K;var r=[];if(Object.isString(j))j=new RegExp(RegExp.escape(j));this.each(function(v,z){j.match(v)&&r.push(h.call(m,v,z))});return r},include:i,member:i,inGroupsOf:function(j,h){h=Object.isUndefined(h)?null:h;return this.eachSlice(j,function(m){for(;m.length<j;)m.push(h);return m})},inject:function(j,h,m){this.each(function(r,v){j=h.call(m,j,r,v)});return j},invoke:function(j){var h=$A(arguments).slice(1);
return this.map(function(m){return m[j].apply(m,h)})},max:function(j,h){j=j||Prototype.K;var m;this.each(function(r,v){r=j.call(h,r,v);if(m==null||r>=m)m=r});return m},min:function(j,h){j=j||Prototype.K;var m;this.each(function(r,v){r=j.call(h,r,v);if(m==null||r<m)m=r});return m},partition:function(j,h){j=j||Prototype.K;var m=[],r=[];this.each(function(v,z){(j.call(h,v,z)?m:r).push(v)});return[m,r]},pluck:function(j){var h=[];this.each(function(m){h.push(m[j])});return h},reject:function(j,h){var m=
[];this.each(function(r,v){j.call(h,r,v)||m.push(r)});return m},sortBy:function(j,h){return this.map(function(m,r){return{value:m,criteria:j.call(h,m,r)}}).sort(function(m,r){var v=m.criteria,z=r.criteria;return v<z?-1:v>z?1:0}).pluck("value")},toArray:f,entries:f,zip:function(){var j=Prototype.K,h=$A(arguments);if(Object.isFunction(h.last()))j=h.pop();var m=[this].concat(h).map($A);return this.map(function(r,v){return j(m.pluck(v))})},size:function(){return this.toArray().length},inspect:function(){return"#<Enumerable:"+
this.toArray().inspect()+">"},find:d}}();function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=new Array(b);b--;)c[b]=a[b];return c}function $w(a){if(!Object.isString(a))return[];return(a=a.strip())?a.split(/\s+/):[]}Array.from=$A;
(function(){function a(h){for(var m=0,r=this.length;m<r;m++)h(this[m])}function b(){return f.call(this,0)}function c(h,m){m||(m=0);var r=this.length;if(m<0)m=r+m;for(;m<r;m++)if(this[m]===h)return m;return-1}function d(h,m){m=isNaN(m)?this.length:(m<0?this.length+m:m)+1;var r=this.slice(0,m).reverse().indexOf(h);return r<0?r:m-r-1}function e(){for(var h=f.call(this,0),m,r=0,v=arguments.length;r<v;r++){m=arguments[r];if(Object.isArray(m)&&!("callee"in m))for(var z=0,w=m.length;z<w;z++)h.push(m[z]);
else h.push(m)}return h}var i=Array.prototype,f=i.slice,j=i.forEach;j||(j=a);Object.extend(i,Enumerable);if(!i._reverse)i._reverse=i.reverse;Object.extend(i,{_each:j,clear:function(){this.length=0;return this},first:function(){return this[0]},last:function(){return this[this.length-1]},compact:function(){return this.select(function(h){return h!=null})},flatten:function(){return this.inject([],function(h,m){if(Object.isArray(m))return h.concat(m.flatten());h.push(m);return h})},without:function(){var h=
f.call(arguments,0);return this.select(function(m){return!h.include(m)})},reverse:function(h){return(h===false?this.toArray():this)._reverse()},uniq:function(h){return this.inject([],function(m,r,v){if(0==v||(h?m.last()!=r:!m.include(r)))m.push(r);return m})},intersect:function(h){return this.uniq().findAll(function(m){return h.detect(function(r){return m===r})})},clone:b,toArray:b,size:function(){return this.length},inspect:function(){return"["+this.map(Object.inspect).join(", ")+"]"}});if(function(){return[].concat(arguments)[0][0]!==
1}(1,2))i.concat=e;if(!i.indexOf)i.indexOf=c;if(!i.lastIndexOf)i.lastIndexOf=d})();function $H(a){return new Hash(a)}
var Hash=Class.create(Enumerable,function(){function a(){return Object.clone(this._object)}function b(c,d){if(Object.isUndefined(d))return c;return c+"="+encodeURIComponent(String.interpret(d))}return{initialize:function(c){this._object=Object.isHash(c)?c.toObject():Object.clone(c)},_each:function(c){for(var d in this._object){var e=this._object[d],i=[d,e];i.key=d;i.value=e;c(i)}},set:function(c,d){return this._object[c]=d},get:function(c){if(this._object[c]!==Object.prototype[c])return this._object[c]},
unset:function(c){var d=this._object[c];delete this._object[c];return d},toObject:a,toTemplateReplacements:a,keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},index:function(c){var d=this.detect(function(e){return e.value===c});return d&&d.key},merge:function(c){return this.clone().update(c)},update:function(c){return(new Hash(c)).inject(this,function(d,e){d.set(e.key,e.value);return d})},toQueryString:function(){return this.inject([],function(c,d){var e=encodeURIComponent(d.key),
i=d.value;if(i&&typeof i=="object"){if(Object.isArray(i))return c.concat(i.map(b.curry(e)))}else c.push(b(e,i));return c}).join("&")},inspect:function(){return"#<Hash:{"+this.map(function(c){return c.map(Object.inspect).join(": ")}).join(", ")+"}>"},toJSON:a,clone:function(){return new Hash(this)}}}());Hash.from=$H;
Object.extend(Number.prototype,function(){return{toColorPart:function(){return this.toPaddedString(2,16)},succ:function(){return this+1},times:function(a,b){$R(0,this,true).each(a,b);return this},toPaddedString:function(a,b){var c=this.toString(b||10);return"0".times(a-c.length)+c},abs:function(){return Math.abs(this)},round:function(){return Math.round(this)},ceil:function(){return Math.ceil(this)},floor:function(){return Math.floor(this)}}}());function $R(a,b,c){return new ObjectRange(a,b,c)}
var ObjectRange=Class.create(Enumerable,function(){return{initialize:function(a,b,c){this.start=a;this.end=b;this.exclusive=c},_each:function(a){for(var b=this.start;this.include(b);){a(b);b=b.succ()}},include:function(a){if(a<this.start)return false;if(this.exclusive)return a<this.end;return a<=this.end}}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||
false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,d){this.each(function(e){if(Object.isFunction(e[a]))try{e[a].apply(e,[b,c,d])}catch(i){}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});
Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});
Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,c){$super(c);this.transport=Ajax.getTransport();this.request(b)},request:function(a){this.url=a;this.method=this.options.method;a=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!["get","post"].include(this.method)){a+=(a?"&":"")+"_method="+this.method;this.method="post"}if(a)if(this.method=="get")this.url+=(this.url.include("?")?"&":"?")+a;else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))a+=
"&_=";this.parameters=a.toQueryParams();try{var b=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(b);Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||a:null;this.transport.send(this.body);!this.options.asynchronous&&
this.transport.overrideMimeType&&this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&!(a==4&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){a["Content-type"]=this.options.contentType+(this.options.encoding?
"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)a.Connection="close"}if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(Object.isFunction(b.push))for(var c=0,d=b.length;c<d;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(i){a[i.key]=i.value})}for(var e in a)this.transport.setRequestHeader(e,a[e])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300},getStatus:function(){try{return this.transport.status||
0}catch(a){return 0}},respondToReadyState:function(a){a=Ajax.Request.Events[a];var b=new Ajax.Response(this);if(a=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(c){this.dispatchException(c)}var d=b.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&d&&d.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+
a]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+a,this,b,b.headerJSON)}catch(e){this.dispatchException(e)}if(a=="Complete")this.transport.onreadystatechange=Prototype.emptyFunction},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)||
null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(a){this.dispatchException(a)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Response=Class.create({initialize:function(a){this.request=a;a=this.transport=a.transport;var b=this.readyState=a.readyState;if(b>2&&!Prototype.Browser.IE||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(a.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){a=a.responseXML;this.responseXML=Object.isUndefined(a)?null:a;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,
getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||
!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});
Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,c,d){this.container={success:b.success||b,failure:b.failure||(b.success?null:b)};d=Object.clone(d);var e=d.onComplete;d.onComplete=function(i,f){this.updateContent(i.responseText);Object.isFunction(e)&&e(i,f)}.bind(this);$super(c,d)},updateContent:function(a){var b=this.container[this.success()?"success":"failure"],c=this.options;c.evalScripts||(a=a.stripScripts());if(b=$(b))if(c.insertion)if(Object.isString(c.insertion)){var d=
{};d[c.insertion]=a;b.insert(d)}else c.insertion(b,a);else b.update(a)}});
Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,c,d){$super(d);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=b;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},
updateComplete:function(a){if(this.options.decay){this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});
function $(a){if(arguments.length>1){for(var b=0,c=[],d=arguments.length;b<d;b++)c.push($(arguments[b]));return c}if(Object.isString(a))a=document.getElementById(a);return Element.extend(a)}if(Prototype.BrowserFeatures.XPath)document._getElementsByXPath=function(a,b){for(var c=[],d=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),e=0,i=d.snapshotLength;e<i;e++)c.push(Element.extend(d.snapshotItem(e)));return c};if(!Node)var Node={};
Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});
(function(a){var b=function(){try{var d=document.createElement('<input name="x">');return d.tagName.toLowerCase()==="input"&&d.name==="x"}catch(e){return false}}(),c=a.Element;a.Element=function(d,e){e=e||{};d=d.toLowerCase();var i=Element.cache;if(b&&e.name){d="<"+d+' name="'+e.name+'">';delete e.name;return Element.writeAttribute(document.createElement(d),e)}i[d]||(i[d]=Element.extend(document.createElement(d)));return Element.writeAttribute(i[d].cloneNode(false),e)};Object.extend(a.Element,c||
{});if(c)a.Element.prototype=c.prototype})(this);Element.idCounter=1;Element.cache={};function purgeElement(a){var b=a._prototypeUID;if(b){Element.stopObserving(a);a._prototypeUID=void 0;delete Element.Storage[b]}}
Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(){var a=function(){var d=document.createElement("select"),e=true;d.innerHTML='<option value="test">test</option>';if(d.options&&d.options[0])e=d.options[0].nodeName.toUpperCase()!==
"OPTION";return e}(),b=function(){try{var d=document.createElement("table");if(d&&d.tBodies){d.innerHTML="<tbody><tr><td>test</td></tr></tbody>";return typeof d.tBodies[0]=="undefined"}}catch(e){return true}}(),c=function(){var d=document.createElement("script"),e=false;try{d.appendChild(document.createTextNode(""));e=!d.firstChild||d.firstChild&&d.firstChild.nodeType!==3}catch(i){e=true}return e}();return function(d,e){d=$(d);for(var i=d.getElementsByTagName("*"),f=i.length;f--;)purgeElement(i[f]);
if(e&&e.toElement)e=e.toElement();if(Object.isElement(e))return d.update().insert(e);e=Object.toHTML(e);i=d.tagName.toUpperCase();if(i==="SCRIPT"&&c){d.text=e;return d}if(a||b)if(i in Element._insertionTranslations.tags){for(;d.firstChild;)d.removeChild(d.firstChild);Element._getContentFromAnonymousElement(i,e.stripScripts()).each(function(j){d.appendChild(j)})}else d.innerHTML=e.stripScripts();else d.innerHTML=e.stripScripts();e.evalScripts.bind(e).defer();return d}}(),replace:function(a,b){a=$(a);
if(b&&b.toElement)b=b.toElement();else if(!Object.isElement(b)){b=Object.toHTML(b);var c=a.ownerDocument.createRange();c.selectNode(a);b.evalScripts.bind(b).defer();b=c.createContextualFragment(b.stripScripts())}a.parentNode.replaceChild(b,a);return a},insert:function(a,b){a=$(a);if(Object.isString(b)||Object.isNumber(b)||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,d,e;for(var i in b){c=b[i];i=i.toLowerCase();d=Element._insertionTranslations[i];if(c&&c.toElement)c=c.toElement();
if(Object.isElement(c))d(a,c);else{c=Object.toHTML(c);e=(i=="before"||i=="after"?a.parentNode:a).tagName.toUpperCase();e=Element._getContentFromAnonymousElement(e,c.stripScripts());if(i=="top"||i=="after")e.reverse();e.each(d.curry(a));c.evalScripts.bind(c).defer()}}return a},wrap:function(a,b,c){a=$(a);if(Object.isElement(b))$(b).writeAttribute(c||{});else b=Object.isString(b)?new Element(b,c):new Element("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b},inspect:function(a){a=
$(a);var b="<"+a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var d=c.first();c=c.last();if(d=(a[d]||"").toString())b+=" "+c+"="+d.inspect(true)});return b+">"},recursivelyCollect:function(a,b,c){a=$(a);c=c||-1;for(var d=[];a=a[b];){a.nodeType==1&&d.push(Element.extend(a));if(d.length==c)break}return d},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){for(a=$(a).firstChild;a&&
a.nodeType!=1;)a=a.nextSibling;return $(a)},immediateDescendants:function(a){var b=[];for(a=$(a).firstChild;a;){a.nodeType===1&&b.push(Element.extend(a));a=a.nextSibling}return b},previousSiblings:function(a){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(a,b){a=$(a);if(Object.isString(b))return Prototype.Selector.match(a,
b);return b.match(a)},up:function(a,b,c){a=$(a);if(arguments.length==1)return $(a.parentNode);var d=Element.ancestors(a);return Object.isNumber(b)?d[b]:Prototype.Selector.find(d,b,c)},down:function(a,b,c){a=$(a);if(arguments.length==1)return Element.firstDescendant(a);return Object.isNumber(b)?Element.descendants(a)[b]:Element.select(a,b)[c||0]},previous:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);return b?Prototype.Selector.find(a.previousSiblings(),b,c):a.recursivelyCollect("previousSibling",
c+1)[c]},next:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);if(b)return Prototype.Selector.find(a.nextSiblings(),b,c);else{Object.isNumber(c);return a.recursivelyCollect("nextSibling",c+1)[c]}},select:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a)},adjacent:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a.parentNode).without(a)},identify:function(a){a=
$(a);var b=Element.readAttribute(a,"id");if(b)return b;do b="anonymous_element_"+Element.idCounter++;while($(b));Element.writeAttribute(a,"id",b);return b},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){var c=Element._attributeTranslations.read;if(c.values[b])return c.values[b](a,b);if(c.names[b])b=c.names[b];if(b.include(":"))return!a.attributes||!a.attributes[b]?null:a.attributes[b].value}return a.getAttribute(b)},writeAttribute:function(a,b,c){a=$(a);var d={},e=Element._attributeTranslations.write;
if(typeof b=="object")d=b;else d[b]=Object.isUndefined(c)?true:c;for(var i in d){b=e.names[i]||i;c=d[i];if(e.values[i])b=e.values[i](a,c);if(c===false||c===null)a.removeAttribute(b);else c===true?a.setAttribute(b,b):a.setAttribute(b,c)}return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(a=$(a)){var c=a.className;return c.length>0&&(c==
b||(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(c))}},addClassName:function(a,b){if(a=$(a)){Element.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b);return a}},removeClassName:function(a,b){if(a=$(a)){a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a}},toggleClassName:function(a,b){if(a=$(a))return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(a){a=$(a);for(var b=a.firstChild;b;){var c=b.nextSibling;b.nodeType==
3&&!/\S/.test(b.nodeValue)&&a.removeChild(b);b=c}return a},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(a,b){a=$(a);b=$(b);if(a.compareDocumentPosition)return(a.compareDocumentPosition(b)&8)===8;if(b.contains)return b.contains(a)&&b!==a;for(;a=a.parentNode;)if(a==b)return true;return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a);b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];
if(!c||c=="auto")c=(c=document.defaultView.getComputedStyle(a,null))?c[b]:null;if(b=="opacity")return c?parseFloat(c):1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b){a=$(a);var c=a.style;if(Object.isString(b)){a.style.cssText+=";"+b;return b.include("opacity")?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a}for(var d in b)if(d=="opacity")a.setOpacity(b[d]);else c[d=="float"||d=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":
d]=b[d];return a},setOpacity:function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;return a},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=
$(a);if(a._overflow)return a;a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden")a.style.overflow="hidden";return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},cumulativeOffset:function(a){var b=0,c=0;if(a.parentNode){do{b+=a.offsetTop||0;c+=a.offsetLeft||0;a=a.offsetParent}while(a)}return Element._returnOffset(c,b)},positionedOffset:function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=
a.offsetLeft||0;if(a=a.offsetParent){if(a.tagName.toUpperCase()=="BODY")break;if(Element.getStyle(a,"position")!=="static")break}}while(a);return Element._returnOffset(c,b)},absolutize:function(a){a=$(a);if(Element.getStyle(a,"position")=="absolute")return a;var b=Element.positionedOffset(a),c=b[1];b=b[0];var d=a.clientWidth,e=a.clientHeight;a._originalLeft=b-parseFloat(a.style.left||0);a._originalTop=c-parseFloat(a.style.top||0);a._originalWidth=a.style.width;a._originalHeight=a.style.height;a.style.position=
"absolute";a.style.top=c+"px";a.style.left=b+"px";a.style.width=d+"px";a.style.height=e+"px";return a},relativize:function(a){a=$(a);if(Element.getStyle(a,"position")=="relative")return a;a.style.position="relative";var b=parseFloat(a.style.top||0)-(a._originalTop||0),c=parseFloat(a.style.left||0)-(a._originalLeft||0);a.style.top=b+"px";a.style.left=c+"px";a.style.height=a._originalHeight;a.style.width=a._originalWidth;return a},cumulativeScrollOffset:function(a){var b=0,c=0;do{b+=a.scrollTop||0;
c+=a.scrollLeft||0;a=a.parentNode}while(a);return Element._returnOffset(c,b)},getOffsetParent:function(a){if(a.offsetParent)return $(a.offsetParent);if(a==document.body)return $(a);for(;(a=a.parentNode)&&a!=document.body;)if(Element.getStyle(a,"position")!="static")return $(a);return $(document.body)},viewportOffset:function(a){var b=0,c=0,d=a;do{b+=d.offsetTop||0;c+=d.offsetLeft||0;if(d.offsetParent==document.body&&Element.getStyle(d,"position")=="absolute")break}while(d=d.offsetParent);d=a;do if(!Prototype.Browser.Opera||
d.tagName&&d.tagName.toUpperCase()=="BODY"){b-=d.scrollTop||0;c-=d.scrollLeft||0}while(d=d.parentNode);return Element._returnOffset(c,b)},clonePosition:function(a,b,c){c=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},c||{});b=$(b);var d=Element.viewportOffset(b),e=[0,0],i=null;a=$(a);if(Element.getStyle(a,"position")=="absolute"){i=Element.getOffsetParent(a);e=Element.viewportOffset(i)}if(i==document.body){e[0]-=document.body.offsetLeft;e[1]-=document.body.offsetTop}if(c.setLeft)a.style.left=
d[0]-e[0]+c.offsetLeft+"px";if(c.setTop)a.style.top=d[1]-e[1]+c.offsetTop+"px";if(c.setWidth)a.style.width=b.offsetWidth+"px";if(c.setHeight)a.style.height=b.offsetHeight+"px";return a}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};
if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(a,b,c){switch(c){case "left":case "top":case "right":case "bottom":if(a(b,"position")==="static")return null;case "height":case "width":if(!Element.visible(b))return null;var d=parseInt(a(b,c),10);if(d!==b["offset"+c.capitalize()])return d+"px";return(c==="height"?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"]).inject(d,
function(e,i){var f=a(b,i);return f===null?e:e-parseInt(f,10)})+"px";default:return a(b,c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(a,b,c){if(c==="title")return b.title;return a(b,c)})}else if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(a,b){b=$(b);if(!b.parentNode)return $(document.body);var c=b.getStyle("position");if(c!=="static")return a(b);b.setStyle({position:"relative"});var d=a(b);b.setStyle({position:c});
return d});$w("positionedOffset viewportOffset").each(function(a){Element.Methods[a]=Element.Methods[a].wrap(function(b,c){c=$(c);if(!c.parentNode)return Element._returnOffset(0,0);var d=c.getStyle("position");if(d!=="static")return b(c);var e=c.getOffsetParent();e&&e.getStyle("position")==="fixed"&&e.setStyle({zoom:1});c.setStyle({position:"relative"});e=b(c);c.setStyle({position:d});return e})});Element.Methods.getStyle=function(a,b){a=$(a);b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();
var c=a.style[b];if(!c&&a.currentStyle)c=a.currentStyle[b];if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!="none")return a["offset"+b.capitalize()]+"px";return null}return c};Element.Methods.setOpacity=function(a,b){a=$(a);var c=a.currentStyle;if(c&&!c.hasLayout||!c&&a.style.zoom=="normal")a.style.zoom=1;c=a.getStyle("filter");var d=a.style;if(b==1||b===""){(c=
c.replace(/alpha\([^\)]*\)/gi,""))?(d.filter=c):d.removeAttribute("filter");return a}else if(b<1.0E-5)b=0;d.filter=c.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+b*100+")";return a};Element._attributeTranslations=function(){var a="className",b="for",c=document.createElement("div");c.setAttribute(a,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x")a="class"}c=null;c=document.createElement("label");c.setAttribute(b,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");
if(c.htmlFor==="x")b="htmlFor"}c=null;return{read:{names:{"class":a,className:a,"for":b,htmlFor:b},values:{_getAttr:function(d,e){return d.getAttribute(e)},_getAttr2:function(d,e){return d.getAttribute(e,2)},_getAttrNode:function(d,e){var i=d.getAttributeNode(e);return i?i.value:""},_getEv:function(){var d=document.createElement("div"),e;d.onclick=Prototype.emptyFunction;d=d.getAttribute("onclick");if(String(d).indexOf("{")>-1)e=function(i,f){f=i.getAttribute(f);if(!f)return null;f=f.toString();f=
f.split("{")[1];f=f.split("}")[0];return f.strip()};else if(d==="")e=function(i,f){f=i.getAttribute(f);if(!f)return null;return f.strip()};d=null;return e}(),_flag:function(d,e){return $(d).hasAttribute(e)?e:null},style:function(d){return d.style.cssText.toLowerCase()},title:function(d){return d.title}}}}}();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=
!!b},style:function(a,b){a.style.cssText=b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,
onunload:a._getEv,onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);Prototype.BrowserFeatures.ElementExtensions&&function(){Element.Methods.down=function(a,b,c){a=$(a);if(arguments.length==1)return a.firstDescendant();
var d;if(Object.isNumber(b)){d=a.getElementsByTagName("*");for(var e=[],i=0,f;f=d[i];i++)f.tagName!=="!"&&e.push(f);d=e[b]}else d=Element.select(a,b)[c||0];return d}}()}else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent))Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1?0.999999:b===""?"":b<1.0E-5?0:b;return a};else if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;if(b==1)if(a.tagName.toUpperCase()==
"IMG"&&a.width){a.width++;a.width--}else try{var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(d){}return a};Element.Methods.cumulativeOffset=function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=a.offsetLeft||0;if(a.offsetParent==document.body)if(Element.getStyle(a,"position")=="absolute")break;a=a.offsetParent}while(a);return Element._returnOffset(c,b)}}
if("outerHTML"in document.documentElement)Element.Methods.replace=function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();if(Object.isElement(b)){a.parentNode.replaceChild(b,a);return a}b=Object.toHTML(b);var c=a.parentNode,d=c.tagName.toUpperCase();if(Element._insertionTranslations.tags[d]){var e=a.next();d=Element._getContentFromAnonymousElement(d,b.stripScripts());c.removeChild(a);e?d.each(function(i){c.insertBefore(i,e)}):d.each(function(i){c.appendChild(i)})}else a.outerHTML=b.stripScripts();
b.evalScripts.bind(b).defer();return a};Element._returnOffset=function(a,b){var c=[a,b];c.left=a;c.top=b;return c};Element._getContentFromAnonymousElement=function(a,b){var c=new Element("div"),d=Element._insertionTranslations.tags[a];if(d){c.innerHTML=d[0]+b+d[1];for(d=d[2];d--;)c=c.firstChild}else c.innerHTML=b;return $A(c.childNodes)};
Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};
(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,b){b=Element._attributeTranslations.has[b]||b;var c=$(a).getAttributeNode(b);return!!(c&&c.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);
(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}})(document.createElement("div"));
Element.extend=function(){function a(e,i){for(var f in i){var j=i[f];if(Object.isFunction(j)&&!(f in e))e[f]=j.methodize()}}var b=function(e){if(typeof window.Element!="undefined"){var i=window.Element.prototype;if(i){var f="_"+(Math.random()+"").slice(2);e=document.createElement(e);i[f]="x";e=e[f]!=="x";delete i[f];return e}}return false}("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(b)return function(e){if(e&&typeof e._extendedByPrototype=="undefined"){var i=e.tagName;if(i&&
/^(?:object|applet|embed)$/i.test(i)){a(e,Element.Methods);a(e,Element.Methods.Simulated);a(e,Element.Methods.ByTag[i.toUpperCase()])}}return e};return Prototype.K}var c={},d=Element.Methods.ByTag;b=Object.extend(function(e){if(!e||typeof e._extendedByPrototype!="undefined"||e.nodeType!=1||e==window)return e;var i=Object.clone(c),f=e.tagName.toUpperCase();d[f]&&Object.extend(i,d[f]);a(e,i);e._extendedByPrototype=Prototype.emptyFunction;return e},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(c,
Element.Methods);Object.extend(c,Element.Methods.Simulated)}}});b.refresh();return b}();Element.hasAttribute=document.documentElement.hasAttribute?function(a,b){return a.hasAttribute(b)}:Element.Methods.Simulated.hasAttribute;
Element.addMethods=function(a){function b(h){h=h.toUpperCase();Element.Methods.ByTag[h]||(Element.Methods.ByTag[h]={});Object.extend(Element.Methods.ByTag[h],a)}function c(h,m,r){r=r||false;for(var v in h){var z=h[v];if(Object.isFunction(z))if(!r||!(v in m))m[v]=z.methodize()}}function d(h){var m,r={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",
Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(r[h])m="HTML"+r[h]+"Element";if(window[m])return window[m];m="HTML"+h+"Element";if(window[m])return window[m];m="HTML"+h.capitalize()+"Element";if(window[m])return window[m];h=document.createElement(h);return h.__proto__||h.constructor.prototype}
var e=Prototype.BrowserFeatures,i=Element.Methods.ByTag;if(!a){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var f=a;a=arguments[1]}if(f)Object.isArray(f)?f.each(b):b(f);else Object.extend(Element.Methods,a||{});f=window.HTMLElement?HTMLElement.prototype:
Element.prototype;if(e.ElementExtensions){c(Element.Methods,f);c(Element.Methods.Simulated,f,true)}if(e.SpecificElementExtensions)for(var j in Element.Methods.ByTag){e=d(j);Object.isUndefined(e)||c(i[j],e.prototype)}Object.extend(Element,Element.Methods);delete Element.ByTag;Element.extend.refresh&&Element.extend.refresh();Element.cache={}};
document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};
(function(a){function b(){if(d.WebKit&&!e.evaluate)return document;if(d.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}function c(j){i||(i=b());f[j]="client"+j;a["get"+j]=function(){return i[f[j]]};return a["get"+j]()}var d=Prototype.Browser,e=document,i,f={};a.getWidth=c.curry("Width");a.getHeight=c.curry("Height")})(document.viewport);Element.Storage={UID:1};
Element.addMethods({getStorage:function(a){if(a=$(a)){if(a===window)a=0;else{if(typeof a._prototypeUID==="undefined")a._prototypeUID=Element.Storage.UID++;a=a._prototypeUID}Element.Storage[a]||(Element.Storage[a]=$H());return Element.Storage[a]}},store:function(a,b,c){if(a=$(a)){arguments.length===2?Element.getStorage(a).update(b):Element.getStorage(a).set(b,c);return a}},retrieve:function(a,b,c){if(a=$(a)){a=Element.getStorage(a);var d=a.get(b);if(Object.isUndefined(d)){a.set(b,c);d=c}return d}},
clone:function(a,b){if(a=$(a)){var c=a.cloneNode(b);c._prototypeUID=void 0;if(b)for(var d=Element.select(c,"*"),e=d.length;e--;)d[e]._prototypeUID=void 0;return Element.extend(c)}},purge:function(a){if(a=$(a)){purgeElement(a);a=a.getElementsByTagName("*");for(var b=a.length;b--;)purgeElement(a[b]);return null}}});
(function(){function a(f,j){if(Object.isElement(f)){element=f;f=element.getStyle(j)}if(f===null)return null;if(/^(?:-)?\d+(\.\d+)?(px)?$/i.test(f))return window.parseFloat(f);if(/\d/.test(f)&&element.runtimeStyle){var h=element.style.left,m=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=f||0;f=element.style.pixelLeft;element.style.left=h;element.runtimeStyle.left=m;return f}if(f.include("%")){m=(m=f.match(/^(\d+)%?$/i))?Number(m[1])/100:null;if(j.include("left")||
j.include("right")||j.include("width"))h=$(element.parentNode).measure("width");else if(j.include("top")||j.include("bottom")||j.include("height"))h=$(element.parentNode).measure("height");return h*m}return 0}function b(f){if(e(f))return $(document.body);if(Element.getStyle(f,"display")!=="inline"&&f.offsetParent)return $(f.offsetParent);if(f===document.body)return $(f);for(;(f=f.parentNode)&&f!==document.body;)if(Element.getStyle(f,"position")!=="static")return f.nodeName==="HTML"?$(document.body):
$(f);return $(document.body)}function c(f){var j=f.getLayout(),h=0,m=0;do{h+=f.offsetTop||0;m+=f.offsetLeft||0;if(f=f.offsetParent){if(f.nodeName.toUpperCase()==="BODY")break;if(Element.getStyle(f,"position")!=="static")break}}while(f);m-=j.get("margin-top");h-=j.get("margin-left");return new Element.Offset(m,h)}function d(f){var j=0,h=0,m=document.body,r=f;do{j+=r.offsetTop||0;h+=r.offsetLeft||0;if(r.offsetParent==m&&Element.getStyle(r,"position")=="absolute")break}while(r=r.offsetParent);r=f;do if(r!=
m){j-=r.scrollTop||0;h-=r.scrollLeft||0}while(r=r.parentNode);return new Element.Offset(h,j)}function e(f){return f!==document.body&&!Element.descendantOf(f,document.body)}var i=Prototype.K;if("currentStyle"in document.documentElement)i=function(f){if(!f.currentStyle.hasLayout)f.style.zoom=1;return f};Element.Layout=Class.create(Hash,{initialize:function($super,j,h){$super();this.element=$(j);Element.Layout.PROPERTIES.each(function(m){this._set(m,null)},this);if(h){this._preComputing=true;this._begin();
Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(f,j){return Hash.prototype.set.call(this,f,j)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,j){var h=$super(j);return h===null?this._compute(j):h},_begin:function(){if(!this._prepared){var f=this.element,j;a:{for(j=f;j&&j.parentNode;){if(j.getStyle("display")==="none"){j=false;break a}j=$(j.parentNode)}j=true}if(!j){f.store("prototype_original_styles",
{position:f.style.position||"",width:f.style.width||"",visibility:f.style.visibility||"",display:f.style.display||""});j=f.getStyle("position");var h=f.getStyle("width");f.setStyle({position:"absolute",visibility:"hidden",display:"block"});var m=f.getStyle("width");j=h&&m===h?a(h):h&&(j==="absolute"||j==="fixed")?a(h):$(f.parentNode).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");
f.setStyle({width:j+"px"})}this._prepared=true}},_end:function(){var f=this.element,j=f.retrieve("prototype_original_styles");f.store("prototype_original_styles",null);f.setStyle(j);this._prepared=false},_compute:function(f){var j=Element.Layout.COMPUTATIONS;if(!(f in j))throw"Property not found.";return this._set(f,j[f].call(this,this.element))},toObject:function(){var f=$A(arguments),j={};(f.length===0?Element.Layout.PROPERTIES:f.join(" ").split(" ")).each(function(h){if(Element.Layout.PROPERTIES.include(h)){var m=
this.get(h);if(m!=null)j[h]=m}},this);return j},toHash:function(){var f=this.toObject.apply(this,arguments);return new Hash(f)},toCSS:function(){var f=$A(arguments),j={};(f.length===0?Element.Layout.PROPERTIES:f.join(" ").split(" ")).each(function(h){if(Element.Layout.PROPERTIES.include(h))if(!Element.Layout.COMPOSITE_PROPERTIES.include(h)){var m=this.get(h);if(m!=null){h=h;if(h.include("border"))h+="-width";h=h.camelize();j[h]=m+"px"}}},this);return j},inspect:function(){return"#<Element.Layout>"}});
Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(){this._preComputing||
this._begin();var f=this.get("border-box-height");if(f<=0)return 0;var j=this.get("border-top"),h=this.get("border-bottom"),m=this.get("padding-top"),r=this.get("padding-bottom");this._preComputing||this._end();return f-j-h-m-r},width:function(){this._preComputing||this._begin();var f=this.get("border-box-width");if(f<=0)return 0;var j=this.get("border-left"),h=this.get("border-right"),m=this.get("padding-left"),r=this.get("padding-right");this._preComputing||this._end();return f-j-h-m-r},"padding-box-height":function(){var f=
this.get("height"),j=this.get("padding-top"),h=this.get("padding-bottom");return f+j+h},"padding-box-width":function(){var f=this.get("width"),j=this.get("padding-left"),h=this.get("padding-right");return f+j+h},"border-box-height":function(f){return f.offsetHeight},"border-box-width":function(f){return f.offsetWidth},"margin-box-height":function(){var f=this.get("border-box-height"),j=this.get("margin-top"),h=this.get("margin-bottom");if(f<=0)return 0;return f+j+h},"margin-box-width":function(){var f=
this.get("border-box-width"),j=this.get("margin-left"),h=this.get("margin-right");if(f<=0)return 0;return f+j+h},top:function(f){return f.positionedOffset().top},bottom:function(f){var j=f.positionedOffset();f=f.getOffsetParent().measure("height");var h=this.get("border-box-height");return f-h-j.top},left:function(f){return f.positionedOffset().left},right:function(f){var j=f.positionedOffset();f=f.getOffsetParent().measure("width");var h=this.get("border-box-width");return f-h-j.left},"padding-top":function(f){return a(f,
"paddingTop")},"padding-bottom":function(f){return a(f,"paddingBottom")},"padding-left":function(f){return a(f,"paddingLeft")},"padding-right":function(f){return a(f,"paddingRight")},"border-top":function(f){return Object.isNumber(f.clientTop)?f.clientTop:a(f,"borderTopWidth")},"border-bottom":function(f){return Object.isNumber(f.clientBottom)?f.clientBottom:a(f,"borderBottomWidth")},"border-left":function(f){return Object.isNumber(f.clientLeft)?f.clientLeft:a(f,"borderLeftWidth")},"border-right":function(f){return Object.isNumber(f.clientRight)?
f.clientRight:a(f,"borderRightWidth")},"margin-top":function(f){return a(f,"marginTop")},"margin-bottom":function(f){return a(f,"marginBottom")},"margin-left":function(f){return a(f,"marginLeft")},"margin-right":function(f){return a(f,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(f){var j=i(f.getOffsetParent());f=f.getBoundingClientRect();return(j.getBoundingClientRect().right-f.right).round()},bottom:function(f){var j=
i(f.getOffsetParent());f=f.getBoundingClientRect();return(j.getBoundingClientRect().bottom-f.bottom).round()}});Element.Offset=Class.create({initialize:function(f,j){this.left=f.round();this.top=j.round();this[0]=this.left;this[1]=this.top},relativeTo:function(f){return new Element.Offset(this.left-f.left,this.top-f.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,
this.top]}});Element.addMethods({getLayout:function(f,j){return new Element.Layout(f,j)},measure:function(f,j){return $(f).getLayout().get(j)},getDimensions:function(f){f=$(f).getLayout();return{width:f.get("width"),height:f.get("height")}},getOffsetParent:b,cumulativeOffset:function(f){var j=0,h=0;do{j+=f.offsetTop||0;h+=f.offsetLeft||0;f=f.offsetParent}while(f);return new Element.Offset(h,j)},positionedOffset:c,cumulativeScrollOffset:function(f){var j=0,h=0;do{j+=f.scrollTop||0;h+=f.scrollLeft||
0;f=f.parentNode}while(f);return new Element.Offset(h,j)},viewportOffset:d,absolutize:function(f){f=$(f);if(Element.getStyle(f,"position")==="absolute")return f;var j=b(f),h=f.viewportOffset();j=j.viewportOffset();h=h.relativeTo(j);j=f.getLayout();f.store("prototype_absolutize_original_styles",{left:f.getStyle("left"),top:f.getStyle("top"),width:f.getStyle("width"),height:f.getStyle("height")});f.setStyle({position:"absolute",top:h.top+"px",left:h.left+"px",width:j.get("width")+"px",height:j.get("height")+
"px"});return f},relativize:function(f){f=$(f);if(Element.getStyle(f,"position")==="relative")return f;var j=f.retrieve("prototype_absolutize_original_styles");j&&f.setStyle(j);return f}});"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(f){f=$(f);if(e(f))return new Element.Offset(0,0);f=f.getBoundingClientRect();var j=document.documentElement;return new Element.Offset(f.left-j.clientLeft,f.top-j.clientTop)},positionedOffset:function(f){f=$(f);var j=
f.getOffsetParent();if(e(f))return new Element.Offset(0,0);if(f.offsetParent&&f.offsetParent.nodeName.toUpperCase()==="HTML")return c(f);var h=f.viewportOffset();j=j.nodeName.toUpperCase()==="BODY"?d(j):j.viewportOffset();h=h.relativeTo(j);j=f.getLayout();f=h.top-j.get("margin-top");h=h.left-j.get("margin-left");return new Element.Offset(h,f)}})})();window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};
Prototype.Selector=function(){function a(c){for(var d=0,e=c.length;d<e;d++)Element.extend(c[d]);return c}var b=Prototype.K;return{select:function(){throw new Error('Method "Prototype.Selector.select" must be defined.');},match:function(){throw new Error('Method "Prototype.Selector.match" must be defined.');},find:function(c,d,e){e=e||0;var i=Prototype.Selector.match,f=c.length,j=0,h;for(h=0;h<f;h++)if(i(c[h],d)&&e==j++)return Element.extend(c[h])},extendElements:Element.extend===b?b:a,extendElement:Element.extend}}();
Prototype._original_property=window.Sizzle;
(function(){function a(l,g,o,n,q,p){q=0;for(var s=n.length;q<s;q++){var u=n[q];if(u){if(l=="previousSibling"&&!p&&u.nodeType===1){u.sizcache=o;u.sizset=q}u=u[l];for(var x=false;u;){if(u.sizcache===o){x=n[u.sizset];break}if(u.nodeType===1&&!p){u.sizcache=o;u.sizset=q}if(u.nodeName===g){x=u;break}u=u[l]}n[q]=x}}}function b(l,g,o,n,q,p){q=0;for(var s=n.length;q<s;q++){var u=n[q];if(u){if(l=="previousSibling"&&!p&&u.nodeType===1){u.sizcache=o;u.sizset=q}u=u[l];for(var x=false;u;){if(u.sizcache===o){x=
n[u.sizset];break}if(u.nodeType===1){if(!p){u.sizcache=o;u.sizset=q}if(typeof g!=="string"){if(u===g){x=true;break}}else if(j.filter(g,[u]).length>0){x=u;break}}u=u[l]}n[q]=x}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,e=Object.prototype.toString,i=false,f=true;[0,0].sort(function(){f=false;return 0});var j=function(l,g,o,n){o=o||[];var q=g=g||document;if(g.nodeType!==1&&g.nodeType!==9)return[];if(!l||
typeof l!=="string")return o;for(var p=[],s,u,x,C,D=true,G=B(g),F=l;(c.exec(""),s=c.exec(F))!==null;){F=s[3];p.push(s[1]);if(s[2]){C=s[3];break}}if(p.length>1&&m.exec(l))if(p.length===2&&h.relative[p[0]])u=A(p[0]+p[1],g);else for(u=h.relative[p[0]]?[g]:j(p.shift(),g);p.length;){l=p.shift();if(h.relative[l])l+=p.shift();u=A(l,u)}else{if(!n&&p.length>1&&g.nodeType===9&&!G&&h.match.ID.test(p[0])&&!h.match.ID.test(p[p.length-1])){s=j.find(p.shift(),g,G);g=s.expr?j.filter(s.expr,s.set)[0]:s.set[0]}if(g){s=
n?{expr:p.pop(),set:v(n)}:j.find(p.pop(),p.length===1&&(p[0]==="~"||p[0]==="+")&&g.parentNode?g.parentNode:g,G);u=s.expr?j.filter(s.expr,s.set):s.set;if(p.length>0)x=v(u);else D=false;for(;p.length;){var E=p.pop();s=E;if(h.relative[E])s=p.pop();else E="";if(s==null)s=g;h.relative[E](x,s,G)}}else x=[]}x||(x=u);if(!x)throw"Syntax error, unrecognized expression: "+(E||l);if(e.call(x)==="[object Array]")if(D)if(g&&g.nodeType===1)for(l=0;x[l]!=null;l++){if(x[l]&&(x[l]===true||x[l].nodeType===1&&y(g,x[l])))o.push(u[l])}else for(l=
0;x[l]!=null;l++)x[l]&&x[l].nodeType===1&&o.push(u[l]);else o.push.apply(o,x);else v(x,o);if(C){j(C,q,o,n);j.uniqueSort(o)}return o};j.uniqueSort=function(l){if(w){i=f;l.sort(w);if(i)for(var g=1;g<l.length;g++)l[g]===l[g-1]&&l.splice(g--,1)}return l};j.matches=function(l,g){return j(l,null,null,g)};j.find=function(l,g,o){var n,q;if(!l)return[];for(var p=0,s=h.order.length;p<s;p++){var u=h.order[p];if(q=h.leftMatch[u].exec(l)){var x=q[1];q.splice(1,1);if(x.substr(x.length-1)!=="\\"){q[1]=(q[1]||"").replace(/\\/g,
"");n=h.find[u](q,g,o);if(n!=null){l=l.replace(h.match[u],"");break}}}}n||(n=g.getElementsByTagName("*"));return{set:n,expr:l}};j.filter=function(l,g,o,n){for(var q=l,p=[],s=g,u,x,C=g&&g[0]&&B(g[0]);l&&g.length;){for(var D in h.filter)if((u=h.match[D].exec(l))!=null){var G=h.filter[D],F,E;x=false;if(s==p)p=[];if(h.preFilter[D])if(u=h.preFilter[D](u,s,o,p,n,C)){if(u===true)continue}else x=F=true;if(u)for(var H=0;(E=s[H])!=null;H++)if(E){F=G(E,u,H,s);var I=n^!!F;if(o&&F!=null)if(I)x=true;else s[H]=
false;else if(I){p.push(E);x=true}}if(F!==undefined){o||(s=p);l=l.replace(h.match[D],"");if(!x)return[];break}}if(l==q)if(x==null)throw"Syntax error, unrecognized expression: "+l;else break;q=l}return s};var h=j.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,
CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(l){return l.getAttribute("href")}},relative:{"+":function(l,g,o){var n=typeof g==="string",q=n&&!/\W/.test(g);n=n&&!q;if(q&&!o)g=g.toUpperCase();o=0;q=l.length;for(var p;o<q;o++)if(p=l[o]){for(;(p=p.previousSibling)&&
p.nodeType!==1;);l[o]=n||p&&p.nodeName===g?p||false:p===g}n&&j.filter(g,l,true)},">":function(l,g,o){var n=typeof g==="string";if(n&&!/\W/.test(g)){g=o?g:g.toUpperCase();o=0;for(var q=l.length;o<q;o++){var p=l[o];if(p){n=p.parentNode;l[o]=n.nodeName===g?n:false}}}else{o=0;for(q=l.length;o<q;o++)if(p=l[o])l[o]=n?p.parentNode:p.parentNode===g;n&&j.filter(g,l,true)}},"":function(l,g,o){var n=d++,q=b;if(!/\W/.test(g)){var p=g=o?g:g.toUpperCase();q=a}q("parentNode",g,n,l,p,o)},"~":function(l,g,o){var n=
d++,q=b;if(typeof g==="string"&&!/\W/.test(g)){var p=g=o?g:g.toUpperCase();q=a}q("previousSibling",g,n,l,p,o)}},find:{ID:function(l,g,o){if(typeof g.getElementById!=="undefined"&&!o)return(l=g.getElementById(l[1]))?[l]:[]},NAME:function(l,g){if(typeof g.getElementsByName!=="undefined"){for(var o=[],n=g.getElementsByName(l[1]),q=0,p=n.length;q<p;q++)n[q].getAttribute("name")===l[1]&&o.push(n[q]);return o.length===0?null:o}},TAG:function(l,g){return g.getElementsByTagName(l[1])}},preFilter:{CLASS:function(l,
g,o,n,q,p){l=" "+l[1].replace(/\\/g,"")+" ";if(p)return l;p=0;for(var s;(s=g[p])!=null;p++)if(s)if(q^(s.className&&(" "+s.className+" ").indexOf(l)>=0))o||n.push(s);else if(o)g[p]=false;return false},ID:function(l){return l[1].replace(/\\/g,"")},TAG:function(l,g){for(var o=0;g[o]===false;o++);return g[o]&&B(g[o])?l[1]:l[1].toUpperCase()},CHILD:function(l){if(l[1]=="nth"){var g=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(l[2]=="even"&&"2n"||l[2]=="odd"&&"2n+1"||!/\D/.test(l[2])&&"0n+"+l[2]||l[2]);l[2]=g[1]+(g[2]||
1)-0;l[3]=g[3]-0}l[0]=d++;return l},ATTR:function(l,g,o,n,q,p){g=l[1].replace(/\\/g,"");if(!p&&h.attrMap[g])l[1]=h.attrMap[g];if(l[2]==="~=")l[4]=" "+l[4]+" ";return l},PSEUDO:function(l,g,o,n,q){if(l[1]==="not")if((c.exec(l[3])||"").length>1||/^\w/.test(l[3]))l[3]=j(l[3],null,null,g);else{l=j.filter(l[3],g,o,true^q);o||n.push.apply(n,l);return false}else if(h.match.POS.test(l[0])||h.match.CHILD.test(l[0]))return true;return l},POS:function(l){l.unshift(true);return l}},filters:{enabled:function(l){return l.disabled===
false&&l.type!=="hidden"},disabled:function(l){return l.disabled===true},checked:function(l){return l.checked===true},selected:function(l){return l.selected===true},parent:function(l){return!!l.firstChild},empty:function(l){return!l.firstChild},has:function(l,g,o){return!!j(o[3],l).length},header:function(l){return/h\d/i.test(l.nodeName)},text:function(l){return"text"===l.type},radio:function(l){return"radio"===l.type},checkbox:function(l){return"checkbox"===l.type},file:function(l){return"file"===
l.type},password:function(l){return"password"===l.type},submit:function(l){return"submit"===l.type},image:function(l){return"image"===l.type},reset:function(l){return"reset"===l.type},button:function(l){return"button"===l.type||l.nodeName.toUpperCase()==="BUTTON"},input:function(l){return/input|select|textarea|button/i.test(l.nodeName)}},setFilters:{first:function(l,g){return g===0},last:function(l,g,o,n){return g===n.length-1},even:function(l,g){return g%2===0},odd:function(l,g){return g%2===1},
lt:function(l,g,o){return g<o[3]-0},gt:function(l,g,o){return g>o[3]-0},nth:function(l,g,o){return o[3]-0==g},eq:function(l,g,o){return o[3]-0==g}},filter:{PSEUDO:function(l,g,o,n){var q=g[1],p=h.filters[q];if(p)return p(l,o,g,n);else if(q==="contains")return(l.textContent||l.innerText||"").indexOf(g[3])>=0;else if(q==="not"){g=g[3];o=0;for(n=g.length;o<n;o++)if(g[o]===l)return false;return true}},CHILD:function(l,g){var o=g[1],n=l;switch(o){case "only":case "first":for(;n=n.previousSibling;)if(n.nodeType===
1)return false;if(o=="first")return true;n=l;case "last":for(;n=n.nextSibling;)if(n.nodeType===1)return false;return true;case "nth":o=g[2];var q=g[3];if(o==1&&q==0)return true;var p=g[0],s=l.parentNode;if(s&&(s.sizcache!==p||!l.nodeIndex)){var u=0;for(n=s.firstChild;n;n=n.nextSibling)if(n.nodeType===1)n.nodeIndex=++u;s.sizcache=p}n=l.nodeIndex-q;return o==0?n==0:n%o==0&&n/o>=0}},ID:function(l,g){return l.nodeType===1&&l.getAttribute("id")===g},TAG:function(l,g){return g==="*"&&l.nodeType===1||l.nodeName===
g},CLASS:function(l,g){return(" "+(l.className||l.getAttribute("class"))+" ").indexOf(g)>-1},ATTR:function(l,g){var o=g[1];o=h.attrHandle[o]?h.attrHandle[o](l):l[o]!=null?l[o]:l.getAttribute(o);var n=o+"",q=g[2],p=g[4];return o==null?q==="!=":q==="="?n===p:q==="*="?n.indexOf(p)>=0:q==="~="?(" "+n+" ").indexOf(p)>=0:!p?n&&o!==false:q==="!="?n!=p:q==="^="?n.indexOf(p)===0:q==="$="?n.substr(n.length-p.length)===p:q==="|="?n===p||n.substr(0,p.length+1)===p+"-":false},POS:function(l,g,o,n){var q=h.setFilters[g[2]];
if(q)return q(l,o,g,n)}}},m=h.match.POS;for(var r in h.match){h.match[r]=new RegExp(h.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source);h.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+h.match[r].source)}var v=function(l,g){l=Array.prototype.slice.call(l,0);if(g){g.push.apply(g,l);return g}return l};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(z){v=function(l,g){var o=g||[];if(e.call(l)==="[object Array]")Array.prototype.push.apply(o,l);else if(typeof l.length===
"number")for(var n=0,q=l.length;n<q;n++)o.push(l[n]);else for(n=0;l[n];n++)o.push(l[n]);return o}}var w;if(document.documentElement.compareDocumentPosition)w=function(l,g){if(!l.compareDocumentPosition||!g.compareDocumentPosition){if(l==g)i=true;return 0}var o=l.compareDocumentPosition(g)&4?-1:l===g?0:1;if(o===0)i=true;return o};else if("sourceIndex"in document.documentElement)w=function(l,g){if(!l.sourceIndex||!g.sourceIndex){if(l==g)i=true;return 0}var o=l.sourceIndex-g.sourceIndex;if(o===0)i=true;
return o};else if(document.createRange)w=function(l,g){if(!l.ownerDocument||!g.ownerDocument){if(l==g)i=true;return 0}var o=l.ownerDocument.createRange(),n=g.ownerDocument.createRange();o.setStart(l,0);o.setEnd(l,0);n.setStart(g,0);n.setEnd(g,0);o=o.compareBoundaryPoints(Range.START_TO_END,n);if(o===0)i=true;return o};(function(){var l=document.createElement("div"),g="script"+(new Date).getTime();l.innerHTML="<a name='"+g+"'/>";var o=document.documentElement;o.insertBefore(l,o.firstChild);if(document.getElementById(g)){h.find.ID=
function(n,q,p){if(typeof q.getElementById!=="undefined"&&!p)return(q=q.getElementById(n[1]))?q.id===n[1]||typeof q.getAttributeNode!=="undefined"&&q.getAttributeNode("id").nodeValue===n[1]?[q]:undefined:[]};h.filter.ID=function(n,q){var p=typeof n.getAttributeNode!=="undefined"&&n.getAttributeNode("id");return n.nodeType===1&&p&&p.nodeValue===q}}o.removeChild(l);o=l=null})();(function(){var l=document.createElement("div");l.appendChild(document.createComment(""));if(l.getElementsByTagName("*").length>
0)h.find.TAG=function(g,o){var n=o.getElementsByTagName(g[1]);if(g[1]==="*"){for(var q=[],p=0;n[p];p++)n[p].nodeType===1&&q.push(n[p]);n=q}return n};l.innerHTML="<a href='#'></a>";if(l.firstChild&&typeof l.firstChild.getAttribute!=="undefined"&&l.firstChild.getAttribute("href")!=="#")h.attrHandle.href=function(g){return g.getAttribute("href",2)};l=null})();document.querySelectorAll&&function(){var l=j,g=document.createElement("div");g.innerHTML="<p class='TEST'></p>";if(!(g.querySelectorAll&&g.querySelectorAll(".TEST").length===
0)){j=function(n,q,p,s){q=q||document;if(!s&&q.nodeType===9&&!B(q))try{return v(q.querySelectorAll(n),p)}catch(u){}return l(n,q,p,s)};for(var o in l)j[o]=l[o];g=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var l=document.createElement("div");l.innerHTML="<div class='test e'></div><div class='test'></div>";if(l.getElementsByClassName("e").length!==0){l.lastChild.className="e";if(l.getElementsByClassName("e").length!==1){h.order.splice(1,0,"CLASS");
h.find.CLASS=function(g,o,n){if(typeof o.getElementsByClassName!=="undefined"&&!n)return o.getElementsByClassName(g[1])};l=null}}}();var y=document.compareDocumentPosition?function(l,g){return l.compareDocumentPosition(g)&16}:function(l,g){return l!==g&&(l.contains?l.contains(g):true)},B=function(l){return l.nodeType===9&&l.documentElement.nodeName!=="HTML"||!!l.ownerDocument&&l.ownerDocument.documentElement.nodeName!=="HTML"},A=function(l,g){for(var o=[],n="",q,p=g.nodeType?[g]:g;q=h.match.PSEUDO.exec(l);){n+=
q[0];l=l.replace(h.match.PSEUDO,"")}l=h.relative[l]?l+"*":l;q=0;for(var s=p.length;q<s;q++)j(l,p[q],o);return j.filter(n,o)};window.Sizzle=j})();(function(a){var b=Prototype.Selector.extendElements;Prototype.Selector.engine=a;Prototype.Selector.select=function(c,d){return b(a(c,d||document))};Prototype.Selector.match=function(c,d){return a.matches(d,[c]).length==1}})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;
var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,d,e=false,i=b.submit,f,j;if(b.hash){j={};f=function(h,m,r){if(m in h){Object.isArray(h[m])||(h[m]=[h[m]]);h[m].push(r)}else h[m]=r;return h}}else{j="";f=function(h,m,r){return h+(h?"&":"")+encodeURIComponent(m)+"="+encodeURIComponent(r)}}return a.inject(j,function(h,m){if(!m.disabled&&m.name){c=m.name;d=$(m).getValue();if(d!=
null&&m.type!="file"&&(m.type!="submit"||!e&&i!==false&&(!i||c==i)&&(e=true)))h=f(h,c,d)}return h})}};
Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){a=$(a).getElementsByTagName("*");for(var b,c=[],d=Form.Element.Serializers,e=0;b=a[e];e++)c.push(b);return c.inject([],function(i,f){d[f.tagName.toLowerCase()]&&i.push(Element.extend(f));return i})},getInputs:function(a,b,c){a=$(a);a=a.getElementsByTagName("input");if(!b&&!c)return $A(a).map(Element.extend);for(var d=0,e=[],i=a.length;d<i;d++){var f=a[d];b&&f.type!=b||c&&f.name!=c||
e.push(Element.extend(f))}return e},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){a=$(a).getElements().findAll(function(c){return"hidden"!=c.type&&!c.disabled});var b=a.findAll(function(c){return c.hasAttribute("tabIndex")&&c.tabIndex>=0}).sortBy(function(c){return c.tabIndex}).first();return b?b:a.find(function(c){return/^(?:input|select|textarea)$/i.test(c.tagName)})},
focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(a,b){a=$(a);b=Object.clone(b||{});var c=b.parameters,d=a.readAttribute("action")||"";if(d.blank())d=window.location.href;b.parameters=a.serialize(true);if(c){if(Object.isString(c))c=c.toQueryParams();Object.extend(b.parameters,c)}if(a.hasAttribute("method")&&!b.method)b.method=a.method;return new Ajax.Request(d,b)}};
Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};
Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();
if(a.select&&(a.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(a.type)))a.select()}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;
Form.Element.Serializers={input:function(a,b){switch(a.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(a,b);default:return Form.Element.Serializers.textarea(a,b)}},inputSelector:function(a,b){if(Object.isUndefined(b))return a.checked?a.value:null;else a.checked=!!b},textarea:function(a,b){if(Object.isUndefined(b))return a.value;else a.value=b},select:function(a,b){if(Object.isUndefined(b))return this[a.type=="select-one"?"selectOne":"selectMany"](a);
else for(var c,d,e=!Object.isArray(b),i=0,f=a.length;i<f;i++){c=a.options[i];d=this.optionValue(c);if(e){if(d==b){c.selected=true;return}}else c.selected=b.include(d)}},selectOne:function(a){var b=a.selectedIndex;return b>=0?this.optionValue(a.options[b]):null},selectMany:function(a){var b,c=a.length;if(!c)return null;var d=0;for(b=[];d<c;d++){var e=a.options[d];e.selected&&b.push(this.optionValue(e))}return b},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};
Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,c,d){$super(d,c);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});
Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});
Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(a,
"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});
(function(){function a(g){var o=document.documentElement,n=document.body||{scrollLeft:0};return g.pageX||g.clientX+(o.scrollLeft||n.scrollLeft)-(o.clientLeft||0)}function b(g){var o=document.documentElement,n=document.body||{scrollTop:0};return g.pageY||g.clientY+(o.scrollTop||n.scrollTop)-(o.clientTop||0)}function c(g,o,n){var q=Element.retrieve(g,"prototype_event_registry");if(Object.isUndefined(q)){B.push(g);q=Element.retrieve(g,"prototype_event_registry",$H())}var p=q.get(o);if(Object.isUndefined(p)){p=
[];q.set(o,p)}if(p.pluck("handler").include(n))return false;var s;if(o.include(":"))s=function(u){if(Object.isUndefined(u.eventName))return false;if(u.eventName!==o)return false;h.extend(u,g);n.call(g,u)};else if(!r&&(o==="mouseenter"||o==="mouseleave")){if(o==="mouseenter"||o==="mouseleave")s=function(u){h.extend(u,g);for(var x=u.relatedTarget;x&&x!==g;)try{x=x.parentNode}catch(C){x=g}x!==g&&n.call(g,u)}}else s=function(u){h.extend(u,g);n.call(g,u)};s.handler=n;p.push(s);return s}function d(){for(var g=
0,o=B.length;g<o;g++){h.stopObserving(B[g]);B[g]=null}}function e(g,o,n){g=$(g);n=c(g,o,n);if(!n)return g;if(o.include(":"))if(g.addEventListener)g.addEventListener("dataavailable",n,false);else{g.attachEvent("ondataavailable",n);g.attachEvent("onfilterchange",n)}else{o=A(o);g.addEventListener?g.addEventListener(o,n,false):g.attachEvent("on"+o,n)}return g}function i(g,o,n){g=$(g);var q=Element.retrieve(g,"prototype_event_registry");if(!q)return g;if(!o){q.each(function(x){i(g,x.key)});return g}var p=
q.get(o);if(!p)return g;if(!n){p.each(function(x){i(g,o,x.handler)});return g}var s=p.find(function(x){return x.handler===n});if(!s)return g;if(o.include(":"))if(g.removeEventListener)g.removeEventListener("dataavailable",s,false);else{g.detachEvent("ondataavailable",s);g.detachEvent("onfilterchange",s)}else{var u=A(o);g.removeEventListener?g.removeEventListener(u,s,false):g.detachEvent("on"+u,s)}q.set(o,p.without(s));return g}function f(g,o,n,q){g=$(g);if(Object.isUndefined(q))q=true;if(g==document&&
document.createEvent&&!g.dispatchEvent)g=document.documentElement;var p;if(document.createEvent){p=document.createEvent("HTMLEvents");p.initEvent("dataavailable",true,true)}else{p=document.createEventObject();p.eventType=q?"ondataavailable":"onfilterchange"}p.eventName=o;p.memo=n||{};document.createEvent?g.dispatchEvent(p):g.fireEvent(p.eventType,p);return h.extend(p)}function j(g,o,n,q){g=$(g);if(Object.isFunction(n)&&Object.isUndefined(q)){q=n;n=null}return(new h.Handler(g,o,n,q)).start()}var h=
{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},m=document.documentElement,r="onmouseenter"in m&&"onmouseleave"in m,v;if(Prototype.Browser.IE){var z={0:1,1:4,2:2};v=function(g,o){return g.button===z[o]}}else v=Prototype.Browser.WebKit?function(g,o){switch(o){case 0:return g.which==1&&!g.metaKey;case 1:return g.which==1&&g.metaKey;default:return false}}:function(g,
o){return g.which?g.which===o+1:g.button===o};h.Methods={isLeftClick:function(g){return v(g,0)},isMiddleClick:function(g){return v(g,1)},isRightClick:function(g){return v(g,2)},element:function(g){g=h.extend(g);var o=g.target,n=g.type;if((g=g.currentTarget)&&g.tagName)if(n==="load"||n==="error"||n==="click"&&g.tagName.toLowerCase()==="input"&&g.type==="radio")o=g;if(o.nodeType==Node.TEXT_NODE)o=o.parentNode;return Element.extend(o)},findElement:function(g,o){var n=h.element(g);if(!o)return n;for(;n;){if(Object.isElement(n)&&
Prototype.Selector.match(n,o))return Element.extend(n);n=n.parentNode}},pointer:function(g){return{x:a(g),y:b(g)}},pointerX:a,pointerY:b,stop:function(g){h.extend(g);g.preventDefault();g.stopPropagation();g.stopped=true}};var w=Object.keys(h.Methods).inject({},function(g,o){g[o]=h.Methods[o].methodize();return g});if(Prototype.Browser.IE){var y=function(g){switch(g.type){case "mouseover":g=g.fromElement;break;case "mouseout":g=g.toElement;break;default:return null}return Element.extend(g)};Object.extend(w,
{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});h.extend=function(g,o){if(!g)return false;if(g._extendedByPrototype)return g;g._extendedByPrototype=Prototype.emptyFunction;var n=h.pointer(g);Object.extend(g,{target:g.srcElement||o,relatedTarget:y(g),pageX:n.x,pageY:n.y});return Object.extend(g,w)}}else{h.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(h.prototype,
w);h.extend=Prototype.K}var B=[];Prototype.Browser.IE&&window.attachEvent("onunload",d);Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,false);var A=Prototype.K,l={mouseenter:"mouseover",mouseleave:"mouseout"};r||(A=function(g){return l[g]||g});h.Handler=Class.create({initialize:function(g,o,n,q){this.element=$(g);this.eventName=o;this.selector=n;this.callback=q;this.handler=this.handleEvent.bind(this)},start:function(){h.observe(this.element,this.eventName,this.handler);
return this},stop:function(){h.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(g){var o=g.findElement(this.selector);o&&this.callback.call(this.element,g,o)}});Object.extend(h,h.Methods);Object.extend(h,{fire:f,observe:e,stopObserving:i,on:j});Element.addMethods({fire:f,observe:e,stopObserving:i,on:j});Object.extend(document,{fire:f.methodize(),observe:e.methodize(),stopObserving:i.methodize(),on:j.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,
h);else window.Event=h})();
(function(){function a(){if(!document.loaded){d&&window.clearTimeout(d);document.loaded=true;document.fire("dom:loaded")}}function b(){if(document.readyState==="complete"){document.stopObserving("readystatechange",b);a()}}function c(){try{document.documentElement.doScroll("left")}catch(e){d=c.defer();return}a()}var d;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,false);else{document.observe("readystatechange",b);if(window==top)d=c.defer()}Event.observe(window,"load",
a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;
var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||
document.documentElement.scrollTop||document.body.scrollTop||0},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=Element.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var d=Element.cumulativeScrollOffset(a);this.xcomp=b+d[0]-this.deltaX;this.ycomp=c+d[1]-this.deltaY;this.offset=Element.cumulativeOffset(a);
return this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},
relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(a,b,c){c=c||{};return Element.clonePosition(b,a,c)}};
if(!document.getElementsByClassName)document.getElementsByClassName=function(a){function b(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}a.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,d){d=d.toString().strip();var e=/\s/.test(d)?$w(d).map(b).join(""):b(d);return e?document._getElementsByXPath(".//*"+e,c):[]}:function(c,d){d=d.toString().strip();var e=[],i=/\s/.test(d)?$w(d):null;if(!i&&!d)return e;for(var f=$(c).getElementsByTagName("*"),j=0,h,m;h=
f[j];j++)if(h.className&&(m=" "+h.className+" ")&&(m.include(" "+d+" ")||i&&i.all(function(r){return!r.toString().blank()&&m.include(" "+r+" ")})))e.push(Element.extend(h));return e};return function(c,d){return $(d||document.body).getElementsByClassName(c)}}(Element.Methods);Element.ClassNames=Class.create();
Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){this.include(a)&&this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);
(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(a,b){for(var c=Prototype.Selector.match,d=[],e=0,i=a.length;e<i;e++){var f=a[e];c(f,b)&&d.push(Element.extend(f))}return d},
findElement:function(a,b,c){c=c||0;for(var d=0,e,i=0,f=a.length;i<f;i++){e=a[i];if(Prototype.Selector.match(e,b)&&c===d++)return Element.extend(e)}},findChildElements:function(a,b){var c=b.toArray().join(", ");return Prototype.Selector.select(c,a||document)}})})();
document.observe("dom:loaded",function(){function a(b){var c,d,e;if(b.tagName.toLowerCase()==="form"){c=b.readAttribute("method")||"post";d=b.readAttribute("action");e=b.serialize(true)}else{c=b.readAttribute("data-method")||"get";d=b.readAttribute("href");e={}}if(b.fire("ajax:before").stopped)return false;new Ajax.Request(d,{method:c,parameters:e,asynchronous:true,evalScripts:true,onLoading:function(i){b.fire("ajax:loading",{request:i})},onLoaded:function(i){b.fire("ajax:loaded",{request:i})},onInteractive:function(i){b.fire("ajax:interactive",
{request:i})},onComplete:function(i){b.fire("ajax:complete",{request:i})},onSuccess:function(i){b.fire("ajax:success",{request:i})},onFailure:function(i){b.fire("ajax:failure",{request:i})}});b.fire("ajax:after")}$(document.body).observe("click",function(b){var c=b.findElement().readAttribute("data-confirm");if(c&&!confirm(c)){b.stop();return false}if(c=b.findElement("a[data-remote]")){a(c);b.stop();return true}if(c=b.findElement("a[data-method]")){var d=c,e;e=d.readAttribute("data-method");c=d.readAttribute("href");
csrf_param=$$("meta[name=csrf-param]").first();csrf_token=$$("meta[name=csrf-token]").first();c=new Element("form",{method:"POST",action:c,style:"display: none;"});d.parentNode.appendChild(c);if(e!="post"){d=new Element("input",{type:"hidden",name:"_method",value:e});c.appendChild(d)}if(csrf_param){e=csrf_param.readAttribute("content");d=csrf_token.readAttribute("content");d=new Element("input",{type:"hidden",name:e,value:d});c.appendChild(d)}c.submit();b.stop();return true}});$(document.body).observe("submit",
function(b){var c=b.findElement(),d=c.readAttribute("data-confirm");if(d&&!confirm(d)){b.stop();return false}c.select("input[type=submit][data-disable-with]").each(function(e){e.disabled=true;e.writeAttribute("data-original-value",e.value);e.value=e.readAttribute("data-disable-with")});if(c=b.findElement("form[data-remote]")){a(c);b.stop()}});$(document.body).observe("ajax:after",function(b){b=b.findElement();b.tagName.toLowerCase()==="form"&&b.select("input[type=submit][disabled=true][data-disable-with]").each(function(c){c.value=
c.readAttribute("data-original-value");c.writeAttribute("data-original-value",null);c.disabled=false})})});var S2={Version:"2.0.0_a6",Extensions:{}};Function.prototype.optionize=function(){var a=this,b=a.argumentNames(),c=this.length-1,d=function(){var e=$A(arguments),i=typeof e.last()==="object"?e.pop():{},f=[];if(c>0)f=(e.length>0?e:[null]).inGroupsOf(c).flatten().concat(i);return a.apply(this,f)};d.argumentNames=function(){return b};return d};
Function.ABSTRACT=function(){throw"Abstract method. Implement in subclass.";};Object.extend(Number.prototype,{constrain:function(a,b){var c=a<b?a:b,d=a<b?b:a,e=Number(this);if(e<c)e=c;if(e>d)e=d;return e},nearer:function(a,b){var c=Number(this);return Math.abs(c-a)<Math.abs(c-b)?a:b},tween:function(a,b){return this+(a-this)*b}});Object.propertize=function(a,b){return Object.isString(a)?b[a]:a};
S2.CSS={PROPERTY_MAP:{backgroundColor:"color",borderBottomColor:"color",borderBottomWidth:"length",borderLeftColor:"color",borderLeftWidth:"length",borderRightColor:"color",borderRightWidth:"length",borderSpacing:"length",borderTopColor:"color",borderTopWidth:"length",bottom:"length",color:"color",fontSize:"length",fontWeight:"integer",height:"length",left:"length",letterSpacing:"length",lineHeight:"length",marginBottom:"length",marginLeft:"length",marginRight:"length",marginTop:"length",maxHeight:"length",
maxWidth:"length",minHeight:"length",minWidth:"length",opacity:"number",outlineColor:"color",outlineOffset:"length",outlineWidth:"length",paddingBottom:"length",paddingLeft:"length",paddingRight:"length",paddingTop:"length",right:"length",textIndent:"length",top:"length",width:"length",wordSpacing:"length",zIndex:"integer",zoom:"number"},LENGTH:/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,NUMBER:/([\+-]*\d+\.?\d*)/,__parseStyleElement:document.createElement("div"),parseStyle:function(a){S2.CSS.__parseStyleElement.innerHTML=
'<div style="'+a+'"></div>';var b=S2.CSS.__parseStyleElement.childNodes[0].style,c={};S2.CSS.NUMERIC_PROPERTIES.each(function(d){if(b[d])c[d]=b[d]});S2.CSS.COLOR_PROPERTIES.each(function(d){if(b[d])c[d]=S2.CSS.colorFromString(b[d])});if(Prototype.Browser.IE&&a.include("opacity"))c.opacity=a.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1];return c},normalizeColor:function(a){if(!a||a=="rgba(0, 0, 0, 0)"||a=="transparent")a="#ffffff";a=S2.CSS.colorFromString(a);return[parseInt(a.slice(1,3),16),parseInt(a.slice(3,
5),16),parseInt(a.slice(5,7),16)]},colorFromString:function(a,b){var c="#",d,e;if(a.slice(0,4)=="rgb("){d=a.slice(4,a.length-1).split(",");for(e=3;e--;)c+=parseInt(d[2-e]).toColorPart()}else if(a.slice(0,1)=="#"){if(a.length==4)for(e=1;e<4;e++)c+=(a.charAt(e)+a.charAt(e)).toLowerCase();if(a.length==7)c=a.toLowerCase()}else c=a;return c.length==7?c:b||c},interpolateColor:function(a,b,c){a=S2.CSS.normalizeColor(a);b=S2.CSS.normalizeColor(b);return"#"+[0,1,2].map(function(d){return Math.max(Math.min(a[d].tween(b[d],
c).round(),255),0).toColorPart()}).join("")},interpolateNumber:function(a,b,c){return 1*(a||0).tween(b,c).toFixed(3)},interpolateLength:function(a,b,c){if(!a||parseFloat(a)===0)a="0"+b.gsub(S2.CSS.NUMBER,"");b.scan(S2.CSS.NUMBER,function(d){b=1*d[1]});return a.gsub(S2.CSS.NUMBER,function(d){return(1*parseFloat(d[1]).tween(b,c).toFixed(3)).toString()})},interpolateInteger:function(a,b,c){return parseInt(a).tween(b,c).round()},interpolate:function(a,b,c,d){return S2.CSS["interpolate"+S2.CSS.PROPERTY_MAP[a.camelize()].capitalize()](b,
c,d)},ElementMethods:{getStyles:function(a){var b=document.defaultView.getComputedStyle($(a),null);return S2.CSS.PROPERTIES.inject({},function(c,d){c[d]=b[d];return c})}}};S2.CSS.PROPERTIES=[];for(property in S2.CSS.PROPERTY_MAP)S2.CSS.PROPERTIES.push(property);S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return!a.endsWith("olor")});S2.CSS.COLOR_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return a.endsWith("olor")});
if(!(document.defaultView&&document.defaultView.getComputedStyle))S2.CSS.ElementMethods.getStyles=function(a){a=$(a);var b=a.currentStyle,c;c=S2.CSS.PROPERTIES.inject({},function(d,e){d[e]=b[e];return d});if(!c.opacity)c.opacity=a.getOpacity();return c};Element.addMethods(S2.CSS.ElementMethods);
S2.FX=function(){function a(f){e[(i+=f)>0?"start":"stop"]()}function b(){c.invoke("render",e.getTimestamp())}var c=[],d,e,i=0;return{initialize:function(f){if(!d){c.push(d=new S2.FX.Queue);S2.FX.DefaultOptions.queue=d;e=f||new S2.FX.Heartbeat;document.observe("effect:heartbeat",b).observe("effect:queued",a.curry(1)).observe("effect:dequeued",a.curry(-1))}},getQueues:function(){return c},addQueue:function(f){c.push(f)},getHeartbeat:function(){return e},setHeartbeat:function(f){e=f}}}();
Object.extend(S2.FX,{DefaultOptions:{transition:"sinusoidal",position:"parallel",fps:60,duration:0.2},elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},parseOptions:function(a){if(Object.isNumber(a))a={duration:a};else if(Object.isFunction(a))a={after:a};else if(Object.isString(a))a={duration:a=="slow"?1:a=="fast"?0.1:0.2};return a||{}}});
S2.FX.Base=Class.create({initialize:function(a){S2.FX.initialize();this.updateWithoutWrappers=this.update;a&&a.queue&&!S2.FX.getQueues().include(a.queue)&&S2.FX.addQueue(a.queue);this.setOptions(a);this.duration=this.options.duration*1E3;this.state="idle";["after","before"].each(function(b){this[b]=function(c){c(this);return this}},this)},setOptions:function(a){a=S2.FX.parseOptions(a);if(!this.options){this.options=Object.extend(Object.extend({},S2.FX.DefaultOptions),a);if(a.tween)this.options.transition=
a.tween}if(this.options.beforeUpdate||this.options.afterUpdate)this.update=this.updateWithoutWrappers.wrap(function(b,c){this.options.beforeUpdate&&this.options.beforeUpdate(this,c);b(c);this.options.afterUpdate&&this.options.afterUpdate(this,c)}.bind(this));if(this.options.transition===false)this.options.transition=S2.FX.Transitions.linear;this.options.transition=Object.propertize(this.options.transition,S2.FX.Transitions)},play:function(a){this.setOptions(a);this.frameCount=0;this.options.queue.add(this);
this.maxFrames=this.options.fps*this.duration/1E3;return this},render:function(a){if(a>=this.startsAt){if(this.state=="idle"){this.options.before&&this.options.before(this);this.setup&&this.setup();this.state="running";this.update(this.options.transition(0));this.frameCount++;return this}if(a>=this.endsAt&&this.state!="finished"){this.update(this.options.transition(1));this.teardown&&this.teardown();this.options.after&&this.options.after(this);this.state="finished"}else if(this.state=="running"){a=
1-(this.endsAt-a)/this.duration;if((this.maxFrames*a).floor()>this.frameCount){this.update(this.options.transition(a));this.frameCount++}}}return this},cancel:function(a){if(!this.state!="running"){this.teardown&&this.teardown();a&&this.options.after&&this.options.after(this);this.state="finished"}},finish:function(){if(!this.state!="running"){this.update(this.options.transition(1));this.cancel(true)}},inspect:function(){return"#<S2.FX:"+[this.state,this.startsAt,this.endsAt].inspect()+">"},update:Prototype.emptyFunction});
S2.FX.Element=Class.create(S2.FX.Base,{initialize:function($super,b,c){if(!(this.element=$(b)))throw S2.FX.elementDoesNotExistError;this.operators=[];return $super(c)},animate:function(){var a=$A(arguments),b=a.shift();b=b.charAt(0).toUpperCase()+b.substring(1);this.operators.push(new S2.FX.Operators[b](this,a[0],a[1]||{}))},play:function($super,b,c){if(b)this.element=$(b);return $super(c)},update:function(a){this.operators.invoke("render",a)}});
S2.FX.Heartbeat=Class.create({initialize:function(a){this.options=Object.extend({framerate:Prototype.Browser.MobileSafari?20:60},a);this.beat=this.beat.bind(this)},start:function(){if(!this.heartbeatInterval){this.heartbeatInterval=setInterval(this.beat,1E3/this.options.framerate);this.updateTimestamp()}},stop:function(){if(this.heartbeatInterval){clearInterval(this.heartbeatInterval);this.timestamp=this.heartbeatInterval=null}},beat:function(){this.updateTimestamp();document.fire("effect:heartbeat")},
getTimestamp:function(){return this.timestamp||this.generateTimestamp()},generateTimestamp:function(){return(new Date).getTime()},updateTimestamp:function(){this.timestamp=this.generateTimestamp()}});
S2.FX.Queue=function(){return function(){function a(c){b=b.without(c);delete c;document.fire("effect:dequeued",this);return this}var b=[];Object.extend(this,{getEffects:function(){return b},active:function(){return b.length>0},add:function(c){var d=c.options.position||"parallel",e=S2.FX.getHeartbeat().getTimestamp();if(d=="end")e=b.without(c).pluck("endsAt").max()||e;c.startsAt=e+(c.options.delay||0)*1E3;c.endsAt=c.startsAt+(c.options.duration||1)*1E3;b.push(c);document.fire("effect:queued",this);
return this},remove:a,render:function(c){b.invoke("render",c);b.select(function(d){return d.state=="finished"}).each(a);return this}})}}();S2.FX.Attribute=Class.create(S2.FX.Base,{initialize:function($super,b,c,d,e,i){b=Object.isString(b)?$(b):b;this.method=Object.isFunction(i)?i.bind(b):Object.isFunction(b[i])?b[i].bind(b):function(f){b[i]=f};this.to=d;this.from=c;return $super(e)},update:function(a){this.method(this.from.tween(this.to,a))}});
S2.FX.Style=Class.create(S2.FX.Element,{setup:function(){this.animate("style",this.element,{style:this.options.style})}});S2.FX.Operators={};
S2.FX.Operators.Base=Class.create({initialize:function(a,b,c){this.effect=a;this.object=b;this.options=Object.extend({transition:Prototype.K},c)},inspect:function(){return"#<S2.FX.Operators.Base:"+this.lastValue+">"},setup:function(){},valueAt:function(){},applyValue:function(){},render:function(a){a=this.valueAt(this.options.transition(a));this.applyValue(a);this.lastValue=a}});
S2.FX.Operators.Style=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,d){$super(b,c,d);this.element=$(this.object);this.style=Object.isString(this.options.style)?S2.CSS.parseStyle(this.options.style):this.options.style;this.tweens=[];for(var e in this.style){b=e.underscore().dasherize();c=this.element.getStyle(b);d=this.style[e];if(c!=d)this.tweens.push([b,S2.CSS.interpolate.curry(b,c,d),e in this.options.propertyTransitions?Object.propertize(this.options.propertyTransitions[e],
S2.FX.Transitions):Prototype.K])}},valueAt:function(a){return this.tweens.map(function(b){return b[0]+":"+b[1](b[2](a))}).join(";")},applyValue:function(a){if(this.currentStyle!=a){this.element.setStyle(a);this.currentStyle=a}}});
S2.FX.Morph=Class.create(S2.FX.Element,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style)this.animate("style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||{}})},teardown:function(){this.options.change&&this.teardownWrappers()},setupWrappers:function(){var a=this.element.getStyle("float"),b,c,d,e;this.transitionElement=(new Element("div")).setStyle({position:"relative",overflow:"hidden",
"float":a});this.element.setStyle({"float":"none"}).insert({before:this.transitionElement});this.sourceElementWrapper=this.element.cloneWithoutIDs().wrap("div");this.destinationElementWrapper=this.element.wrap("div");this.transitionElement.insert(this.sourceElementWrapper).insert(this.destinationElementWrapper);a=this.sourceElementWrapper.getHeight();b=this.sourceElementWrapper.getWidth();this.options.change();c=this.destinationElementWrapper.getHeight();d=this.destinationElementWrapper.getWidth();
this.outerWrapper=new Element("div");this.transitionElement.insert({before:this.outerWrapper});this.outerWrapper.setStyle({overflow:"hidden",height:a+"px",width:b+"px"}).appendChild(this.transitionElement);e=Math.max(c,a);maxWidth=Math.max(d,b);this.transitionElement.setStyle({height:a+"px",width:b+"px"});this.sourceElementWrapper.setStyle({position:"absolute",height:e+"px",width:maxWidth+"px",top:0,left:0});this.destinationElementWrapper.setStyle({position:"absolute",height:e+"px",width:maxWidth+
"px",top:0,left:0,opacity:0,zIndex:2E3});this.outerWrapper.insert({before:this.transitionElement}).remove();this.animate("style",this.transitionElement,{style:"height:"+c+"px; width:"+d+"px"});this.animate("style",this.destinationElementWrapper,{style:"opacity: 1.0"})},teardownWrappers:function(){var a=this.destinationElementWrapper.down();a&&this.transitionElement.insert({before:a});this.transitionElement.remove()}});
S2.FX.Parallel=Class.create(S2.FX.Base,{initialize:function($super,b,c){this.effects=b||[];return $super(c||{})},setup:function(){this.effects.invoke("setup")},update:function(a){this.effects.invoke("update",a)}});S2.FX.Operators.Scroll=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,d){$super(b,c,d);this.start=c.scrollTop;this.end=this.options.scrollTo},valueAt:function(a){return this.start+(this.end-this.start)*a},applyValue:function(a){this.object.scrollTop=a.round()}});
S2.FX.Scroll=Class.create(S2.FX.Element,{setup:function(){this.animate("scroll",this.element,{scrollTo:this.options.to})}});
S2.FX.SlideDown=Class.create(S2.FX.Element,{setup:function(){var a=this.destinationElement||this.element,b=a.getLayout();b={height:b.get("height")+"px",paddingTop:b.get("padding-top")+"px",paddingBottom:b.get("padding-bottom")+"px"};a.setStyle({height:"0",paddingTop:"0",paddingBottom:"0",overflow:"hidden"}).show();this.animate("style",a,{style:b,propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"})}});
S2.FX.SlideUp=Class.create(S2.FX.Morph,{setup:function(){var a=this.destinationElement||this.element;a.getLayout();a.setStyle({overflow:"hidden"});this.animate("style",a,{style:{height:"0px",paddingTop:"0px",paddingBottom:"0px"},propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"}).hide()}});
S2.FX.Transitions={linear:Prototype.K,sinusoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5},reverse:function(a){return 1-a},mirror:function(a,b){b=b||S2.FX.Transitions.sinusoidal;return a<0.5?b(a*2):b(1-(a-0.5)*2)},flicker:function(a){a+=(Math.random()-0.5)/5;return S2.FX.Transitions.sinusoidal(a<0?0:a>1?1:a)},wobble:function(a){return-Math.cos(a*Math.PI*9*a)/2+0.5},pulse:function(a,b){return-Math.cos(a*((b||5)-0.5)*2*Math.PI)/2+0.5},blink:function(a,b){return Math.round(a*(b||5))%2},spring:function(a){return 1-
Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},none:Prototype.K.curry(0),full:Prototype.K.curry(1)};
(function(){function a(b,c,d,e,i,f){function j(y,B){var A,l,g,o;g=y;for(l=0;l<8;l++){o=((h*g+m)*g+r)*g-y;if((o>=0?o:0-o)<B)return g;A=(3*h*g+2*m)*g+r;if((A>=0?A:0-A)<1.0E-6)break;g-=o/A}A=0;l=1;g=y;if(g<A)return A;if(g>l)return l;for(;A<l;){o=((h*g+m)*g+r)*g;if((o-y>=0?o-y:0-(o-y))<B)return g;if(y>o)A=g;else l=g;g=(l-A)*0.5+A}return g}var h=0,m=0,r=0,v=0,z=0,w=0;r=3*c;m=3*(e-c)-r;h=1-r-m;w=3*d;z=3*(i-d)-w;v=1-w-z;return function(y,B){var A=j(y,B);return((v*A+z)*A+w)*A}(b,1/(200*f))}S2.FX.cubicBezierTransition=
function(b,c,d,e){return function(i){return a(i,b,c,d,e,1)}}})();S2.FX.Transitions.webkitCubic=S2.FX.cubicBezierTransition(0.25,0.1,0.25,1);S2.FX.Transitions.webkitEaseInOut=S2.FX.cubicBezierTransition(0.42,0,0.58,1);
Object.extend(S2.FX.Transitions,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,3);return 0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,5);return 0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==
0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a==0)return 0;if(a==1)return 1;if((a/=0.5)<1)return 0.5*Math.pow(2,10*(a-1));return 0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=0.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return 0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*
a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;if((a/=0.5)<1)return 0.5*a*a*(((b*=1.525)+1)*a-b);return 0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<
1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*
a+0.984375)},easeFromTo:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}});Prototype.BrowserFeatures.WebkitCSSTransitions=false;S2.Extensions.webkitCSSTransitions=false;
(function(){try{document.createEvent("WebKitTransitionEvent")}catch(a){return}Prototype.BrowserFeatures.WebkitCSSTransitions=true;S2.Extensions.webkitCSSTransitions=true;if(Prototype.BrowserFeatures.WebkitCSSTransitions){$w("webkitBorderTopLeftRadius webkitBorderTopRightRadius webkitBorderBottomLeftRadius webkitBorderBottomRightRadius webkitBackgroundSize").each(function(b){S2.CSS.PROPERTIES.push(b)});S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(b){return!b.endsWith("olor")});S2.FX.Operators.WebkitCssTransition=
Class.create(S2.FX.Operators.Base,{initialize:function($super,c,d,e){$super(c,d,e);this.element=$(this.object);if(Object.isString(this.options.style))if(this.options.style.include(":"))this.style=$H(S2.CSS.parseStyle(this.options.style));else{this.element.addClassName(e.style);this.style=$H(this.element.getStyles());this.element.removeClassName(e.style);var i=this.element.getStyles();this.style=this.style.reject(function(f){return f.value==i[f.key]})}else this.style=$H(this.options.style);this.properties=
[];this.targetStyle="";this.style.each(function(f){var j=f[0].underscore().dasherize();f=f[1];this.element.getStyle(j);if(j.startsWith("webkit"))j="-"+j;this.properties.push(j);this.targetStyle+=";"+j+":"+f},this)},render:function(){this.element.style.webkitTransitionProperty=this.properties.join(",");this.element.style.webkitTransitionDuration=(this.effect.duration/1E3).toFixed(3)+"s";for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===this.effect.options.transition)this.element.style.webkitTransitionTimingFunction=
S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];this.element.setStyle(this.targetStyle);this.render=Prototype.emptyFunction}});S2.FX.Operators.WebkitCssTransition.TIMING_MAP={linear:"linear",sinusoidal:"ease-in-out"};timingFunctionForTransition=function(b){var c=null;for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===b)c=S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];return c};isWebkitCSSTransitionCompatible=function(b){return S2.Extensions.webkitCSSTransitions&&
(b.options.engine||"")!="javascript"&&timingFunctionForTransition(b.options.transition)&&!b.options.propertyTransitions};S2.FX.Morph=Class.create(S2.FX.Morph,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style){this.engine=isWebkitCSSTransitionCompatible(this)?"webkit":"javascript";this.animate(this.engine=="webkit"?"webkitCssTransition":"style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||
{}})}},render:function($super,c){if(this.engine=="webkit"){if(this.options.before)this.element.beforeStartEffect=this.options.before;if(this.options.after){this.element.afterFinishEffect=this.options.after;delete this.options.after}this.element._effect=this}return $super(c)}});Element.addMethods({morph:function(b,c,d){if(Object.isNumber(d))d={duration:d};return b.effect("morph",Object.extend(d,{style:c}))}.optionize()});S2.FX.webkitTransitionStartEvent=document.observe("webkitTransitionStart",function(b){if((b=
b.element())&&b.beforeStartEffect){b.beforeStartEffect();b.beforeStartEffect=null}});S2.FX.webkitTransitionEndEvent=document.observe("webkitTransitionEnd",function(b){var c=b.element();if(c){(function(){c.style.webkitTransitionDuration=""}).defer();if(c.afterFinishEffect){c.afterFinishEffect();c.afterFinishEffect=null}}})}})();
(function(){function a(e,i){if(Object.isElement(e)){element=e;e=element.getStyle(i)}if(e===null)return null;if(/^\d+(px)?$/i.test(e))return window.parseInt(e,10);if(/\d/.test(e)&&element.runtimeStyle){var f=element.style.left,j=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=e||0;e=element.style.pixelLeft;element.style.left=f;element.runtimeStyle.left=j;return e}if(e.include("%")){j=(j=e.match(/^(\d+)%?$/i))?Number(j[1])/100:null;if(i.include("left")||
i.include("right")||i.include("width"))f=$(element.parentNode).measure("width");else if(i.include("top")||i.include("bottom")||i.include("height"))f=$(element.parentNode).measure("height");return f*j}return 0}function b(e){var i=e.getLayout(),f=0,j=0;do{f+=e.offsetTop||0;j+=e.offsetLeft||0;if(e=e.offsetParent){if($w("BODY HTML").include(e.nodeName.toUpperCase()))break;if(Element.getStyle(e,"position")!=="static")break}}while(e);j-=i.get("margin-top");f-=i.get("margin-left");return new Element.Offset(j,
f)}function c(e){var i=0,f=0,j=e;do{i+=j.offsetTop||0;f+=j.offsetLeft||0;if(j.offsetParent==document.body&&Element.getStyle(j,"position")=="absolute")break}while(j=j.offsetParent);j=e;e=j.tagName;var h=Prototype.Browser.Opera;do if(!h||e&&e.toUpperCase()==="BODY"){i-=j.scrollTop||0;f-=j.scrollLeft||0}while(j=j.parentNode);return new Element.Offset(f,i)}var d=Prototype.K;if("currentStyle"in document.documentElement)d=function(e){if(!e.currentStyle.hasLayout)e.style.zoom=1;return e};Element.Layout=
Class.create(Hash,{initialize:function($super,i,f){$super();this.element=$(i);if(f){this._preComputing=true;this._begin()}Element.Layout.PROPERTIES.each(function(j){f?this._compute(j):this._set(j,null)},this);if(f){this._end();this._preComputing=false}},_set:function(e,i){return Hash.prototype.set.call(this,e,i)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,i){var f=$super(i);return f===null?this._compute(i):f},_begin:function(){if(!this._prepared){var e=
this.element,i;a:{for(i=e;i&&i.parentNode;){if(i.getStyle("display")==="none"){i=false;break a}i=$(i.parentNode)}i=true}if(!i){e.store("prototype_original_styles",{position:e.style.position||"",width:e.style.width||"",visibility:e.style.visibility||"",display:e.style.display||""});i=e.getStyle("position");var f=e.getStyle("width");e.setStyle({position:"absolute",visibility:"hidden",display:"block"});var j=e.getStyle("width");i=f&&j===f?window.parseInt(f,10):f&&(i==="absolute"||i==="fixed")?window.parseInt(f,
10):$(e.parentNode).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");e.setStyle({width:i+"px"})}this._prepared=true}},_end:function(){var e=this.element,i=e.retrieve("prototype_original_styles");e.store("prototype_original_styles",null);e.setStyle(i);this._prepared=false},_compute:function(e){var i=Element.Layout.COMPUTATIONS;if(!(e in i))throw"Property not found.";i=i[e].call(this,
this.element);this._set(e,i);return i}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),
COMPUTATIONS:{height:function(){this._preComputing||this._begin();var e=this.get("border-box-height");if(e<=0)return 0;var i=this.get("border-top"),f=this.get("border-bottom"),j=this.get("padding-top"),h=this.get("padding-bottom");this._preComputing||this._end();return e-i-f-j-h},width:function(){this._preComputing||this._begin();var e=this.get("border-box-width");if(e<=0)return 0;var i=this.get("border-left"),f=this.get("border-right"),j=this.get("padding-left"),h=this.get("padding-right");this._preComputing||
this._end();return e-i-f-j-h},"padding-box-height":function(){var e=this.get("height"),i=this.get("padding-top"),f=this.get("padding-bottom");return e+i+f},"padding-box-width":function(){var e=this.get("width"),i=this.get("padding-left"),f=this.get("padding-right");return e+i+f},"border-box-height":function(e){return e.offsetHeight},"border-box-width":function(e){return e.offsetWidth},"margin-box-height":function(){var e=this.get("border-box-height"),i=this.get("margin-top"),f=this.get("margin-bottom");
if(e<=0)return 0;return e+i+f},"margin-box-width":function(){var e=this.get("border-box-width"),i=this.get("margin-left"),f=this.get("margin-right");if(e<=0)return 0;return e+i+f},top:function(e){return e.positionedOffset().top},bottom:function(e){var i=e.positionedOffset();e=e.getOffsetParent().measure("height");var f=this.get("border-box-height");return e-f-i.top},left:function(e){return e.positionedOffset().left},right:function(e){var i=e.positionedOffset();e=e.getOffsetParent().measure("width");
var f=this.get("border-box-width");return e-f-i.left},"padding-top":function(e){return a(e,"paddingTop")},"padding-bottom":function(e){return a(e,"paddingBottom")},"padding-left":function(e){return a(e,"paddingLeft")},"padding-right":function(e){return a(e,"paddingRight")},"border-top":function(e){return Object.isNumber(e.clientTop)?e.clientTop:a(e,"borderTopWidth")},"border-bottom":function(e){return Object.isNumber(e.clientBottom)?e.clientBottom:a(e,"borderBottomWidth")},"border-left":function(e){return Object.isNumber(e.clientLeft)?
e.clientLeft:a(e,"borderLeftWidth")},"border-right":function(e){return Object.isNumber(e.clientRight)?e.clientRight:a(e,"borderRightWidth")},"margin-top":function(e){return a(e,"marginTop")},"margin-bottom":function(e){return a(e,"marginBottom")},"margin-left":function(e){return a(e,"marginLeft")},"margin-right":function(e){return a(e,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(e){var i=d(e.getOffsetParent());e=e.getBoundingClientRect();
return(i.getBoundingClientRect().right-e.right).round()},bottom:function(e){var i=d(e.getOffsetParent());e=e.getBoundingClientRect();return(i.getBoundingClientRect().bottom-e.bottom).round()}});Element.Offset=Class.create({initialize:function(e,i){this.left=e.round();this.top=i.round();this[0]=this.left;this[1]=this.top},relativeTo:function(e){return new Element.Offset(this.left-e.left,this.top-e.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},
toArray:function(){return[this.left,this.top]}});Element.addMethods({getLayout:function(e){return new Element.Layout(e)},measure:function(e,i){return $(e).getLayout().get(i)},cumulativeOffset:function(e){var i=0,f=0;do{i+=e.offsetTop||0;f+=e.offsetLeft||0;e=e.offsetParent}while(e);return new Element.Offset(f,i)},positionedOffset:b,cumulativeScrollOffset:function(e){var i=0,f=0;do{i+=e.scrollTop||0;f+=e.scrollLeft||0;e=e.parentNode}while(e);return new Element.Offset(f,i)},viewportOffset:c});"getBoundingClientRect"in
document.documentElement&&Element.addMethods({viewportOffset:function(e){e=$(e);e=e.getBoundingClientRect();return new Element.Offset(e.left,e.top)},cumulativeOffset:function(e){e=$(e);var i=$(document.documentElement).viewportOffset();return e.viewportOffset().relativeTo(i)},positionedOffset:function(e){e=$(e);var i=e.getOffsetParent();if(i.nodeName.toUpperCase()==="HTML")return b(e);var f=e.viewportOffset();i=$w("BODY HTML").include(i.nodeName.toUpperCase())?c(i):i.viewportOffset();f=f.relativeTo(i);
i=e.getLayout();e=f.top-i.get("margin-top");f=f.left-i.get("margin-left");return new Element.Offset(f,e)}})})();S2.UI={};Object.deepExtend=function(a,b){for(var c in b)if(b[c]&&b[c].constructor&&b[c].constructor===Object){a[c]=a[c]||{};arguments.callee(a[c],b[c])}else a[c]=b[c];return a};S2.UI.Mixin={};
S2.UI.Mixin.Configurable={setOptions:function(a){if(!this.options){this.options={};var b=this.constructor;if(b.superclass){for(var c=[],d=b;d=d.superclass;)c.push(d);c=c.reverse();d=0;for(var e=c.length;d<e;d++)Object.deepExtend(this.options,c[d].DEFAULT_OPTIONS||{})}Object.deepExtend(this.options,b.DEFAULT_OPTIONS||{})}return Object.deepExtend(this.options,a||{})}};
S2.UI.Mixin.Trackable={register:function(){var a=this.constructor;if(!a.instances)a.instances=[];a.instances.include(this)||a.instances.push(this);Object.isFunction(a.onRegister)&&a.onRegister.call(a,this)},unregister:function(){var a=this.constructor;a.instances=a.instances.without(this);Object.isFunction(a.onRegister)&&a.onUnregister.call(a,this)}};
S2.UI.Mixin.Shim={__SHIM_TEMPLATE:new Template("<iframe frameborder='0' tabindex='-1' src='javascript:false;' style='display:block;position:absolute;z-index:-1;overflow:hidden; filter:Alpha(Opacity=\"0\");top:expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px');left:expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px');width:expression(this.parentNode.offsetWidth+'px');height:expression(this.parentNode.offsetHeight+'px');' id='#{0}'></iframe>"),createShim:function(a){if(this.__shim_isie6=
Prototype.Browser.IE&&/6.0/.test(navigator.userAgent))if(a=$(a||this.element)){this.__shimmed=a;var b=a.identify()+"_iframeshim",c=$(b);c&&c.remove();a.insert({top:this.__SHIM_TEMPLATE.evaluate([b])});this.__shim_id=b}},adjustShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id),b=this.__shimmed;a&&a.setStyle({width:b.offsetWidth+"px",height:b.offsetHeight+"px"})}},destroyShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id);
a&&a.remove();this.__shimmed=null}}};
Object.extend(S2.UI,{addClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,d,e=0,i;i=a[e];e++)for(c=0;d=b[c];c++)i.addClassName(d);return a},removeClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,d,e=0,i;i=a[e];e++)for(c=0;d=b[c];c++)i.removeClassName(d)},FOCUSABLE_ELEMENTS:$w("input select textarea button object"),isFocusable:function(a){var b=a.nodeName.toLowerCase(),c=a.readAttribute("tabIndex"),
d=false;d=S2.UI.FOCUSABLE_ELEMENTS.include(b)?!a.disabled:$w("a area").include(b)?a.href||c&&!isNaN(c):c&&!isNaN(c);return!!d&&S2.UI.isVisible(a)},findFocusables:function(a){return $(a).descendants().select(S2.UI.isFocusable)},isVisible:function(a){for(a=$(a);a&&a.parentNode;){var b=a.getStyle("display"),c=a.getStyle("visibility");if(b==="none"||c==="hidden")return false;a=$(a.parentNode)}return true},makeVisible:function(a,b){if(Object.isElement(a))a=[a];for(var c=0,d;d=a[c];c++)d.setStyle({visibility:b?
"visible":"hidden"});return a},modifierUsed:function(a){return a.metaKey||a.ctrlKey||a.altKey}});
(function(){function a(c){var d=Event.element(c);if(d)for(var e=0,i;i=b[e];e++)if(d===i||d.descendantOf(i)){Event.stop(c);break}}var b=[];if(document.attachEvent)document.onselectstart=a.bindAsEventListener(window);else document.observe("mousedown",a);Object.extend(S2.UI,{enableTextSelection:function(c){c.setStyle({"-moz-user-select":"","-webkit-user-select":""});b=b.without(c);return c},disableTextSelection:function(c){c.setStyle({"-moz-user-select":"none","-webkit-user-select":"none"});b.include(c)||
b.push(c);return c}})})();
S2.UI.Behavior=Class.create(S2.UI.Mixin.Configurable,{initialize:function(a,b){this.element=a;this.setOptions(b);Object.extend(this,b);this._observers={};var c,d;for(var e in this)if(e.startsWith("on")||e.include("/on")){c=e.split("/");a=c.length===2?this[c.first()]||this.element:this.element;c=c.last();d=this._observers[c]=this[e].bind(this);a.observe(c.substring(2),d)}},destroy:function(){var a=this.options.proxy||this.element,b;for(var c in this._observers){b=this._observers[c];a.stopObserving(c.substring(2),
b)}}});
Object.extend(S2.UI,{addBehavior:function(a,b,c){var d=arguments.callee;if(Object.isArray(a))a.each(function(i){d(i,b,c)});else if(Object.isArray(b))b.each(function(i){d(a,i,c)});else{var e=new b(a,c||{});$(a).retrieve("ui.behaviors",[]).push(e)}},removeBehavior:function(a,b){var c=arguments.callee;if(Object.isArray(a))a.each(function(j){c(j,b)});else if(Object.isArray(b))b.each(function(j){c(a,j)});else{for(var d=$(a).retrieve("ui.behaviors",[]),e=[],i=0,f;f=d[i];i++)if(!(!f instanceof b)){f.destroy();e.push(f)}$(a).store("ui.behaviors",
d.without(e))}},getBehavior:function(a,b){a=$(a);for(var c=a.retrieve("ui.behaviors",[]),d=0,e=c.length,i;d<e;d++){i=c[d];if(i.constructor===b)return i}return null}});
S2.UI.Behavior.Drag=Class.create(S2.UI.Behavior,{initialize:function($super,b,c){this.__onmousemove=this._onmousemove.bind(this);$super(b,c);this.element.addClassName("ui-draggable")},destroy:function($super){this.element.removeClassName("ui-draggable");$super()},"handle/onmousedown":function(a){var b=this.element;this._startPointer=a.pointer();this._startPosition={left:window.parseInt(b.getStyle("left"),10),top:window.parseInt(b.getStyle("top"),10)};document.observe("mousemove",this.__onmousemove)},
"handle/onmouseup":function(){this._startPosition=this._startPointer=null;document.stopObserving("mousemove",this.__onmousemove)},_onmousemove:function(a){a=a.pointer();if(this._startPointer){a={x:a.x-this._startPointer.x,y:a.y-this._startPointer.y};this.element.setStyle({left:this._startPosition.left+a.x+"px",top:this._startPosition.top+a.y+"px"})}}});
S2.UI.Behavior.Focus=Class.create(S2.UI.Behavior,{onfocus:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-focus")},onblur:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-focus")}});
S2.UI.Behavior.Hover=Class.create(S2.UI.Behavior,{onmouseenter:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-hover")},onmouseleave:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-hover")}});S2.UI.Behavior.Resize=Class.create(S2.UI.Behavior,{initialize:function(){}});
S2.UI.Behavior.Down=Class.create(S2.UI.Behavior,{onmousedown:function(){this._down=true;this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-down")},onmouseup:function(){this._down=false;this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-down")},onmouseleave:function(a){return this.onmouseup(a)},onmouseenter:function(a){if(this._down)return this.onmousedown(a)}});
(function(a){a.Base=Class.create(a.Mixin.Configurable,{NAME:"S2.UI.Base",addObservers:Function.ABSTRACT,removeObservers:Function.ABSTRACT,destroy:function(){this.removeObservers()},toElement:function(){return this.element},inspect:function(){return"#<#{NAME}>".interpolate(this)}})})(S2.UI);Object.extend(Event,{KEY_SPACE:32});
(function(a){a.Accordion=Class.create(a.Base,{NAME:"S2.UI.Accordion",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-accordion ui-widget ui-helper-reset");if(this.element.nodeName.toUpperCase()==="UL"){var e=this.element.childElements().grep(new Selector("li"));a.addClassNames(e,"ui-accordion-li-fix")}this.headers=this.element.select(d.headerSelector);if(!(!this.headers||this.headers.length===0)){a.addClassNames(this.headers,"ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");
a.addBehavior(this.headers,[a.Behavior.Hover,a.Behavior.Focus]);this.content=this.headers.map(function(i){return i.next()});a.addClassNames(this.content,"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");this.headers.each(function(i){var f=new Element("span");a.addClassNames(f,"ui-icon "+d.icons.header);i.insert({top:f})});this._markActive(d.active||this.headers.first(),false);this.element.writeAttribute({role:"tablist","aria-multiselectable":d.multiple.toString()});this.headers.invoke("writeAttribute",
"role","tab");this.content.invoke("writeAttribute","role","tabpanel");this.headers.map(function(i){return i.down("a")}).invoke("observe","click",function(i){i.preventDefault()});this.observers={click:this.click.bind(this),keypress:this.keypress.bind(this)};this.addObservers()}},addObservers:function(){this.headers.invoke("observe","click",this.observers.click);Prototype.Browser.WebKit?this.headers.invoke("observe","keydown",this.observers.keypress):this.headers.invoke("observe","keypress",this.observers.keypress)},
click:function(b){(b=b.findElement(this.options.headerSelector))&&this.headers.include(b)&&this._toggleActive(b)},keypress:function(b){if(!(b.shiftKey||b.metaKey||b.altKey||b.ctrlKey)){var c=b.findElement(this.options.headerSelector);switch(b.keyCode===0?b.charCode:b.keyCode){case Event.KEY_SPACE:this._toggleActive(c);b.stop();return;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusHeader(c,1);b.stop();return;case Event.KEY_UP:case Event.KEY_LEFT:this._focusHeader(c,-1);b.stop();return;case Event.KEY_HOME:this._focusHeader(this.headers.first());
b.stop();return;case Event.KEY_END:this._focusHeader(this.headers.last());b.stop();return}}},_focusHeader:function(b,c){if(Object.isNumber(c)){var d=this.headers.indexOf(b);d+=c;if(d>this.headers.length-1)d=this.headers.length-1;else if(d<0)d=0;b=this.headers[d]}(function(){b.down("a").focus()}).defer()},_toggleActive:function(b){if(b.hasClassName("ui-state-active")){if(this.options.multiple){this._removeActive(b);this._activatePanel(null,b.next(),true)}}else this._markActive(b)},_removeActive:function(b){var c=
this.options;a.removeClassNames(b,"ui-state-active ui-corner-top");a.addClassNames(b,"ui-state-default ui-corner-all");b.writeAttribute("aria-expanded","false");b=b.down(".ui-icon");b.removeClassName(c.icons.headerSelected);b.addClassName(c.icons.header)},_markActive:function(b,c){if(Object.isUndefined(c))c=true;var d=this.options,e=null;if(!d.multiple){e=this.element.down(".ui-accordion-content-active");this.headers.each(this._removeActive.bind(this))}if(b){a.removeClassNames(b,"ui-state-default ui-corner-all");
a.addClassNames(b,"ui-state-active ui-corner-top");b.writeAttribute("aria-expanded","true");this._activatePanel(b.next(),e,c);e=b.down(".ui-icon");e.removeClassName(d.icons.header);e.addClassName(d.icons.headerSelected);return b}},_activatePanel:function(b,c,d){if(d)this.options.transition(b,c);else{c&&c.removeClassName("ui-accordion-content-active");b&&b.addClassName("ui-accordion-content-active")}}});Object.extend(a.Accordion,{DEFAULT_OPTIONS:{multiple:false,headerSelector:"h3",icons:{header:"ui-icon-triangle-1-e",
headerSelected:"ui-icon-triangle-1-s"},transition:function(b,c){var d=[],e;if(c){e=new S2.FX.SlideUp(c,{duration:0.2,after:function(){c.removeClassName("ui-accordion-content-active")}});d.push(e)}if(b){e=new S2.FX.SlideDown(b,{duration:0.2,before:function(){b.addClassName("ui-accordion-content-active")}});d.push(e)}d.invoke("play")}}})})(S2.UI);
(function(a){a.Button=Class.create(a.Base,{NAME:"S2.UI.Button",initialize:function(b,c){this.element=$(b);this.element.store("ui.button",this);var d=this.setOptions(c);a.addClassNames(this.element,"ui-state-default ui-corner-all");a.addBehavior(this.element,[a.Behavior.Hover,a.Behavior.Focus,a.Behavior.Down]);d.primary&&this.element.addClassName("ui-priority-primary");this.element.writeAttribute("role","button");this.enabled=true;this.setEnabled(this.element.disabled===true||!this.element.hasClassName("ui-state-disabled"))},
setEnabled:function(b){if(this.enabled!==b){(this.enabled=b)?this.element.removeClassName("ui-state-disabled"):this.element.addClassName("ui-state-disabled");this.element.disabled=!b}},toElement:function(){return this.element},toHTML:function(){return this.element.toHTML()},toString:function(){return this.element.toHTML()},inspect:function(){return this.element.inspect()}});Object.extend(a.Button,{DEFAULT_OPTIONS:{primary:false}})})(S2.UI);
(function(a){a.Tabs=Class.create(a.Base,{NAME:"S2.UI.Tabs",initialize:function(b,c){this.element=$(b);a.addClassNames(this.element,"ui-widget ui-widget-content ui-tabs ui-corner-all");this.setOptions(c);var d=this.options;this.anchors=[];this.panels=[];this.list=this.element.down("ul");this.list.cleanWhitespace();this.nav=this.list;a.addClassNames(this.nav,"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.tabs=this.list.select("li");a.addClassNames(this.tabs,"ui-state-default ui-corner-top");
a.addBehavior(this.tabs,[a.Behavior.Hover,a.Behavior.Down]);this.element.writeAttribute({role:"tablist","aria-multiselectable":"false"});this.tabs.each(function(f){var j=f.down("a");if(j){var h=j.readAttribute("href");if(h.include("#")){h=h.split("#").last();h=$(h);f.writeAttribute("tabIndex","0");if(h){h.store("ui.tab",f);f.store("ui.panel",h);this.anchors.push(j);this.panels.push(h)}}}},this);this.anchors.invoke("writeAttribute","role","tab");this.panels.invoke("writeAttribute","role","tabpanel");
this.tabs.first().addClassName("ui-position-first");this.tabs.last().addClassName("ui-position-last");a.addClassNames(this.panels,"ui-tabs-panel ui-tabs-hide ui-widget-content ui-corner-bottom");this.observers={onKeyPress:this.onKeyPress.bind(this),onTabClick:this.onTabClick.bind(this)};this.addObservers();var e=window.location.hash.substring(1),i;e.empty()||(i=$(e));this.setSelectedTab(i&&this.panels.include(i)?i.retrieve("ui.tab"):d.selectedTab?$(d.selectedTab):this.tabs.first())},addObservers:function(){this.anchors.invoke("observe",
"click",this.observers.onTabClick);this.tabs.invoke("observe","keypress",this.observers.onKeyPress)},_setSelected:function(b){b=$(b);var c=b.retrieve("ui.tab"),d=this.list.down(".ui-tabs-selected"),e=d?d.retrieve("ui.panel"):null;a.removeClassNames(this.tabs,"ui-tabs-selected ui-state-active");a.addClassNames(this.tabs,"ui-state-default");c.removeClassName("ui-state-default").addClassName("ui-tabs-selected ui-state-active");this.element.fire("ui:tabs:change",{from:{tab:d,panel:e},to:{tab:c,panel:b}});
this.options.panel.transition(e,b)},setSelectedTab:function(b){this.setSelectedPanel(b.retrieve("ui.panel"))},setSelectedPanel:function(b){this._setSelected(b.readAttribute("id"))},onTabClick:function(b){b.stop();b.findElement("a");this.setSelectedTab(b.findElement("li"))},onKeyPress:function(b){if(!a.modifierUsed(b)){var c=b.findElement("li");switch(b.keyCode||b.charCode){case Event.KEY_SPACE:case Event.KEY_RETURN:this.setSelectedTab(c);b.stop();return;case Event.KEY_UP:case Event.KEY_LEFT:this._focusTab(c,
-1);return;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusTab(c,1);return}}},_focusTab:function(b,c){if(Object.isNumber(c)){var d=this.tabs.indexOf(b);d+=c;if(d>this.tabs.length-1)d=this.tabs.length-1;else if(d<0)d=0;b=this.tabs[d]}(function(){b.focus()}).defer()}});Object.extend(a.Tabs,{DEFAULT_OPTIONS:{panel:{transition:function(b,c){b&&b.addClassName("ui-tabs-hide");c.removeClassName("ui-tabs-hide")}}}})})(S2.UI);
(function(a){a.Overlay=Class.create(a.Base,a.Mixin.Trackable,a.Mixin.Shim,{NAME:"S2.UI.Overlay",initialize:function(b){this.setOptions(b);this.element=new Element("div",{"class":"ui-widget-overlay"});this.register();this.createShim();this.adjustShim();this.constructor.onResize()},destroy:function(){this.element.remove();this.unregister()},toElement:function(){return this.element}});Object.extend(a.Overlay,{onRegister:function(){if(this.instances.length===1){this._resizeObserver=this._resizeObserver||
this.onResize.bind(this);Event.observe(window,"resize",this._resizeObserver);Event.observe(window,"scroll",this._resizeObserver)}},onUnregister:function(){if(this.instances.length===0){Event.stopObserving(window,"resize",this._resizeObserver);Event.stopObserving(window,"scroll",this._resizeObserver)}},onResize:function(){var b=document.viewport.getDimensions(),c=document.viewport.getScrollOffsets();this.instances.each(function(d){d.element.setStyle({width:b.width+"px",height:b.height+"px",left:c.left+
"px",top:c.top+"px"})});(function(){this.instances.invoke("adjustShim")}).bind(this).defer()}})})(S2.UI);
(function(a){a.Dialog=Class.create(a.Base,{NAME:"S2.UI.Dialog",initialize:function(b,c){if(Object.isElement(b))b=$(b);else{c=b;b=null}var d=this.setOptions(c);this.element=b||new Element("div");a.addClassNames(this.element,"ui-dialog ui-widget ui-widget-content ui-corner-all");this.element.hide().setStyle({position:"absolute",overflow:"hidden",zIndex:d.zIndex,outline:"0"});this.element.writeAttribute({tabIndex:"-1",role:"dialog"});this.content=d.content?Object.isElement(d.content)?d.content:(new Element("div")).update(d.content):
new Element("div");a.addClassNames(this.content,"ui-dialog-content ui-widget-content");this.element.insert(this.content);this.titleBar=this.options.titleBar||new Element("div");a.addClassNames(this.titleBar,"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix");this.element.insert({top:this.titleBar});this.closeButton=new Element("a",{href:"#"});a.addClassNames(this.closeButton,"ui-dialog-titlebar-close ui-corner-all");new a.Button(this.closeButton);this.closeButton.observe("mousedown",
Event.stop);this.closeButton.observe("click",function(e){e.stop();this.close(false)}.bind(this));this.titleBar.insert(this.closeButton);this.closeText=new Element("span");a.addClassNames(this.closeText,"ui-icon ui-icon-closethick");this.closeButton.insert(this.closeText);this.titleText=new Element("span",{"class":"ui-dialog-title"});this.titleText.update(this.options.title).identify();this.element.writeAttribute("aria-labelledby",this.titleText.readAttribute("id"));this.titleBar.insert({top:this.titleText});
a.disableTextSelection(this.element);this.options.draggable&&a.addBehavior(this.element,a.Behavior.Drag,{handle:this.titleBar});(d=this.options.buttons)&&d.length&&this._createButtons();this.observers={keypress:this.keypress.bind(this)}},toElement:function(){return this.element},_createButtons:function(){var b=this.options.buttons;this.buttonPane&&this.buttonPane.remove();this.buttonPane=new Element("div");a.addClassNames(this.buttonPane,"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");
b.each(function(c){var d=new Element("button",{type:"button"});a.addClassNames(d,"ui-state-default ui-corner-all");c.primary&&d.addClassName("ui-priority-primary");c.secondary&&d.addClassName("ui-priority-secondary");d.update(c.label);new a.Button(d);d.observe("click",c.action.bind(this,this));this.buttonPane.insert(d)},this);this.element.insert(this.buttonPane)},_position:function(){var b=document.viewport.getDimensions(),c=this.element;c={width:parseInt(c.getStyle("width"),10),height:parseInt(c.getStyle("height"),
10)};b={left:(b.width/2-c.width/2).round(),top:(b.height/2-c.height/2).round()};c=document.viewport.getScrollOffsets();b.left+=c.left;b.top+=c.top;this.element.setStyle({left:b.left+"px",top:b.top+"px"})},open:function(){if(!this._isOpen)if(!this.element.fire("ui:dialog:before:open",{dialog:this}).stopped){var b=this.options;this.overlay=b.modal?new a.Overlay:null;$(document.body).insert(this.overlay);$(document.body).insert(this.element);this.element.show();this._position();this.focusables=a.findFocusables(this.element);
b.submitForms||this.content.select("form").invoke("observe","submit",Event.stop);var c=this.focusables.without(this.closeButton),d=b.focus;b=false;if(d==="first"){c.first().focus();b=true}else if(d==="last"){c.last().focus();b=true}else if(Object.isElement(d)){d.focus();b=true}else if(this.buttonPane)if(d=this.buttonPane.down(".ui-priority-primary")){d.focus();b=true}!b&&c.length>0&&c.first().focus();Event.observe(window,"keydown",this.observers.keypress);this._isOpen=true;this.element.fire("ui:dialog:after:open",
{dialog:this});return this}},close:function(b){b=!!b;if(!this.element.fire("ui:dialog:before:close",{dialog:this}).stopped){this.overlay&&this.overlay.destroy();this.element.hide();this._isOpen=false;Event.stopObserving(window,"keydown",this.observers.keypress);b={dialog:this,success:b};var c=this.content.down("form");c&&Object.extend(b,{form:c.serialize({hash:true})});this.element.fire("ui:dialog:after:close",b);a.enableTextSelection(this.element,true);return this}},keypress:function(b){if(!a.modifierUsed(b)){var c=
this.focusables,d=this.options;if(b.keyCode===Event.KEY_ESC)d.closeOnEscape&&this.close(false);else if(b.keyCode===Event.KEY_RETURN)this.close(true);else if(b.keyCode===Event.KEY_TAB)if(this.options.modal)if(c){var e;d=b.findElement();d=c.indexOf(d);if(e=d===-1?c.first():b.shiftKey?d===0?c.last():c[d-1]:d===c.length-1?c.first():c[d+1]){b.stop();(function(){e.focus()}).defer()}}}}});Object.extend(a.Dialog,{DEFAULT_OPTIONS:{zIndex:1E3,title:"Dialog",content:null,modal:true,focus:"auto",submitForms:false,
closeOnEscape:true,draggable:true,resizable:false,buttons:[{label:"OK",primary:true,action:function(b){b.close(true)}}]}})})(S2.UI);
(function(a){a.Slider=Class.create(a.Base,{NAME:"S2.UI.Slider",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-slider ui-widget ui-widget-content ui-corner-all");this.orientation=d.orientation;this.element.addClassName("ui-slider-"+this.orientation);this._computeTrackLength();var e=d.value.initial;Object.isArray(e)||(e=[e]);this.values=e;this.handles=[];this.values.each(function(f,j){var h=new Element("a",{href:"#"});h.store("ui.slider.handle",
j);this.handles.push(h);this.element.insert(h)},this);a.addClassNames(this.handles,"ui-slider-handle ui-state-default ui-corner-all");this.handles.invoke("writeAttribute","tabIndex","0");this.activeHandle=this.handles.first();this.handles.invoke("observe","click",Event.stop);a.addBehavior(this.handles,[a.Behavior.Hover,a.Behavior.Focus]);this.observers={focus:this.focus.bind(this),blur:this.blur.bind(this),keydown:this.keydown.bind(this),keyup:this.keyup.bind(this),mousedown:this.mousedown.bind(this),
mouseup:this.mouseup.bind(this),mousemove:this.mousemove.bind(this),rangeMouseDown:this.rangeMouseDown.bind(this),rangeMouseMove:this.rangeMouseMove.bind(this),rangeMouseUp:this.rangeMouseUp.bind(this)};e=d.value;if(e.step!==null){this._possibleValues=[];for(var i=e.min;i<e.max;i+=e.step)this._possibleValues.push(i);this._possibleValues.push(e.max);this.keyboardStep=e.step}else if(d.possibleValues){this._possibleValues=d.possibleValues.clone();this.keyboardStep=null}else this.keyboardStep=(e.max-
e.min)/100;this.range=null;if(d.range&&this.values.length===2){this.restricted=true;this.range=new Element("div",{"class":"ui-slider-range"});this.element.insert(this.range);this.range.addClassName("ui-widget-header")}this._computeTrackLength();this._computeHandleLength();this.disabled=this.dragging=this.active=false;this.addObservers();this.values.each(this.setValue,this);this.initialized=true},addObservers:function(){this.element.observe("mousedown",this.observers.mousedown);this.range&&this.range.observe("mousedown",
this.observers.rangeMouseDown);this.handles.invoke("observe","keydown",this.observers.keydown);this.handles.invoke("observe","keyup",this.observers.keyup)},_computeTrackLength:function(){var b;if(this.orientation==="vertical"){b=this.element.offsetHeight;b=b!==0?b:window.parseInt(this.element.getStyle("height"),10)}else{b=this.element.offsetWidth;b=b!==0?b:window.parseInt(this.element.getStyle("width"),10)}return this._trackLength=b},_computeHandleLength:function(){var b=this.handles.first(),c;if(b){if(this.orientation===
"vertical"){c=b.offsetHeight;b=c!==0?c:window.parseInt(b.getStyle("height"),10)}else{c=b.offsetWidth;b=c!==0?c:window.parseInt(b.getStyle("width"),10)}return this._handleLength=b}},_nextValue:function(b,c){return this.options.possibleValues?this._possibleValues[this._possibleValues.indexOf(b)+c]:b+this.keyboardStep*c},keydown:function(b){if(!this.options.disabled){var c=b.findElement(),d=c.retrieve("ui.slider.handle"),e=this.options;if(Object.isNumber(d))if([Event.KEY_HOME,Event.KEY_END,Event.KEY_UP,
Event.KEY_DOWN,Event.KEY_LEFT,Event.KEY_RIGHT].include(b.keyCode)){c.addClassName("ui-state-active");var i;c=i=this.values[d];switch(b.keyCode){case Event.KEY_HOME:i=e.value.min;break;case Event.KEY_END:i=e.value.max;break;case Event.KEY_UP:case Event.KEY_RIGHT:if(c===e.value.max)return;i=this._nextValue(c,1);break;case Event.KEY_DOWN:case Event.KEY_LEFT:if(c===e.value.min)return;i=this._nextValue(c,-1);break}this.dragging=true;this.setValue(i,d);if(!Prototype.Browser.WebKit){d=this._timer?0.1:1;
this._timer=arguments.callee.bind(this).delay(d,b)}}}},keyup:function(b){this.dragging=false;if(this._timer){window.clearTimeout(this._timer);this._timer=null}this._updateFinished();b.findElement().removeClassName("ui-state-active")},setValue:function(b,c){if(!this.activeHandle){this.activeHandle=this.handles[c||0];this._updateStyles()}c=c||this.activeHandle.retrieve("ui.slider.handle")||0;if(this.initialized&&this.restricted){if(c>0&&b<this.values[c-1])b=this.values[c-1];if(c<this.handles.length-
1&&b>this.values[c+1])b=this.values[c+1]}b=this._getNearestValue(b);this.values[c]=b;var d={};d[this.orientation==="vertical"?"top":"left"]=this._valueToPx(b)+"px";this.handles[c].setStyle(d);this._drawRange();!this.dragging&&!this.undoing&&!this.initialized&&this._updateFinished();if(this.initialized){this.element.fire("ui:slider:value:changing",{slider:this,values:this.values});this.options.onSlide(this.values,this)}return this},_getNearestValue:function(b){var c=this.options.value;if(b<c.min)b=
c.min;if(b>c.max)b=c.max;if(this._possibleValues){var d;for(c=0;c<this._possibleValues.length;c++){d=this._possibleValues[c];if(d===b)return b;if(d>b)break}b=b.nearer(this._possibleValues[c-1],d)}return b},_valueToPx:function(b){var c=this.options.value,d=(this._trackLength-this._handleLength/2)/(c.max-c.min);d*=b-c.min;if(this.orientation==="vertical")d=this._trackLength-d-this._handleLength;return Math.round(d)},mousedown:function(b){var c=this.options;if(!(!b.isLeftClick()||c.disabled)){b.stop();
this._oldValues=this.values.clone();this.active=true;var d=b.findElement();c=b.pointer();if(d===this.element){b=this.element.cumulativeOffset();this.setValue(this._pxToValue({x:Math.round(c.x-b.left+this._handleLength/4),y:Math.round(c.y-b.top+this._handleLength/4)}));handle=this.activeHandle=this.activeHandle||this.handles.first()}else{handle=b.findElement(".ui-slider-handle");if(!handle)return;this.activeHandle=handle}this._updateStyles();b=handle.cumulativeOffset();this._offsets={x:c.x-b.left,
y:c.y-b.top};document.observe("mousemove",this.observers.mousemove);document.observe("mouseup",this.observers.mouseup)}},mouseup:function(b){if(this.active&&this.dragging){this._updateFinished();b.stop()}this.active=this.dragging=false;this.activeHandle=null;this._updateStyles();document.stopObserving("mousemove",this.observers.mousemove);document.stopObserving("mouseup",this.observers.mouseup)},mousemove:function(b){if(this.active){b.stop();this.dragging=true;this._draw(b);Prototype.Browser.WebKit&&
window.scrollBy(0,0)}},rangeMouseDown:function(b){b=b.pointer();var c=this.element.cumulativeOffset();b={x:Math.round(b.x-c.left),y:Math.round(b.y-c.top)};this._rangeInitialValues=this.values.clone();this._rangePseudoValue=this._pxToValue(b);document.observe("mousemove",this.observers.rangeMouseMove);document.observe("mouseup",this.observers.rangeMouseUp)},rangeMouseMove:function(b){this.dragging=true;b.stop();var c=this.options;b=b.pointer();var d=this.element.cumulativeOffset(),e=this._pxToValue({x:Math.round(b.x-
d.left),y:Math.round(b.y-d.top)})-this._rangePseudoValue;b=this._rangeInitialValues.map(function(i){return i+e});if(b[0]<c.value.min){e=c.value.min-this._rangeInitialValues[0];b=this._rangeInitialValues.map(function(i){return i+e})}else if(b[1]>c.value.max){e=c.value.max-this._rangeInitialValues[1];b=this._rangeInitialValues.map(function(i){return i+e})}b.each(this.setValue,this)},rangeMouseUp:function(){this.dragging=false;document.stopObserving("mousemove",this.observers.rangeMouseMove);document.stopObserving("mouseup",
this.observers.rangeMouseUp);this._updateFinished()},_draw:function(b){b=b.pointer();var c=this.element.cumulativeOffset();b.x-=this._offsets.x+c.left;b.y-=this._offsets.y+c.top;this.setValue(this._pxToValue(b))},_pxToValue:function(b){var c=this.options;b=(this.orientation==="horizontal"?b.x:b.y)/(this._trackLength-this._handleLength)*(c.value.max-c.value.min)+c.value.min;if(this.orientation==="vertical")b=c.value.max-(b-c.value.min);return b},undo:function(){if(this._oldValues){this.values=this._oldValues.clone();
this.undoing=true;this._oldValues.each(this.setValue,this);this.undoing=false}},_updateFinished:function(){if(this.element.fire("ui:slider:value:changed",{slider:this,values:this.values}).stopped)this.undo();else{this.activeHandle=null;this._updateStyles();this.options.onChange(this.values,this)}},_updateStyles:function(){a.removeClassNames(this.handles,"ui-state-active");this.activeHandle&&this.activeHandle.addClassName("ui-state-active")},_drawRange:function(){if(this.range){var b=this.values.map(this._valueToPx,
this);this.orientation==="vertical"?this.range.setStyle({top:b[1]+"px",height:b[0]-b[1]+"px"}):this.range.setStyle({left:b[0]+"px",width:b[1]-b[0]+"px"})}},focus:function(b){if(!this.options.disabled){b=b.findElement();this.element.select(".ui-state-focus").invoke("removeClassName","ui-state-focus");b.addClassName("ui-state-focus")}},blur:function(b){b.findElement().removeClassName("ui-state-focus")}});Object.extend(a.Slider,{DEFAULT_OPTIONS:{range:false,disabled:false,value:{min:0,max:100,initial:0,
step:null},possibleValues:null,orientation:"horizontal",onSlide:Prototype.emptyFunction,onChange:Prototype.emptyFunction}})})(S2.UI);
(function(a){a.ProgressBar=Class.create(a.Base,{NAME:"S2.UI.ProgressBar",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");this.element.writeAttribute({role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0});this.valueElement=new Element("div",{"class":"ui-progressbar-value ui-widget-header ui-corner-left"});this.value=d.value.initial;this._refreshValue();this.element.insert(this.valueElement);
this.element.store(this.NAME,this)},destroy:function(){a.removeClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");a.removeAttributes(this.element,"role aria-valuemin aria-valuemax aria-valuenow");this.element.getData().unset(this.NAME)},getValue:function(){var b=this.value,c=this.options.value;if(b<c.min)b=c.min;if(b>c.max)b=c.max;return b},setValue:function(b){this._oldValue=this.getValue();this.value=b;this._refreshValue();return this},undo:function(){this.undoing=
true;this.setValue(this._oldValue);this.undoing=false;return this},_refreshValue:function(){var b=this.getValue();if(!this.undoing)if(this.element.fire("ui:progressbar:value:changed",{progressBar:this,value:b}).stopped){this.undo();return}b===this.options.value.max?this.valueElement.addClassName("ui-corner-right"):this.valueElement.removeClassName("ui-corner-right");var c="width: #{0}px".interpolate([window.parseInt(this.element.getStyle("width"),10)*b/100]);a.makeVisible(this.valueElement,b>this.options.value.min);
this.valueElement.morph(c,{duration:0.7,transition:"linear"});this.element.writeAttribute("aria-valuenow",b)}});Object.extend(a.ProgressBar,{DEFAULT_OPTIONS:{value:{min:0,max:100,initial:0}}})})(S2.UI);
(function(a){a.Menu=Class.create(a.Base,a.Mixin.Shim,{NAME:"S2.UI.Menu",initialize:function(b){this.element=$(b);if(!this.element)this.element=new Element("ul",{"class":"ui-helper-hidden"});this.activeId=this.element.identify()+"_active";b=this.setOptions();a.addClassNames(this.element,"ui-widget ui-widget-content ui-menu ui-corner-"+b.corner);this.choices=this.element.select("li");this._highlightedIndex=-1;this.element.writeAttribute({role:"menu","aria-activedescendant":this.activeId});this.choices.invoke("writeAttribute",
"role","menuitem");this.observers={mouseover:this._mouseover.bind(this),click:this._click.bind(this)};this.addObservers();this._shown=false;this.createShim()},addObservers:function(){this.element.observe("mouseover",this.observers.mouseover);this.element.observe("mousedown",this.observers.click)},removeObservers:function(){this.element.stopObserving("mouseover",this.observers.mouseover);this.element.stopObserving("mousedown",this.observers.click)},clear:function(){this.element.select("li").invoke("remove");
this.choices=[];return this},addChoice:function(b){var c;if(Object.isElement(b))if(b.tagName.toUpperCase()==="LI")c=b;else{c=new Element("li");c.insert(b)}else{c=new Element("li");c.update(b)}c.addClassName("ui-menu-item");c.writeAttribute("role","menuitem");this.element.insert(c);this.choices=this.element.select("li");return c},_mouseover:function(b){(b=b.findElement("li"))&&this.highlightChoice(b)},_click:function(b){(b=b.findElement("li"))&&this.selectChoice(b)},moveHighlight:function(b){this._highlightedIndex=
(this._highlightedIndex+b).constrain(-1,this.choices.length-1);this.highlightChoice();return this},highlightChoice:function(b){var c=this.choices;b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._highlightedIndex;a.removeClassNames(this.choices,"ui-state-active");if(b!==-1){this.choices[b].addClassName("ui-state-active");this._highlightedIndex=b;(c=this.element.down("#"+this.activeId))&&c.writeAttribute("id","");this.choices[b].writeAttribute("id",this.activeId)}},selectChoice:function(b){if(Object.isNumber(b))b=
this.choices[b];else b||(b=this.choices[this._highlightedIndex]);this.element.fire("ui:menu:selected",{instance:this,element:b}).stopped||this.close();return this},open:function(){this.element.fire("ui:menu:opened",{instance:this});this.element.removeClassName("ui-helper-hidden");this._highlightedIndex=-1;Prototype.Browser.IE&&this.adjustShim()},close:function(){this.element.fire("ui:menu:closed",{instance:this});this.element.addClassName("ui-helper-hidden");return this},isOpen:function(){return!this.element.hasClassName("ui-helper-hidden")}});
Object.extend(a.Menu,{DEFAULT_OPTIONS:{corner:"all"}})})(S2.UI);
(function(a){a.Autocompleter=Class.create(a.Base,{NAME:"S2.UI.Autocompleter",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-widget ui-autocompleter");this.input=this.element.down('input[type="text"]');if(!this.input){this.input=new Element("input",{type:"text"});this.element.insert(this.input)}this.input.insert({before:this.button});this.input.setAttribute("autocomplete","off");this.name=d.parameterName||this.input.readAttribute("name");if(d.choices)this.choices=
d.choices.clone();this.menu=new a.Menu;this.element.insert(this.menu.element);(function(){var e=this.input.getLayout();this.menu.element.setStyle({left:e.get("left")+"px",top:e.get("top")+e.get("margin-box-height")+"px"})}).bind(this).defer();this.observers={blur:this._blur.bind(this),keyup:this._keyup.bind(this),keydown:this._keydown.bind(this),selected:this._selected.bind(this)};this.addObservers()},addObservers:function(){this.input.observe("blur",this.observers.blur);this.input.observe("keyup",
this.observers.keyup);this.input.observe("keydown",this.observers.keydown);this.menu.element.observe("ui:menu:selected",this.observers.selected)},_schedule:function(){this._unschedule();this._timeout=this._change.bind(this).delay(this.options.frequency)},_unschedule:function(){this._timeout&&window.clearTimeout(this._timeout)},_keyup:function(){var b=this.input.getValue();if(b){if(b.blank()||b.length<this.options.minCharacters){this.menu.close();this._unschedule();return}b!==this._value&&this._schedule()}else{this.menu.close();
this._unschedule()}this._value=b},_keydown:function(b){if(!a.modifierUsed(b))if(this.menu.isOpen())switch(b.keyCode){case Event.KEY_UP:this.menu.moveHighlight(-1);b.stop();break;case Event.KEY_DOWN:this.menu.moveHighlight(1);b.stop();break;case Event.KEY_TAB:this.menu.selectChoice();break;case Event.KEY_RETURN:this.menu.selectChoice();this.input.blur();b.stop();break;case Event.KEY_ESC:this.input.setValue("");this.input.blur();break}},_getInput:function(){return this.input.getValue()},_setInput:function(b){this.input.setValue(b)},
_change:function(){this.findChoices()},findChoices:function(){var b=this._getInput();this.setChoices((this.choices||[]).inject([],function(c,d){d.toLowerCase().include(b.toLowerCase())&&c.push(d);return c}))},setChoices:function(b){this.results=b;this._updateMenu(b)},_updateMenu:function(b){var c=this.options;this.menu.clear();for(var d=new RegExp(RegExp.escape(this._value),"i"),e=0,i,f,j;i=b[e];e++){j=c.highlightSubstring?i.replace(d,"<b>$&</b>"):j;f=(new Element("li")).update(j);f.store("ui.autocompleter.value",
i);this.menu.addChoice(f)}b.length===0?this.menu.close():this.menu.open()},_moveMenuChoice:function(b){this.list.down("li");this._selectedIndex=(this._selectedIndex+b).constrain(-1,this.results.length-1);this._highlightMenuChoice()},_highlightMenuChoice:function(b){var c=this.list.select("li");b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._selectedIndex;a.removeClassNames(c,"ui-state-active");if(!(b===-1||b===null)){c[b].addClassName("ui-state-active");this._selectedIndex=b}},_selected:function(b){(b=
b.memo.element)&&this._setInput(b.retrieve("ui.autocompleter.value"));this.menu.close()},_blur:function(){this._unschedule();this.menu.close()}});Object.extend(a.Autocompleter,{DEFAULT_OPTIONS:{tokens:[],frequency:0.4,minCharacters:1,highlightSubstring:true,onShow:Prototype.K,onHide:Prototype.K}})})(S2.UI);
document.observe("dom:loaded",function(){function a(h){h._rotation=h._rotation||0;h._scale=h._scale||1;h._panX=h._panX||0;h._panY=h._panY||0;h._pans=[[0,0],[0,0],[0,0]];h._panidx=1}function b(h,m){h.fire("manipulate:update",Object.extend(m,{id:i}))}function c(){function h(p){for(var s=p.length;s--;)z[p[s].identifier]=p[s];p=[];for(k in z)p.push(k);p=p.sort();if((m=(w=p.length>0?p[0]:null)?z[w].target:null)&&m.nodeType==3)m=m.parentNode;y=p.length>1?p[1]:null;if(B==0&&w&&y){g=(z[w].pageX-z[y].pageX).abs();
o=(z[w].pageY-z[y].pageY).abs();m&&a(m);n=Math.sqrt(g*g+o*o);q=Math.atan2(z[y].pageY-z[w].pageY,z[y].pageX-z[w].pageX);B=1}else if(B==1&&!(w&&y)){if(m){p=m;s=v;p._rotation=r;p._scale=s;p._panX=void 0;p._panY=void 0}B=0}}var m,r,v,z={},w=null,y=null,B=0,A,l,g,o,n,q;e.observe("touchstart",function(p){var s=w;h(p.changedTouches);if(s==null&&w){s=m.viewportOffset();A=s.left+(z[w].pageX-s.left);l=s.top+(z[w].pageY-s.top)}p.stop()});e.observe("touchmove",function(p){h(p.changedTouches);if(w&&!y){b(m,{panX:(m._panX||
0)+z[w].pageX-A,panY:(m._panY||0)+z[w].pageY-l,scale:m._scale,rotation:m._rotation});p.stop()}else if(w&&y){var s=z[y].pageX-z[w].pageX,u=z[y].pageY-z[w].pageY,x=(m._panX||0)+z[y].pageX-s/2-A,C=(m._panY||0)+z[y].pageY-u/2-l;v=m._scale*Math.sqrt(s*s+u*u)/n;r=m._rotation+Math.atan2(u,s)-q;b(m,{rotation:r,scale:v,panX:x,panY:C});p.stop()}});["touchcancel","touchend"].each(function(p){e.observe(p,function(s){for(var u=s.changedTouches.length;u--;)delete z[s.changedTouches[u].identifier];h([]);if(m){s=
m;u=v;s._rotation=r;s._scale=u;s._panX=void 0;s._panY=void 0}})})}function d(){var h,m,r,v,z,w=false;e.observe("manipulatestart",function(y){y.stop();h=y.element();a(h);w=true});e.observe("manipulatemove",function(y){h=y.element();m=h._rotation+y.rotation;r=h._scale*y.scale;v=h._panX+y.panX;z=h._panY+y.panY;b(h,{rotation:m,scale:r,panX:v,panY:z,clientX:y.clientX,clientY:y.clientY});y.stop()},false);e.observe("manipulateend",function(y){if(h=y.element()){var B=h,A=r,l=v,g=z;B._rotation=m;B._scale=
A;B._panX=l;B._panY=g}w=false;B=Math.sqrt(y.panSpeedX*y.panSpeedX+y.panSpeedY*y.panSpeedY);B>25&&h.fire("manipulate:flick",{speed:B,direction:Math.atan2(y.panSpeedY,y.panSpeedX)})});e.observe("mousemove",function(y){y.stop()});e.observe("mousedown",function(y){y.stop()});e.observe("mouseup",function(y){y.stop()})}if(S2.enableMultitouchSupport){var e=$(document.body),i=0;if(navigator.userAgent.match(/SLBrowser/))return d();if(navigator.userAgent.match(/QtLauncher/))return d();if(navigator.userAgent.match(/Starlight/))return d();
try{document.createEvent("ManipulateEvent");return d()}catch(f){}try{document.createEvent("TouchEvent");return c()}catch(j){}return function(){function h(p){var s=w.viewportOffset(),u=p.pageX-s.left-r;p=p.pageY-s.top-v;q=Math.sqrt(u*u+p*p);n=w._scale*q/B;o=w._rotation+Math.atan2(p,u)-A;return{rotation:o,scale:n,panX:w._panX,panY:w._panY}}function m(p){return{rotation:w._rotation,scale:w._scale,panX:w._panX+p.pageX-l,panY:w._panY+p.pageY-g}}var r,v,z=false,w,y,B,A,l,g,o,n,q;e.observe("mousedown",function(p){y=
p.shiftKey?"scale":"pan";if((w=p.element())&&w.fire){i++;z=true;a(w);var s=w.viewportOffset();r=w.offsetWidth/2;v=w.offsetHeight/2;var u=p.pageX-s.left-r,x=p.pageY-s.top-v;B=Math.sqrt(u*u+x*x);A=Math.atan2(x,u);l=s.left+(p.pageX-s.left);g=s.top+(p.pageY-s.top);p.stop()}});e.observe("mousemove",function(p){if(z)b(w,y=="scale"?h(p):m(p))});e.observe("mouseup",function(p){if(z){z=false;if(y=="scale"){p=h(p);b(w,p);w._rotation=p.rotation;w._scale=p.scale}else{b(w,m(p));w._panX=w._panX+p.pageX-l;w._panY=
w._panY+p.pageY-g}}});e.observe("dragstart",function(p){p.stop()})}()}});Element.__scrollTo=Element.scrollTo;Element.addMethods({scrollTo:function(a,b,c){if(arguments.length==1)return Element.__scrollTo(a);(new S2.FX.Scroll(a,Object.extend(c||{},{to:b}))).play();return a}});
Element.addMethods({effect:function(a,b,c){if(Object.isFunction(b))b=new b(a,c);else if(Object.isString(b))b=new (S2.FX[b.capitalize()])(a,c);b.play(a,c);return a},morph:function(a,b,c){c=S2.FX.parseOptions(c);if(!c.queue){c.queue=a.retrieve("S2.FX.Queue");if(!c.queue)a.store("S2.FX.Queue",c.queue=new S2.FX.Queue)}if(!c.position)c.position="end";return a.effect("morph",Object.extend(c,{style:b}))}.optionize(),appear:function(a,b){return a.effect("morph",Object.extend({before:function(){a.show().setStyle({opacity:0})},
style:"opacity:1"},b))},fade:function(a,b){return a.effect("morph",Object.extend({style:"opacity:0",after:a.hide.bind(a)},b))},cloneWithoutIDs:function(a){a=$(a);a=a.cloneNode(true);a.id="";$(a).select("*[id]").each(function(b){b.id=""});return a}});
(function(){Element.addMethods({transform:window.CSSMatrix?function(a,b){a.style.transform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:window.WebKitCSSMatrix?function(a,b){a.style.webkitTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.Gecko?function(a,b){a.style.MozTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.IE?function(a,b){if(!a._oDims)a._oDims=[a.offsetWidth,a.offsetHeight];var c=
Math.cos(b.rotation||0)*1,d=Math.sin(b.rotation||0)*1;a.style.filter="progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11="+c+",M12="+-d+",M21="+d+",M22="+c+")";a.style.marginLeft=(a._oDims[0]-a.offsetWidth)/2+"px";a.style.marginTop=(a._oDims[1]-a.offsetHeight)/2+"px";return a}:function(a){return a}})})();
S2.viewportOverlay=function(){var a=document.viewport.getDimensions(),b=document.viewport.getScrollOffsets();return(new Element("div")).setStyle({position:"absolute",left:b.left+"px",top:b.top+"px",width:a.width+"px",height:a.height+"px"})};S2.FX.Helpers={fitIntoRectangle:function(a,b,c,d){return a/b<c/d?[(c-a*(d/b))/2,0,a*(d/b),d]:[0,(d-b*(c/a))/2,c,b*(c/a)]}};
S2.FX.Operators.Zoom=Class.create(S2.FX.Operators.Style,{initialize:function($super,b,c,d){var e=document.viewport.getDimensions(),i=document.viewport.getScrollOffsets(),f=c.getDimensions();e=S2.FX.Helpers.fitIntoRectangle(f.width,f.height,e.width-(d.borderWidth||0)*2,e.height-(d.borderWidth||0)*2);Object.extend(d,{style:{left:e[0]+(d.borderWidth||0)+i.left+"px",top:e[1]+(d.borderWidth||0)+i.top+"px",width:e[2]+"px",height:e[3]+"px"}});$super(b,c,d)}});
S2.FX.Zoom=Class.create(S2.FX.Element,{setup:function(){this.clone=this.element.cloneWithoutIDs();this.element.insert({before:this.clone});this.clone.absolutize().setStyle({zIndex:9999});this.overlay=S2.viewportOverlay();this.options.overlayClassName?this.overlay.addClassName(this.options.overlayClassName):this.overlay.setStyle({backgroundColor:"#000",opacity:"0.9"});$$("body")[0].insert(this.overlay);this.animate("zoom",this.clone,{borderWidth:this.options.borderWidth,propertyTransitions:this.options.propertyTransitions||
{}})},teardown:function(){this.clone.observe("click",function(){this.overlay.remove();this.clone.morph("opacity:0",{duration:0.2,after:function(){this.clone.remove()}.bind(this)})}.bind(this))}});var MySublimeVideo=MySublimeVideo||{};
document.observe("dom:loaded",function(){S2.Extensions.webkitCSSTransitions=true;if($("edit_credentials"))MySublimeVideo.currentPasswordHandler=new CurrentPasswordHandler;$$("input[type=password]").each(function(a,b){new PasswordFieldManager(a,b)});if(!supportsHtml5InputAttribute("placeholder")){$$("input[placeholder]").each(function(a){new PlaceholderManager(a)});$$("textarea[placeholder]").each(function(a){new PlaceholderManager(a)})}$$("form").each(function(a){new FormManager(a)});$$("#flash .notice").each(function(a){MySublimeVideo.hideFlashNoticeDelayed(a)});
if($("new_site")){MySublimeVideo.addSiteHandler=new AddSiteHandler;MySublimeVideo.sitesPoller=new SitesPoller}});MySublimeVideo.flashNotice=function(a){var b=$("flash");b&&b.remove();a=(new Element("div",{className:"notice"})).update(a);b=(new Element("div",{id:"flash"})).insert(a);$("content").insert({top:b});MySublimeVideo.hideFlashNoticeDelayed(a)};MySublimeVideo.hideFlashNoticeDelayed=function(a){setTimeout(function(){a.morph("top:-35px",{duration:0.7})},15E3)};
MySublimeVideo.openPopup=function(a,b,c){if(!MySublimeVideo.popupHandler)MySublimeVideo.popupHandler=new PopupHandler;MySublimeVideo.popupHandler.open(a,b,c)};MySublimeVideo.closePopup=function(){if(!MySublimeVideo.popupHandler)MySublimeVideo.popupHandler=new PopupHandler;MySublimeVideo.popupHandler.close();return false};MySublimeVideo.makeSticky=function(a){$$("#header .active").each(function(b){b.removeClassName("active")});a.addClassName("active")};
MySublimeVideo.makeRemoteLinkSticky=function(a){a.up().select("a.active[data-remote]").each(function(b){b.removeClassName("active")});a.addClassName("active")};MySublimeVideo.showTableSpinner=function(){$("table_spinner").show()};MySublimeVideo.showSiteEmbedCode=function(a){MySublimeVideo.openPopup(a,"embed_code_site","/sites/"+a);return false};MySublimeVideo.showSiteSettings=function(a){MySublimeVideo.openPopup(a,"settings","/sites/"+a+"/edit");return false};
MySublimeVideo.showInvoice=function(a,b){MySublimeVideo.openPopup(a,"invoices_"+b,"/invoices/"+a+"?type="+b);return false};
var AddSiteHandler=Class.create({initialize:function(){this.setup()},setup:function(){this.element=$("new_site");this.beforeAjaxHandler=this.element.on("ajax:before",function(){this.numberOfRequestsUntilSpinnerHides=1;this.element.next(".spinner").show();this.beforeAjaxHandler.stop()}.bind(this))},reloadAfterAjax:function(){this.hideSpinner();this.setup();supportsHtml5InputAttribute("placeholder")||new PlaceholderManager(this.element.down("input[placeholder]"));new FormManager(this.element)},hideSpinner:function(){this.numberOfRequestsUntilSpinnerHides-=
1;this.numberOfRequestsUntilSpinnerHides==0&&$("new_site_wrap").down(".spinner").hide()}}),FormManager=Class.create({initialize:function(a){a.on("submit",function(b){b.findElement("form[data-remote]")&&a.select("input[type=submit]","button").each(function(c){c.disable()});supportsHtml5InputAttribute("placeholder")||a.select("input.placeholder").each(function(c){c.value=""})});a.select("input[type=submit]").each(function(b){b.on("click",function(){a.select("input").each(function(c){if(c.validity)c.validity.valid?
c.removeClassName("errors"):c.addClassName("errors")})})})}}),PasswordFieldManager=Class.create({initialize:function(a,b){this.field=a;this.field.store("passwordFieldManager",this);if(this.field.hasClassName("show_password")){var c=new Element("div",{className:"checkbox_wrap"}),d=(new Element("label",{"for":"show_password_"+b})).update("Show password");this.showPasswordCheckbox=new Element("input",{type:"checkbox",id:"show_password_"+b});c.insert(this.showPasswordCheckbox).insert(d);(d=this.field.up().select(".inline_errors").first())?
d.insert({after:c}):this.field.insert({after:c});this.showPasswordCheckbox.on("click",this.toggleShowPassword.bind(this));this.showPasswordCheckbox.checked=false}},isShowingPassword:function(){return this.showPasswordCheckbox?this.showPasswordCheckbox.checked:false},toggleShowPassword:function(){var a=this.field.retrieve("placeholderManager");if(a){if(this.field.value!=this.field.readAttribute("placeholder")){this.replacePasswordField(this.field,this.isShowingPassword());a.passwordFieldDidUpdate(this.field)}}else this.replacePasswordField(this.field,
this.isShowingPassword())},replacePasswordField:function(a,b){var c=new Element("input",{id:a.id,name:a.name,value:a.value,size:a.size,placeholder:a.readAttribute("placeholder"),required:a.readAttribute("required"),className:a.className,type:b?"text":"password"});a.purge();a.replace(c);this.field=c;this.field.id=="user_password"&&$("current_password_wrap")&&MySublimeVideo.currentPasswordHandler.setupField(this.field);return c}}),PlaceholderManager=Class.create({initialize:function(a){this.field=a;
this.passwordFieldManager=this.field.retrieve("passwordFieldManager");if(this.field.value==this.field.readAttribute("placeholder")){this.field.value="";this.field.removeClassName("placeholder")}this.setupObservers();this.resetField()},setupObservers:function(){this.field.store("placeholderManager",this);this.field.on("focus",this.clearField.bind(this));this.field.on("blur",this.resetField.bind(this))},clearField:function(){if(this.field.value==this.field.readAttribute("placeholder")){this.field.value=
"";this.field.removeClassName("placeholder");if(this.passwordFieldManager){this.field=this.passwordFieldManager.replacePasswordField(this.field,this.passwordFieldManager.isShowingPassword());this.field.focus();this.setupObservers()}}},resetField:function(){if(this.field.value==""){this.field.addClassName("placeholder");this.field.value=this.field.readAttribute("placeholder");if(this.passwordFieldManager){this.field=this.passwordFieldManager.replacePasswordField(this.field,true);this.setupObservers()}}},
passwordFieldDidUpdate:function(a){this.field=a;this.setupObservers()}}),PopupHandler=Class.create({initialize:function(){this.keyDownHandler=document.on("keydown",this.keyDown.bind(this))},startKeyboardObservers:function(){this.keyDownHandler.start()},stopKeyboardObservers:function(){this.keyDownHandler.stop()},open:function(a,b,c){this.close();a=(new Element("div",{id:b+"_"+a,className:"popup loading"})).update("<div class='wrap'><div class='content "+b+"'></div></div>");b=(new Element("a",{href:"",
className:"close",onclick:"return MySublimeVideo.closePopup()"})).update("<span>Close</span>");a.insert({bottom:b});$("global").insert({after:a});this.startKeyboardObservers();new Ajax.Request(c,{method:"get"})},close:function(){this.stopKeyboardObservers();$$(".popup").each(function(a){a.remove()})},keyDown:function(a){switch(a.keyCode){case Event.KEY_ESC:this.close();break}}}),SitesPoller=Class.create({initialize:function(){this.pollingDelay=3E3;this.maxAttempts=20;this.attemptedPolls=0;this.checkForSiteInProgress()},
checkForSiteInProgress:function(){var a=$$("#sites .in_progress").first();if(a){this.currentSiteId=parseInt(a.up("tr").id.replace("site_",""),10);this.startPolling()}},startPolling:function(){this.poll&&this.stopPolling();this.poll=setInterval(this.remoteCheckForStateUpdate.bind(this),this.pollingDelay)},stopPolling:function(){clearInterval(this.poll);this.poll=null},remoteCheckForStateUpdate:function(){if(this.attemptedPolls<this.maxAttempts){this.attemptedPolls++;new Ajax.Request("/sites/"+this.currentSiteId+
"/state",{method:"get"})}else this.stopPolling()},updateSite:function(a){this.stopPolling();var b=$$("#site_"+a+" .code").first();if(b){var c=(new Element("a",{href:"/sites/"+a,className:"embed_code",onclick:"return MySublimeVideo.showSiteEmbedCode("+a+")"})).update("Embed code");b.update(c)}if(b=$$("#site_"+a+" .settings").first()){b.removeClassName("disabled");b.writeAttribute("onclick","return MySublimeVideo.showSiteSettings("+a+")")}this.checkForSiteInProgress()}}),CurrentPasswordHandler=Class.create({initialize:function(){this.emailField=
$("user_email");this.passwordField=$("user_password");this.currentPasswordWrap=$("current_password_wrap");[this.emailField,this.passwordField].each(function(a){this.setupField(a)}.bind(this))},setupField:function(a){a.on("focus",function(){this.showCurrentPassword()}.bind(this))},showCurrentPassword:function(){this.currentPasswordWrap.show()}});function supportsHtml5InputOfType(a){var b=document.createElement("input");b.setAttribute("type",a);return b.type!=="text"}
function supportsHtml5InputAttribute(a){var b=document.createElement("input");return a in b}function ddd(){console.log.apply(console,arguments)};
