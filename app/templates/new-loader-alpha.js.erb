/*! SublimeVideo loader  | (c) 2013 Jilion SA | http://sublimevideo.net
*/(function(){ (function(){var e,n,t,r,o,u,a,i,c,l,d,s,f,m,v,E,h,p,y,g,b,N,S,T,L,w,O,B,C,k,q,M,_,P,j,x,A,R,V,X;return p=document,t="DOMContentLoaded",k="onreadystatechange",X=window,n=0,r=1,e=2,_=[],u=n,g=!1,O="sublime",M="sublime_",C=[],w=!1,document.createElement("video"),document.createElement("source"),c={host:'<%= host %>',version:'<%= app_component_version %>',token:'<%= token %>',components:<%= components_versions.to_json.gsub('"', "'") %>},f=function(e,n,t){return e===t.token?""+t.host+"/s/"+e+"."+EXT:""+t.host+"/c/"+e+"/"+n+"/"+e+"."+EXT+"?t="+t.token},m=function(e){var n,t,r,o;t=[],o=e.components;for(n in o)r=o[n],t.push(f(n,r,e));return t},P=function(){return l()||d("sublime")},i=function(){var e,n,t,r;for(w=!0,r=[],n=0,t=C.length;t>n;n++)e=C[n],r.push(e());return r},v=function(){var e;return e={},window.sublimevideo=e,e.ready=function(e){return w?e():C.push(e)},e.load=function(){return c.loadForced=!0,T()}},l=function(){return p.getElementsByTagName("video").length>0},d=function(e){var n,t,r,o,u;if(e){if(p.querySelector)return null!=p.querySelector("."+e);if(p.getElementsByClassName)return o=p.getElementsByClassName(e),o&&o.length>0;for(n=RegExp("\\b"+e+"\\b"),r=p.getElementsByTagName("*"),u=0;r.length>u;){if(t=r[u].className,n.test(t))return!0;u++}return!1}return!1},S=function(e){return"function"==typeof e},B=function(e){var n;for(n=0;e.length>n;)e[n](),n++;return e.length=0},L=function(e){var n,t,r,o;for(o=[],t=0,r=e.length;r>t;t++)n=e[t],o.push(a(n));return o},a=function(e){var n,t;return n=p.getElementsByTagName("head")[0]||p.body,t=p.createElement("script"),t.type="text/javascript",t.src=e,t.async=!0,n.appendChild(t)},j=function(e){var n,t;t=0;for(n in e)e.hasOwnProperty(n)&&(t+=1);return t},V=0,E=function(n){var t,r,o;if(V++,console.log("did load",n),V===j(c.components)+1){for(r=0,o=A.length;o>r;r++)t=A[r],X[M].define.apply(this,t);return sublime_.require(["application"],function(n){var t;return t=new n,t.load(c,function(){return u=e,B(_),i()})})}},x=function(){var e;return e?(e=!1,p.addEventListener?(p.removeEventListener(t,y,!1),X.removeEventListener("load",y,!1)):(p.detachEvent(k,y),X.detachEvent("onload",y))):void 0},y=function(e){return!g&&(e||(e=X.event),(p.addEventListener||"complete"===p.readyState||e&&"load"===e.type)&&(x(),g=!0,P()||N))?T():void 0},s=function(){var e,n;if(n=!0,p.addEventListener)return p.addEventListener(t,y,!1),X.addEventListener("load",y,!1);if(p.attachEvent){p.attachEvent(k,y),X.attachEvent("onload",y),e=!1;try{e=!(null!=X.frameElement)}catch(r){}if(p.docElement&&p.docElement.doScroll&&e)return h()}},h=function(){if(!g){try{p.docElement.doScroll("left")}catch(e){return setTimeout(h,1),void 0}return y()}},X.console||(b=function(){},X.console={log:b,warn:b,error:b,debug:b}),N=!1,A=[],T=function(){return u===n?(u=r,L(m(c))):void 0},o=X[O],o&&o.ready&&o.load?console.error("SublimeVideo loader has been installed more than once."):(o=X[O]={},o.ready=function(n){return u===e?n():S(n)&&_.push(n),void 0},o.load=function(){return g?T():N=!0,void 0},o._component=E,q=X[M]={},q.define=function(){return A.push(Array.prototype.slice.apply(arguments))},v(),"complete"===document.readyState?y():(s(),R=X.jQuery,R&&S(R.ready)?R(p).ready(y):void 0))})();;sublime._component('loader');})();