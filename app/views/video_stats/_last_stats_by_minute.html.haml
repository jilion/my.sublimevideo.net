%h3.title#top_videos_title Last 60 minutes

#last_plays.graph_box
  %h4.title Last plays
  .content_wrap
    - if stats_presenter.last_plays.empty?
      %p.empty No plays.
    - else
      %ul
        - stats_presenter.last_plays.each do |play|
          %li
            %span
            %span.wrap
              on
              = link_to url_host(play.du), url_with_protocol(play.du)
              = '[external]' if play.ex?

              - if play.ru?
                coming from
                = play.ru
              %span.browser{ style: video_stats_browser_style("#{play.br}-#{play.pl}") }
              %span.platform{ style: video_stats_platform_style("#{play.br}-#{play.pl}") }
              %span.icon{ style: video_stats_country_style(play.co) }

#last_60_minutes_loads_and_starts
  #last_60_minutes_loads
    .sum
      = stats_presenter.last_60_minutes_loads.sum { |a| a[1] }
      loads
    .sparkline
  .spacer

  #last_60_minutes_starts
    .sum
      = stats_presenter.last_60_minutes_starts.sum { |a| a[1] }
      starts
    .sparkline

:coffee
  MySublimeVideo.videoStats.initSparklines()
  MySublimeVideo.Helpers.VideoStatsChartsHelper.sparkline($('#last_60_minutes_loads .sparkline'), #{stats_presenter.last_60_minutes_loads.map { |a| a[1] }},
    width:  '100%'
    height: '42px')

  MySublimeVideo.Helpers.VideoStatsChartsHelper.sparkline($('#last_60_minutes_starts .sparkline'), #{stats_presenter.last_60_minutes_starts.map { |a| a[1] }},
    width:  '100%'
    height: '42px')
