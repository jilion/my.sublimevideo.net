-#%h2 SublimeVideo clients
-#
-#.pagination_wrap
-#  = paginate @sites, theme: 'admin'
-#  = page_entries_info @sites
-#
-#%table
-#  %tr
-#    %th Site
-#    %th Currently paying ?
-#    %th Billing name
-#    %th Personal use
-#    %th Company use
-#    %th Clients use
-#    %th Billing country
-#    %th 1st invoice
-#    %th No logo
-#    %th Your logo
-#    %th Sharing
-#    %th Auto-embed
-#    %th Google analytics
-#    %th Real-time stats
-#    %th VIP support
-#    %th 2012/06
-#    %th 2012/07
-#    %th 2012/08
-#    %th 2012/09
-#    %th 2012/10
-#    %th 2012/11
-#    %th 2012/12
-#    %th 2013/01
-#    %th 2013/02
-#    %th 2013/03
-#    %th 2013/04
-#    %th 2013/05
-#    %th 2013/06
-#    %th # views as of Jun 30th, 2013
-#    %th $$ 2011
-#    %th $$ 2012
-#    %th $$ 2013
-#
-#  - @sites.each do |site|
-#    - invoices = site.invoices.paid.order(:paid_at)
-#    %tr
-#      %td= link_to(admin_pretty_hostname(site, site.hostname), [:edit, :admin, site])
-#      %td= site.state != 'archived'
-#      %td= site.user.billing_name.presence || site.user.name
-#      %td= site.user.use_personal
-#      %td= site.user.use_company
-#      %td= site.user.use_clients
-#      %td= Country[site.user.billing_country].try(:name)
-#      %td= invoices.first.present? ? l(invoices.first.try(:paid_at), format: :month_fullyear) : 'Not yet invoiced'
-#      %td= site.billable_items.with_item(AddonPlan.get('logo', 'disabled')).first.try(:state) || 'N/A'
-#      %td= site.billable_items.with_item(AddonPlan.get('logo', 'custom')).first.try(:state) || 'N/A'
-#      %td= site.billable_items.with_item(AddonPlan.get('social_sharing', 'standard')).first.try(:state) || 'N/A'
-#      %td= site.billable_items.with_item(AddonPlan.get('embed', 'auto')).first.try(:state) || 'N/A'
-#      %td= site.billable_items.with_item(AddonPlan.get('google_analytics', 'standard')).first.try(:state) || 'N/A'
-#      %td= site.billable_items.with_item(AddonPlan.get('stats', 'realtime')).first.try(:state) || 'N/A'
-#      %td= site.billable_items.with_item(AddonPlan.get('support', 'vip')).first.try(:state) || 'N/A'
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 6), to: Time.utc(2013, 6, 30)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 7), to: Time.utc(2012, 7, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 8), to: Time.utc(2012, 8, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 9), to: Time.utc(2012, 9, 30)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 10), to: Time.utc(2012, 10, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 11), to: Time.utc(2012, 11, 30)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 12), to: Time.utc(2012, 12, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 1), to: Time.utc(2013, 1, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 2), to: Time.utc(2013, 2, 28)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 3), to: Time.utc(2013, 3, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 4), to: Time.utc(2013, 4, 30)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 5), to: Time.utc(2013, 5, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 6), to: Time.utc(2013, 6, 31)))
-#      %td= display_integer(Stat::Site::Day.views_sum(token: site.token, to: Time.utc(2013, 6, 30)))
-#      %td= display_amount invoices.paid_between(Time.utc(2011).beginning_of_year, Time.utc(2011).end_of_year).sum(:amount)
-#      %td= display_amount invoices.paid_between(Time.utc(2012).beginning_of_year, Time.utc(2012).end_of_year).sum(:amount)
-#      %td{ style: 'font-style:italic' }= display_amount invoices.paid_between(Time.utc(2013).beginning_of_year, Time.utc(2013).end_of_year).sum(:amount)
-#
-#.pagination_wrap
-#  = paginate @sites, theme: 'admin'
-#  = page_entries_info @sites

- @sites.each do |site|
  - invoices = site.invoices.paid.order(:paid_at)
  = site.hostname
  %span> ,
  = site.state != 'archived'
  %span> ,
  = (site.user.billing_name.presence || site.user.name).gsub(',', ' ')
  %span> ,
  = site.user.use_personal
  %span> ,
  = site.user.use_company
  %span> ,
  = site.user.use_clients
  %span> ,
  = (Country[site.user.billing_country].try(:name) rescue 'N/A').gsub(',', ' ')
  %span> ,
  = invoices.first.present? ? l(invoices.first.try(:paid_at), format: :month_fullyear) : 'Not yet invoiced'
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, to: Time.utc(2013, 6, 30))
  %span> ,
  = site.billable_items.with_item(AddonPlan.get('logo', 'disabled')).first.try(:state) || 'N/A'
  %span> ,
  = site.billable_items.with_item(AddonPlan.get('logo', 'custom')).first.try(:state) || 'N/A'
  %span> ,
  = site.billable_items.with_item(AddonPlan.get('social_sharing', 'standard')).first.try(:state) || 'N/A'
  %span> ,
  = site.billable_items.with_item(AddonPlan.get('embed', 'auto')).first.try(:state) || 'N/A'
  %span> ,
  = site.billable_items.with_item(AddonPlan.get('google_analytics', 'standard')).first.try(:state) || 'N/A'
  %span> ,
  = site.billable_items.with_item(AddonPlan.get('stats', 'realtime')).first.try(:state) || 'N/A'
  %span> ,
  = site.billable_items.with_item(AddonPlan.get('support', 'vip')).first.try(:state) || 'N/A'
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 7), to: Time.utc(2012, 7, 31))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 8), to: Time.utc(2012, 8, 31))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 9), to: Time.utc(2012, 9, 30))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 10), to: Time.utc(2012, 10, 31))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 11), to: Time.utc(2012, 11, 30))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 12), to: Time.utc(2012, 12, 31))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 1), to: Time.utc(2013, 1, 31))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 2), to: Time.utc(2013, 2, 28))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 3), to: Time.utc(2013, 3, 31))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 4), to: Time.utc(2013, 4, 30))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 5), to: Time.utc(2013, 5, 31))
  %span> ,
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 6), to: Time.utc(2013, 6, 30))
  %span> ,
  = invoices.paid_between(Time.utc(2011).beginning_of_year, Time.utc(2011).end_of_year).sum(:amount) / 100.0
  %span> ,
  = invoices.paid_between(Time.utc(2012).beginning_of_year, Time.utc(2012).end_of_year).sum(:amount) / 100.0
  %span> ,
  = invoices.paid_between(Time.utc(2013).beginning_of_year, Time.utc(2013).end_of_year).sum(:amount) / 100.0
  %br
