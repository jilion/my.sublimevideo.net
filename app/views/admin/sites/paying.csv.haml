- @sites.each do |site|
  - invoices = site.invoices.paid.order(:paid_at)
  = site.hostname
  = ','
  = site.state != 'archived'
  = ','
  = site.user.billing_name.presence || site.user.name
  = ','
  = site.user.use_personal
  = ','
  = site.user.use_company
  = ','
  = site.user.use_clients
  = ','
  = Country[site.user.billing_country].try(:name) rescue 'N/A'
  = ','
  = invoices.first.present? ? l(invoices.first.try(:paid_at), format: :month_fullyear) : 'Not yet invoiced'
  = ','
  = site.billable_items.with_item(AddonPlan.get('logo', 'disabled')).first.try(:state) || 'N/A'
  = ','
  = site.billable_items.with_item(AddonPlan.get('logo', 'custom')).first.try(:state) || 'N/A'
  = ','
  = site.billable_items.with_item(AddonPlan.get('social_sharing', 'standard')).first.try(:state) || 'N/A'
  = ','
  = site.billable_items.with_item(AddonPlan.get('embed', 'auto')).first.try(:state) || 'N/A'
  = ','
  = site.billable_items.with_item(AddonPlan.get('google_analytics', 'standard')).first.try(:state) || 'N/A'
  = ','
  = site.billable_items.with_item(AddonPlan.get('stats', 'realtime')).first.try(:state) || 'N/A'
  = ','
  = site.billable_items.with_item(AddonPlan.get('support', 'vip')).first.try(:state) || 'N/A'
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 6), to: Time.utc(2013, 6, 30))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 7), to: Time.utc(2012, 7, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 8), to: Time.utc(2012, 8, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 9), to: Time.utc(2012, 9, 30))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 10), to: Time.utc(2012, 10, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 11), to: Time.utc(2012, 11, 30))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2012, 12), to: Time.utc(2012, 12, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 1), to: Time.utc(2013, 1, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 2), to: Time.utc(2013, 2, 28))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 3), to: Time.utc(2013, 3, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 4), to: Time.utc(2013, 4, 30))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 5), to: Time.utc(2013, 5, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, from: Time.utc(2013, 6), to: Time.utc(2013, 6, 31))
  = ','
  = Stat::Site::Day.views_sum(token: site.token, to: Time.utc(2013, 6, 30))
  = ','
  = invoices.paid_between(Time.utc(2011).beginning_of_year, Time.utc(2011).end_of_year).sum(:amount)
  = ','
  = invoices.paid_between(Time.utc(2012).beginning_of_year, Time.utc(2012).end_of_year).sum(:amount)
  = ','
  = invoices.paid_between(Time.utc(2013).beginning_of_year, Time.utc(2013).end_of_year).sum(:amount)
  %br
