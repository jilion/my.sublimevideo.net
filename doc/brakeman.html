<!DOCTYPE HTML SYSTEM>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Brakeman Report</title>
  <script>
    function toggle(context) {
      var elem = document.getElementById(context);

      if (elem.style.display != "block")
        elem.style.display = "block";
      else
        elem.style.display = "none";
        
      elem.parentNode.scrollIntoView();
    }
  </script>
  <style>
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

a {
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

 .user_input {
   background-color: #fcecab;
 }

  </style>
</head>
<body>

<h1>Brakeman Report</h1>
<table>
  <tr>
    <th>Application Path</th>
    <th>Rails Version</th>
    <th>Report Generation Time</th>
    <th>Checks Performed</th>
  </tr>
  <tr>
    <td>/Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net</td>
    <td>3.2.8</td>
    <td>2012-08-22 18:56:47 +0200</td>
    <td>BasicAuth, CrossSiteScripting, DefaultRoutes, DigestDoS, EscapeFunction, Evaluation, Execute, FileAccess, FilterSkipping, ForgerySetting, LinkTo, LinkToHref, MailTo, MassAssignment, ModelAttributes, NestedAttributes, QuoteTableName, Redirect, Render, ResponseSplitting, SQL, SafeBufferManipulation, SelectTag, SelectVulnerability, Send, SendFile, SessionSettings, SingleQuotes, SkipBeforeFilter, StripTags, TranslateBug, ValidationRegex, WithoutProtection</td>
  </tr>
</table>
<br>
<h2 id='summary'>Summary</h2> 
<table>
  <tr>
    <th>Scanned/Reported</th>
    <th>Total</th>
  </tr>
  <tr>
    <td>Controllers</td>
    <td>47</td>
  </tr>
  <tr>
    <td>Models</td>
    <td>44</td>
  </tr>
  <tr>
    <td>Templates</td>
    <td>222</td>
  </tr>
  <tr>
    <td>Errors</td>
    <td>15</td>
  </tr>
  <tr>
    <td>Security Warnings</td>
    <td>21 <span class='high-confidence'>(5)</span></td>
  </tr>
</table>
<br>
<table>
  <tr>
    <th>Warning Type</th>
    <th>Total</th>
  </tr>
  
  <tr>
    <td>Attribute Restriction</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>Cross Site Scripting</td>
    <td>8</td>
  </tr>
  
  <tr>
    <td>Dynamic Render Path</td>
    <td>2</td>
  </tr>
  
  <tr>
    <td>Redirect</td>
    <td>9</td>
  </tr>
  
  <tr>
    <td>SQL Injection</td>
    <td>1</td>
  </tr>
  
</table>
<br>
<div onClick="toggle('errors_table');">  <h2>Exceptions raised during the analysis (click to see them)</h2 ></div> <div id='errors_table' style='display:none'> 
<table>
  <tr>
    <th>Error</th>
    <th>Location</th>
  </tr>

  <tr>
    <td>Filter &quot;coffeescript&quot; is not defined.</td>
    <td>While compiling HAML in /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/views/admin/stats/index.html.haml</td>
  </tr>

  <tr>
    <td>Filter &quot;coffeescript&quot; is not defined.</td>
    <td>While compiling HAML in /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/views/site_stats/index.html.haml</td>
  </tr>

  <tr>
    <td>Filter &quot;coffeescript&quot; is not defined.</td>
    <td>While compiling HAML in /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/views/video_codes/new.html.haml</td>
  </tr>

  <tr>
    <td>Filter &quot;coffeescript&quot; is not defined.</td>
    <td>While compiling HAML in /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/views/videos/index.html.haml</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/admin.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/deal.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/enthusiast.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/invoice_modules/scope.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/mail_log.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/mail_template.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/referrer.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/site_modules/scope.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;.&quot; (tDOT)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/site_modules/template.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/tweet.rb</td>
  </tr>

  <tr>
    <td> parse error on value &quot;=&quot; (tEQL)</td>
    <td>could not parse /Users/remy/Jilion/Products/SublimeVideo/my.sublimevideo.net/app/models/user_modules/scope.rb</td>
  </tr>

</table>
</div>
<h2>Security Warnings</h2>  
<table>

  <tr>
    <th>Confidence</th>
    <th>Class</th>
    <th>Method</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Admin::StatsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dynamic_render_path/">Dynamic Render Path</a></td>
    <td><div class='warning_message' onClick="toggle('context10');toggle('message10');toggle('full_message10')" >Render path contains parameter value near line 10: render(action =&gt; <span class="user_input">params[:page]</span>, {  })<table id='context10' class='context' style='display:none'><caption>/app/controllers/admin/stats_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @selected_series = params.select { |p| %w[controller action].exclude? p }.keys.map { |p| p.split('.') }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @selected_period = (params[:p] || &quot;&quot;).split('-')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def show</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render params[:page]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def sales</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.json { render json: Stats::BillingsStat.json }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>PagesController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dynamic_render_path/">Dynamic Render Path</a></td>
    <td><div class='warning_message' onClick="toggle('context11');toggle('message11');toggle('full_message11')" >Render path contains parameter value near line 7: render(action =&gt; <span class="user_input">params[:page]</span>, {  })<table id='context11' class='context' style='display:none'><caption>/app/controllers/pages_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>  skip_before_filter :authenticate_user!, if: proc { |c| %w[terms privacy].include?(params[:page]) }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>  before_filter :redirect_non_suspended_user!, if: proc { |c| params[:page] == 'suspended' &amp;&amp; user_signed_in? &amp;&amp; !current_user.suspended? }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  before_filter :prepare_support_request, if: proc { |c| params[:page] == 'help' &amp;&amp; user_signed_in? &amp;&amp; current_user.email_support? }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def show</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render params[:page]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>private</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def redirect_non_suspended_user!</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>StatsExportsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context8');toggle('message8');toggle('full_message8')" ><span id='message8' style='display:block' >Possible unprotected redirect near line 11: redirect_to(<span class="user_input">StatsExport.find(params[:id])</span>.file.secure_url...</span><span id='full_message8' style='display:none'>Possible unprotected redirect near line 11: redirect_to(<span class="user_input">StatsExport.find(params[:id])</span>.file.secure_url)</span><table id='context8' class='context' style='display:none'><caption>/app/controllers/stats_exports_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>6</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # GET /stats/exports/:id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def show</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    stats_export = StatsExport.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if stats_export.site.user == current_user</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to stats_export.file.secure_url</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render nothing: true, status: :unauthorized</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Admin::InvoicesController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" ><span id='message1' style='display:block' >Possible unprotected redirect near line 43: redirect_to([:admin, :invoices], :notice =&gt; (&quot;Invoice wit...</span><span id='full_message1' style='display:none'>Possible unprotected redirect near line 43: redirect_to([:admin, :invoices], :notice =&gt; (&quot;Invoice with reference ##{<span class="user_input">params[:id]</span>} not found.&quot;))</span><table id='context1' class='context' style='display:none'><caption>/app/controllers/admin/invoices_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @invoice = Invoice.includes(:user).find_by_reference(params[:id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_with(@invoice) do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @invoice</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render template: '/invoices/show', layout: 'invoices' }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to [:admin, :invoices], notice: &quot;Invoice with reference ##{params[:id]} not found.&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /invoices/:id/edit</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Admin::SitesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" ><span id='message2' style='display:block' >Possible unprotected redirect near line 47: redirect_to([:edit, :admin, Site.find_by_token!(params[:i...</span><span id='full_message2' style='display:none'>Possible unprotected redirect near line 47: redirect_to([:edit, :admin, <span class="user_input">Site.find_by_token!(params[:id])</span>])</span><table id='context2' class='context' style='display:none'><caption>/app/controllers/admin/sites_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>42</pre>
          </td>
          <td class='context'>
            <pre class='context'>    params[:site].delete(:mode) unless has_role?('god')</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @site.update_attributes(params[:site], without_protection: true)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_with(@site, notice: 'Site was successfully updated.') do |format|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.js   { render 'admin/shared/flash_update' }</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.html { redirect_to [:edit, :admin, @site] }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # PUT /sites/:id/sponsor</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def sponsor</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Admin::UsersController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" >Possible unprotected redirect near line 48: redirect_to([:edit, :admin, <span class="user_input">User.find(params[:id])</span>])<table id='context3' class='context' style='display:none'><caption>/app/controllers/admin/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>43</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @user = User.find(params[:id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user.update_attributes(params[:user], without_protection: true)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_with(@user, notice: 'User was successfully updated.') do |format|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.js   { render 'admin/shared/flash_update' }</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.html { redirect_to [:edit, :admin, @user] }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /users/:id/become</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def become</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Admin::UsersController</td>
    <td>new_support_request</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" ><span id='message4' style='display:block' >Possible unprotected redirect near line 64: redirect_to((ZendeskWrapper.base_url + &quot;/tickets/new?requ...</span><span id='full_message4' style='display:none'>Possible unprotected redirect near line 64: redirect_to((ZendeskWrapper.base_url + &quot;/tickets/new?requester_id=#{<span class="user_input">User.find(params[:id]).zendesk_id</span>}&quot;))</span><table id='context4' class='context' style='display:none'><caption>/app/controllers/admin/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>59</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # GET /users/:id/new_support_request</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def new_support_request</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user = User.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user.create_zendesk_user</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to ZendeskWrapper.base_url + &quot;/tickets/new?requester_id=#{@user.zendesk_id}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>  private</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def set_default_scopes</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>BillingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context5');toggle('message5');toggle('full_message5')" ><span id='message5' style='display:block' >Possible unprotected redirect near line 18: redirect_to([:edit, :billing], notice_and_alert_from_user...</span><span id='full_message5' style='display:none'>Possible unprotected redirect near line 18: redirect_to([:edit, :billing], notice_and_alert_from_user(<span class="user_input">User.find(current_user.id)</span>))</span><table id='context5' class='context' style='display:none'><caption>/app/controllers/billings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>13</pre>
          </td>
          <td class='context'>
            <pre class='context'>    respond_with(@user, flash: false) do |format|</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if @user.d3d_html # 3-d secure identification needed</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { render text: d3d_html_inject(@user.d3d_html), notice: &quot;&quot;, alert: &quot;&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else # everything's all right</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to [:edit, :billing], notice_and_alert_from_user(@user) }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = flash[:alert] = &quot;&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :edit }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>OauthController</td>
    <td>revoke</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context6');toggle('message6');toggle('full_message6')" ><span id='message6' style='display:block' >Possible unprotected redirect near line 21: redirect_to([:client_applications], :notice =&gt; (&quot;You've r...</span><span id='full_message6' style='display:none'>Possible unprotected redirect near line 21: redirect_to([:client_applications], :notice =&gt; (&quot;You've revoked the authorization for the application '#{current_user.tokens.find_by_token!(<span class="user_input">params[:token]</span>).client_application.name}'.&quot;))</span><table id='context6' class='context' style='display:none'><caption>/app/controllers/oauth_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>16</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def revoke</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @token = current_user.tokens.find_by_token!(params[:token])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @token.invalidate!</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_with(@token) do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.html { redirect_to([:client_applications], notice: &quot;You've revoked the authorization for the application '#{@token.client_application.name}'.&quot;) }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>  protected</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>SitesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context7');toggle('message7');toggle('full_message7')" ><span id='message7' style='display:block' >Possible unprotected redirect near line 45: redirect_to(:sites, notice_and_alert_from_transaction(cur...</span><span id='full_message7' style='display:none'>Possible unprotected redirect near line 45: redirect_to(:sites, notice_and_alert_from_transaction(current_user.sites.build(<span class="user_input">params[:site]</span>).last_transaction))</span><table id='context7' class='context' style='display:none'><caption>/app/controllers/sites_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>40</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @site = current_user.sites.build(params[:site])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_with(@site) do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @site.save # will create site (&amp; create invoice and charge it if skip_trial is true)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>        notice_and_alert = notice_and_alert_from_transaction(@site.last_transaction)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to :sites, notice_and_alert }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = flash[:alert] = &quot;&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :new }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>TransactionsController</td>
    <td>process_payment</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context9');toggle('message9');toggle('full_message9')" ><span id='message9' style='display:block' >Possible unprotected redirect near line 58: redirect_to([:sites], notice_and_alert_from_transaction(T...</span><span id='full_message9' style='display:none'>Possible unprotected redirect near line 58: redirect_to([:sites], notice_and_alert_from_transaction(<span class="user_input">Transaction.find_by_order_id(params[&quot;orderID&quot;])</span>))</span><table id='context9' class='context' style='display:none'><caption>/app/controllers/transactions_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>53</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def process_payment</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    transaction = Transaction.find_by_order_id(params[&quot;orderID&quot;])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render(nothing: true, status: 204) and return if transaction.paid? # already paid</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    transaction.process_payment_response(@sha_params)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to [:sites], notice_and_alert_from_transaction(transaction)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  

</table><p>Model Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Model</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Oauth2Token, Oauth2Verifier, OauthToken</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/attribute_restriction/">Attribute Restriction</a></td>
    <td>Mass assignment is not restricted using attr_accessible</td>
  </tr>

</table><p>View Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Template</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>oauth/oauth2_authorize</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context19');toggle('message19');toggle('full_message19')" ><span id='message19' style='display:block' >Unsafe parameter value in link_to href near line 40: link_to(&quot;Cancel&quot;, <span class="user_input">params[:redirect_uri]</span>, :class ...</span><span id='full_message19' style='display:none'>Unsafe parameter value in link_to href near line 40: link_to(&quot;Cancel&quot;, <span class="user_input">params[:redirect_uri]</span>, :class =&gt; &quot;submit_dynamic_button float hl&quot;)</span><table id='context19' class='context' style='display:none'><caption>/app/views/oauth/oauth2_authorize.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>35</pre>
          </td>
          <td class='context'>
            <pre class='context'>    = hidden_field_tag &quot;scope&quot;,         params[:scope]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = hidden_field_tag &quot;authorize&quot;, &quot;1&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>    .entry.update</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = submit_tag &quot;Authorize&quot;, class: &quot;blue_button&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = link_to &quot;Cancel&quot;, params[:redirect_uri], class: &quot;submit_dynamic_button float hl&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>admin/mail_templates/_mail_template (Template:admin/mails/_mail_templates)</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context14');toggle('message14');toggle('full_message14')" ><span id='message14' style='display:block' >Unsafe model attribute in link_to href near line 3: link_to(<span class="user_input">(Unresolved Model).new</span>.title, [:edit, :ad...</span><span id='full_message14' style='display:none'>Unsafe model attribute in link_to href near line 3: link_to(<span class="user_input">(Unresolved Model).new</span>.title, [:edit, :admin, <span class="user_input">(Unresolved Model).new</span>])</span><table id='context14' class='context' style='display:none'><caption>/app/views/admin/mail_templates/_mail_template.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>%tr[mail_template]{ class: cycle(&quot;&quot;, &quot;alt&quot;) }</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.title</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = link_to mail_template.title, [:edit, :admin, mail_template]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.subject</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = link_to mail_template.subject, [:edit, :admin, mail_template], title: mail_template.subject</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.body</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small= link_to truncate(mail_template.body), [:edit, :admin, mail_template], title: mail_template.body</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>admin/mail_templates/_mail_template (Template:admin/mails/_mail_templates)</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context15');toggle('message15');toggle('full_message15')" ><span id='message15' style='display:block' >Unsafe model attribute in link_to href near line 6: link_to(<span class="user_input">(Unresolved Model).new</span>.subject, [:edit, :...</span><span id='full_message15' style='display:none'>Unsafe model attribute in link_to href near line 6: link_to(<span class="user_input">(Unresolved Model).new</span>.subject, [:edit, :admin, <span class="user_input">(Unresolved Model).new</span>], :title =&gt; (<span class="user_input">(Unresolved Model).new</span>.subject))</span><table id='context15' class='context' style='display:none'><caption>/app/views/admin/mail_templates/_mail_template.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>%tr[mail_template]{ class: cycle(&quot;&quot;, &quot;alt&quot;) }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.title</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = link_to mail_template.title, [:edit, :admin, mail_template]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.subject</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = link_to mail_template.subject, [:edit, :admin, mail_template], title: mail_template.subject</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.body</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small= link_to truncate(mail_template.body), [:edit, :admin, mail_template], title: mail_template.body</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small= display_time(mail_template.created_at)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>admin/mail_templates/_mail_template (Template:admin/mails/_mail_templates)</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context16');toggle('message16');toggle('full_message16')" ><span id='message16' style='display:block' >Unsafe model attribute in link_to href near line 8: link_to(truncate(<span class="user_input">(Unresolved Model).new</span>.body), [:...</span><span id='full_message16' style='display:none'>Unsafe model attribute in link_to href near line 8: link_to(truncate(<span class="user_input">(Unresolved Model).new</span>.body), [:edit, :admin, <span class="user_input">(Unresolved Model).new</span>], :title =&gt; (<span class="user_input">(Unresolved Model).new</span>.body))</span><table id='context16' class='context' style='display:none'><caption>/app/views/admin/mail_templates/_mail_template.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>    = link_to mail_template.title, [:edit, :admin, mail_template]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.subject</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = link_to mail_template.subject, [:edit, :admin, mail_template], title: mail_template.subject</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td.body</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small= link_to truncate(mail_template.body), [:edit, :admin, mail_template], title: mail_template.body</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %td</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %small= display_time(mail_template.created_at)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>admin/users/_li_site (Template:admin/users/edit)</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context17');toggle('message17');toggle('full_message17')" ><span id='message17' style='display:block' >Unsafe model attribute in link_to href near line 4: link_to(&quot;details&quot;, [:edit, :admin, (Unresolved Mo...</span><span id='full_message17' style='display:none'>Unsafe model attribute in link_to href near line 4: link_to(&quot;details&quot;, [:edit, :admin, <span class="user_input">(Unresolved Model).new</span>])</span><table id='context17' class='context' style='display:none'><caption>/app/views/admin/users/_li_site.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>%li</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = site.hostname? ? link_to(site.hostname, &quot;http://#{site.hostname}&quot;) : &quot;##{site.token}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = raw &quot;[#{render('admin/sites/plan', site: site).strip}]&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = raw &quot;(#{link_to &quot;details&quot;, [:edit, :admin, site]})&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>sites/_site_settings (Template:sites/_fields)</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context18');toggle('message18');toggle('full_message18')" ><span id='message18' style='display:block' >Unsafe parameter value in link_to href near line 52: link_to(&quot;Upgrade now!&quot;, [:edit, current_user.sit...</span><span id='full_message18' style='display:none'>Unsafe parameter value in link_to href near line 52: link_to(&quot;Upgrade now!&quot;, [:edit, current_user.sites.build(<span class="user_input">params</span>[:site]), :plan], :class =&gt; &quot;hl&quot;)</span><table id='context18' class='context' style='display:none'><caption>/app/views/sites/_site_settings.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>47</pre>
          </td>
          <td class='context'>
            <pre class='context'>    %span= &quot;Read more&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>  - if @site.in_free_plan?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %p</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>      Want to remove the SublimeVideo badge or need SSL Serving?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = link_to &quot;Upgrade now!&quot;, [:edit, @site, :plan], class: 'hl'</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %br</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>  .big_break</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>admin/stats/countries</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context20');toggle('message20');toggle('full_message20')" >Possible SQL injection near line 6: User.active.select(&quot;#{<span class="user_input">(local c)</span>}, COUNT(*) as total&quot;)<table id='context20' class='context' style='display:none'><caption>/app/views/admin/stats/countries.html.erb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= title_and_content_header(&quot;Repartition of Users by Country&quot;) %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>  minimum_users = 100</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %w[country].each do |c|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    countries = User.active.select(&quot;#{c}, COUNT(*) as total&quot;).group(c).order(&quot;total DESC&quot;).map! { |u| [u.send(c) || &quot;Unknown&quot;, u.total.to_i] }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_countries = [&quot;Other (less than #{minimum_users} users)&quot;, 0]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    countries_with_others = countries.inject([]) do |memo, country|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if country[1] &lt; minimum_users</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>        other_countries[1] += country[1]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>admin/invoices/_timeline (Template:admin/invoices/index)</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context12');toggle('message12');toggle('full_message12')" >Unescaped model attribute near line 63: Graph.new do  g =   end.draw<table id='context12' class='context' style='display:none'><caption>/app/views/admin/invoices/_timeline.html.erb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>58</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # g.option(plotOptions: plot_options(range_start_date.end_of_month, 1.month, marker: true, linear: true))</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>  g.option(plotOptions: plot_options(range_start_date))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>  g.option(credits: credits)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;timeline_invoices&quot; style=&quot;width: 100%; height: 400px;&quot;&gt;&lt;%= raw graph.draw %&gt;&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>admin/plans/_plans_distribution (Template:admin/plans/index)</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context13');toggle('message13');toggle('full_message13')" >Unescaped model attribute near line 33: Graph.new do  g =   end.draw<table id='context13' class='context' style='display:none'><caption>/app/views/admin/plans/_plans_distribution.html.erb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>  ])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>  g.option(credits: credits)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>%&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;plans_distribution&quot; width=&quot;200px&quot; style=&quot;height:400px;&quot;&gt;&lt;%= raw graph.draw %&gt;&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

</table></body></html>